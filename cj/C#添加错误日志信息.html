<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修C#添加错误日志信息' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>C#添加错误日志信息</center></div><div class='banquan'>原文出处:本文由博客园博主Tulip123提供。<br/>
原文连接:https://www.cnblogs.com/guhuazhen/p/11179988.html</div><br>
    <p>错误日志是软件用来记录运行时出错信息的<a href="https://baike.baidu.com/item/%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6/747597" target="_blank" data-lemmaid="747597">文本文件</a>。编程人员和维护人员等可以利用错误日志对系统进行<a href="https://baike.baidu.com/item/%E8%B0%83%E8%AF%95/5852756" target="_blank" data-lemmaid="5852756">调试</a>和维护。</p>
<div class="para-title level-3">
<h3 class="title-text">系统日志</h3>
</div>
<div class="para">系统日志包含了由Windows系统组件记录的事件。例如，在启动期间装入驱动程序或其他系统组件失败被记录到系统日志。要查看系统日志：</div>
<ol class="custom_num para-list list-paddingleft-1">
<li class="list-num-1-1 list-num-paddingleft-1">
<div class="para">打开命令提示符。</div>
</li>
<li class="list-num-1-2 list-num-paddingleft-1">
<div class="para">在提示符下输入eventvwr。这打开了Windows事件查看器。</div>
</li>
</ol>
<div class="para-title level-3">
<h3 class="title-text">应用程序日志</h3>
</div>
<div class="para">应用程序日志包含了由应用程序或程序记录的事件。例如，数据库程序可能在应用程序日志中记录一个文件错误。要查看应用程序日志：</div>
<ol class="custom_num para-list list-paddingleft-1">
<li class="list-num-1-1 list-num-paddingleft-1">
<div class="para">打开命令提示符。</div>
</li>
<li class="list-num-1-2 list-num-paddingleft-1">
<div class="para">在提示符下输入eventvwr。这打开了Windows事件查看器。</div>
</li>
</ol>
<div class="para-title level-3">
<h3 class="title-text">解释日志信息</h3>
</div>
<div class="para">在两种日志中，每个事件按照日期和时间顺序（首先是最近的）分行显示，带有下列信息：</div>
<ul class="custom_dot para-list list-paddingleft-1">
<li class="list-dot list-dot-paddingleft">
<div class="para">类型：事件类型，可以是信息、警告或错误。</div>
</li>
<li class="list-dot list-dot-paddingleft">
<div class="para">日期和时间：事件被写入日志的日期和时间。</div>
</li>
<li class="list-dot list-dot-paddingleft">
<div class="para">源：引起该事件的操作。</div>
</li>
<li class="list-dot list-dot-paddingleft">
<div class="para">类别：事件的类别。缺省类别是无。</div>
</li>
<li class="list-dot list-dot-paddingleft">
<div class="para">事件：事件编号。</div>
</li>
<li class="list-dot list-dot-paddingleft">
<div class="para">用户：事件发生时的用户名。</div>
</li>
<li class="list-dot list-dot-paddingleft">
<div class="para">计算机：本地机器的名称。</div>
</li>
</ul>
<div class="para">查看单个日志条目：</div>
<div class="para">1 在系统或应用程序日志中，查找日志条目。</div>
<div class="para">2 右键单击条目。</div>
<div class="para">在WindowsWindowsServer 2008 中，单击事件以打开&ldquo;事件属性&rdquo;窗口。</div>
<div class="para">该窗口显示事件的描述。选择&ldquo;详细信息&rdquo;选项卡可以查看将记录写入日志时解析的字节或字。</div>
<div class="para">3 使用向上和向下箭头键上下移动以查看日志事件。</div>
<div class="para">4 要关闭窗口，请单击确定以返回到系统日志或应用程序日志<span class="sup--normal" data-sup="2" data-ctrmap=":2,">&nbsp;</span></div>
<h3 class="para"><span class="sup--normal" data-sup="2" data-ctrmap=":2,">C#中自定义日志</span></h3>
<p><span class="sup--normal" data-sup="2" data-ctrmap=":2,">为了方便清晰得看到程序中的错误和不足的地方，记录错误日志是非常有必要的。</span></p>
<p>废话不多说，直接上代码，关键代码都有注释，不理解的可以留言提出.</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> StreamWriter streamWriter; <span style="color: #008000;">//</span><span style="color: #008000;">写文件  
        </span><span style="color: #008000;">//</span><span style="color: #008000;">将错误信息写入文件中</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> WriteError(<span style="color: #0000ff;">string</span><span style="color: #000000;"> message)
        {
            </span><span style="color: #0000ff;">try</span><span style="color: #000000;">
            {
                </span><span style="color: #008000;">//</span><span style="color: #008000;">DateTime dt = new DateTime();</span>
                <span style="color: #0000ff;">string</span> directPath = Environment.CurrentDirectory + <span style="color: #800000;">"</span><span style="color: #800000;">\\ErrorLog</span><span style="color: #800000;">"</span>;    <span style="color: #008000;">//</span><span style="color: #008000;">在获得文件夹路径（根据你们自己的实际情况去写错误日志文件夹路径）</span>
                <span style="color: #0000ff;">if</span> (!Directory.Exists(directPath))   <span style="color: #008000;">//</span><span style="color: #008000;">判断文件夹是否存在，如果不存在则创建</span>
<span style="color: #000000;">                {
                    Directory.CreateDirectory(directPath);
                }
                directPath </span>+= <span style="color: #0000ff;">string</span>.Format(<span style="color: #800000;">@"</span><span style="color: #800000;">\{0}.log</span><span style="color: #800000;">"</span>, DateTime.Now.ToString(<span style="color: #800000;">"</span><span style="color: #800000;">yyyy-MM-dd</span><span style="color: #800000;">"</span><span style="color: #000000;">));
                </span><span style="color: #0000ff;">if</span> (streamWriter == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
                {
                    streamWriter </span>= !File.Exists(directPath) ? File.CreateText(directPath) : File.AppendText(directPath);    <span style="color: #008000;">//</span><span style="color: #008000;">判断文件是否存在如果不存在则创建，如果存在则添加。</span>
<span style="color: #000000;">                }
                streamWriter.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">***********************************************************************</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                streamWriter.WriteLine(DateTime.Now.ToString(</span><span style="color: #800000;">"</span><span style="color: #800000;">HH:mm:ss</span><span style="color: #800000;">"</span><span style="color: #000000;">));
                streamWriter.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">输出信息：错误信息</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                </span><span style="color: #0000ff;">if</span> (message != <span style="color: #0000ff;">null</span><span style="color: #000000;">)
                {
                    streamWriter.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">异常信息：\r\n</span><span style="color: #800000;">"</span> +<span style="color: #000000;"> message);
                }
            }
            </span><span style="color: #0000ff;">finally</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">if</span> (streamWriter != <span style="color: #0000ff;">null</span><span style="color: #000000;">)
                {
                    streamWriter.Flush();
                    streamWriter.Dispose();
                    streamWriter </span>= <span style="color: #0000ff;">null</span><span style="color: #000000;">;
                }
            }
        }</span></pre>
</div>
<p>&nbsp;</p>
<p>ok,今天的分享就到这里了，有疑问的欢迎留言！</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>