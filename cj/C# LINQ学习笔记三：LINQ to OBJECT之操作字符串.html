<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修C# LINQ学习笔记三：LINQ to OBJECT之操作字符串' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>C# LINQ学习笔记三：LINQ to OBJECT之操作字符串</center></div><div class='banquan'>原文出处:本文由博客园博主缥缈的尘埃提供。<br/>
原文连接:https://www.cnblogs.com/atomy/p/12100300.html</div><br>
    <p>&nbsp; &nbsp;&nbsp;本笔记摘抄自：<a href="https://www.cnblogs.com/liqingwen/p/5814204.html">https://www.cnblogs.com/liqingwen/p/5814204.html</a>，记录一下学习过程以备后续查用。</p>
<p>&nbsp; &nbsp; 一、<strong>统计单词在字符串中出现的次数</strong></p>
<p>&nbsp; &nbsp; 请注意，若要执行计数，请先调用Split方法来创建词数组。Split方法存在性能开销，如果对字符串执行的唯一操作是计数词，则应考虑改用Matches或</p>
<p>IndexOf方法。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('198592f5-01b6-4ca0-b629-6f691a05cdb5')"><img id="code_img_closed_198592f5-01b6-4ca0-b629-6f691a05cdb5" class="code_img_closed" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串0.png" alt="" /><img id="code_img_opened_198592f5-01b6-4ca0-b629-6f691a05cdb5" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('198592f5-01b6-4ca0-b629-6f691a05cdb5',event)" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串1.png" alt="" />
<div id="cnblogs_code_open_198592f5-01b6-4ca0-b629-6f691a05cdb5" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 统计单词在字符串中出现的次数
            <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">string</span> text = <span style="color: #800000;">@"</span><span style="color: #800000;">Historically, the world of data and the world of objects</span><span style="color: #800000;">"</span> +
                                <span style="color: #800000;">@"</span><span style="color: #800000;"> have not been well integrated. Programmers work in C# or Visual Basic</span><span style="color: #800000;">"</span> +
                                <span style="color: #800000;">@"</span><span style="color: #800000;"> and also in SQL or XQuery. On the one side are concepts such as classes,</span><span style="color: #800000;">"</span> +
                                <span style="color: #800000;">@"</span><span style="color: #800000;"> objects, fields, inheritance, and .NET Framework APIs. On the other side</span><span style="color: #800000;">"</span> +
                                <span style="color: #800000;">@"</span><span style="color: #800000;"> are tables, columns, rows, nodes, and separate languages for dealing with</span><span style="color: #800000;">"</span> +
                                <span style="color: #800000;">@"</span><span style="color: #800000;"> them. Data types often require translation between the two worlds; there are</span><span style="color: #800000;">"</span> +
                                <span style="color: #800000;">@"</span><span style="color: #800000;"> different standard functions. Because the object world has no notion of query, a</span><span style="color: #800000;">"</span> +
                                <span style="color: #800000;">@"</span><span style="color: #800000;"> query can only be represented as a string without compile-time type checking or</span><span style="color: #800000;">"</span> +
                                <span style="color: #800000;">@"</span><span style="color: #800000;"> IntelliSense support in the IDE. Transferring data from SQL tables or XML trees to</span><span style="color: #800000;">"</span> +
                                <span style="color: #800000;">@"</span><span style="color: #800000;"> objects in memory is often tedious and error-prone.</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            </span><span style="color: #0000ff;">const</span> <span style="color: #0000ff;">string</span> searchWord = <span style="color: #800000;">"</span><span style="color: #800000;">data</span><span style="color: #800000;">"</span><span style="color: #000000;">;

            </span><span style="color: #008000;">//</span><span style="color: #008000;">字符串转换成数组</span>
            <span style="color: #0000ff;">var</span> source = text.Split(<span style="color: #0000ff;">new</span>[] { <span style="color: #800000;">'</span><span style="color: #800000;">.</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">?</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">!</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span> <span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">;</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">:</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">,</span><span style="color: #800000;">'</span><span style="color: #000000;"> }, StringSplitOptions.RemoveEmptyEntries);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">创建查询，并忽略大小写比较。</span>
            <span style="color: #0000ff;">var</span> query = <span style="color: #0000ff;">from</span> word <span style="color: #0000ff;">in</span><span style="color: #000000;"> source
                             </span><span style="color: #0000ff;">where</span> <span style="color: #0000ff;">string</span><span style="color: #000000;">.Equals(word, searchWord, StringComparison.InvariantCultureIgnoreCase)
                             </span><span style="color: #0000ff;">select</span><span style="color: #000000;"> word;

            </span><span style="color: #008000;">//</span><span style="color: #008000;">统计匹配数量</span>
            <span style="color: #0000ff;">var</span> wordCount =<span style="color: #000000;"> query.Count();
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">{wordCount} occurrences(s) of the search word \"{searchWord}\" were found.</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串2.png" alt="" /></p>
<p><strong>&nbsp; &nbsp; 二、查询包含指定一组单词的句子</strong></p>
<p>&nbsp; &nbsp;&nbsp;此示例演示如何查找文本文件中包含指定一组单词中每个单词匹配项的句子。虽然在此示例中搜索条件数组是硬编码的，但也可以在运行时动态填充此</p>
<p>数组。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('77baf04b-0b2d-420f-8fa6-8207da4d46dd')"><img id="code_img_closed_77baf04b-0b2d-420f-8fa6-8207da4d46dd" class="code_img_closed" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串0.png" alt="" /><img id="code_img_opened_77baf04b-0b2d-420f-8fa6-8207da4d46dd" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('77baf04b-0b2d-420f-8fa6-8207da4d46dd',event)" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串1.png" alt="" />
<div id="cnblogs_code_open_77baf04b-0b2d-420f-8fa6-8207da4d46dd" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 查询包含指定一组单词的句子
            <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">string</span> text = <span style="color: #800000;">@"</span><span style="color: #800000;">Historically, the world of data and the world of objects </span><span style="color: #800000;">"</span> +
                                <span style="color: #800000;">@"</span><span style="color: #800000;">have not been well integrated. Programmers work in C# or Visual Basic </span><span style="color: #800000;">"</span> +
                                <span style="color: #800000;">@"</span><span style="color: #800000;">and also in SQL or XQuery. On the one side are concepts such as classes, </span><span style="color: #800000;">"</span> +
                                <span style="color: #800000;">@"</span><span style="color: #800000;">objects, fields, inheritance, and .NET Framework APIs. On the other side </span><span style="color: #800000;">"</span> +
                                <span style="color: #800000;">@"</span><span style="color: #800000;">are tables, columns, rows, nodes, and separate languages for dealing with </span><span style="color: #800000;">"</span> +
                                <span style="color: #800000;">@"</span><span style="color: #800000;">them. Data types often require translation between the two worlds; there are </span><span style="color: #800000;">"</span> +
                                <span style="color: #800000;">@"</span><span style="color: #800000;">different standard functions. Because the object world has no notion of query, a </span><span style="color: #800000;">"</span> +
                                <span style="color: #800000;">@"</span><span style="color: #800000;">query can only be represented as a string without compile-time type checking or </span><span style="color: #800000;">"</span> +
                                <span style="color: #800000;">@"</span><span style="color: #800000;">IntelliSense support in the IDE. Transferring data from SQL tables or XML trees to </span><span style="color: #800000;">"</span> +
                                <span style="color: #800000;">@"</span><span style="color: #800000;">objects in memory is often tedious and error-prone.</span><span style="color: #800000;">"</span><span style="color: #000000;">;

            </span><span style="color: #008000;">//</span><span style="color: #008000;">将文本块切割成数组</span>
            <span style="color: #0000ff;">var</span> sentences = text.Split(<span style="color: #800000;">'</span><span style="color: #800000;">.</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">?</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">!</span><span style="color: #800000;">'</span><span style="color: #000000;">);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">定义搜索条件，此列表可以在运行时动态添加。</span>
            <span style="color: #0000ff;">string</span>[] wordsToMatch = { <span style="color: #800000;">"</span><span style="color: #800000;">Historically</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">data</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">integrated</span><span style="color: #800000;">"</span><span style="color: #000000;"> };

            </span><span style="color: #0000ff;">var</span> query = <span style="color: #0000ff;">from</span> sentence <span style="color: #0000ff;">in</span><span style="color: #000000;"> sentences
                        let t </span>= sentence.Split(<span style="color: #0000ff;">new</span> <span style="color: #0000ff;">char</span>[] { <span style="color: #800000;">'</span><span style="color: #800000;">.</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">?</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">!</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span> <span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">;</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">:</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">,</span><span style="color: #800000;">'</span><span style="color: #000000;"> }, StringSplitOptions.RemoveEmptyEntries)
                        </span><span style="color: #0000ff;">where</span> t.Distinct().Intersect(wordsToMatch).Count() == wordsToMatch.Length   <span style="color: #008000;">//</span><span style="color: #008000;">去重，取交集后的数量对比。</span>
                        <span style="color: #0000ff;">select</span><span style="color: #000000;"> sentence;

            </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> sentence <span style="color: #0000ff;">in</span><span style="color: #000000;"> query)
            {
                Console.WriteLine(sentence);
            }
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串5.png" alt="" /></p>
<p>&nbsp; &nbsp; 查询运行时首先将文本拆分成句子，然后将句子拆分成包含每个单词的字符串数组。对于每个这样的数组，<a href="https://msdn.microsoft.com/zh-cn/library/bb348436.aspx">Distinct&lt;TSource&gt;</a>&nbsp;方法移除所有重复的单词，</p>
<p>然后查询对单词数组和wordstoMatch数组执行<a href="https://msdn.microsoft.com/zh-cn/library/bb460136.aspx">Intersect&lt;TSource&gt;</a>操作。如果交集的计数与wordsToMatch数组的计数相同，则在单词中找到了所有的单词，</p>
<p>然后返回原始句子。</p>
<p>&nbsp; &nbsp;&nbsp;在对Split的调用中，使用标点符号作为分隔符，以从字符串中移除标点符号。如果您没有这样做，则假如您有一个字符串&ldquo;Historically,&rdquo;，该字符串不会</p>
<p>与wordsToMatch数组中的&ldquo;Historically&rdquo;相匹配。根据源文本中标点的类型，您可能必须使用其他分隔符。</p>
<p>&nbsp; &nbsp; <strong>三、在字符串中查询字符</strong></p>
<p>&nbsp; &nbsp; 因为<a href="https://msdn.microsoft.com/zh-cn/library/system.string.aspx">String</a>类实现泛型<a href="https://msdn.microsoft.com/zh-cn/library/9eekhta0.aspx">IEnumerable&lt;T&gt;</a>接口，所以可以将任何字符串作为字符序列进行查询。但是，这不是LINQ的常见用法。若要执行复杂的模式匹配操</p>
<p>作，请使用<a href="https://msdn.microsoft.com/zh-cn/library/system.text.regularexpressions.regex.aspx">Regex</a>类。</p>
<p>&nbsp; &nbsp; 下面的示例查询一个字符串以确定它包含的数字的数目。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('eb14f88c-bca0-4927-be42-171f50de7a38')"><img id="code_img_closed_eb14f88c-bca0-4927-be42-171f50de7a38" class="code_img_closed" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串0.png" alt="" /><img id="code_img_opened_eb14f88c-bca0-4927-be42-171f50de7a38" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('eb14f88c-bca0-4927-be42-171f50de7a38',event)" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串1.png" alt="" />
<div id="cnblogs_code_open_eb14f88c-bca0-4927-be42-171f50de7a38" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 在字符串中查询字符
            <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">string</span> source = <span style="color: #800000;">"</span><span style="color: #800000;">ABCDE99F-J74-12-89A</span><span style="color: #800000;">"</span><span style="color: #000000;">;

            </span><span style="color: #008000;">//</span><span style="color: #008000;">只选择数字的字符 </span>
            <span style="color: #0000ff;">var</span> digits = <span style="color: #0000ff;">from</span> character <span style="color: #0000ff;">in</span><span style="color: #000000;"> source
                         </span><span style="color: #0000ff;">where</span> <span style="color: #0000ff;">char</span><span style="color: #000000;">.IsDigit(character)
                         </span><span style="color: #0000ff;">select</span><span style="color: #000000;"> character;
            Console.Write(</span><span style="color: #800000;">"</span><span style="color: #800000;">Digit:</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> digit <span style="color: #0000ff;">in</span><span style="color: #000000;"> digits)
            {
                Console.Write($</span><span style="color: #800000;">"</span><span style="color: #800000;">{digit} </span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }
            Console.WriteLine();

            </span><span style="color: #008000;">//</span><span style="color: #008000;">选择第一个"-"之前的所有字符</span>
            <span style="color: #0000ff;">var</span> query = source.TakeWhile(x =&gt; x != <span style="color: #800000;">'</span><span style="color: #800000;">-</span><span style="color: #800000;">'</span><span style="color: #000000;">);
            </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> character <span style="color: #0000ff;">in</span><span style="color: #000000;"> query)
            {
                Console.Write(character);
            }

            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串8.png" alt="" /></p>
<p>&nbsp; &nbsp; <strong>四、正则表达式结合LINQ查询</strong></p>
<p>&nbsp; &nbsp; 此示例演示如何使用<a href="https://msdn.microsoft.com/zh-cn/library/system.text.regularexpressions.regex.aspx">Regex</a>类创建正则表达式以便在文本字符串中进行更复杂的匹配。使用LINQ查询可以方便地对您要用正则表达式搜索的文件进行准确</p>
<p>筛选以及对结果进行加工。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('74a98e23-9ef8-49a2-8392-4401ff7c693b')"><img id="code_img_closed_74a98e23-9ef8-49a2-8392-4401ff7c693b" class="code_img_closed" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串0.png" alt="" /><img id="code_img_opened_74a98e23-9ef8-49a2-8392-4401ff7c693b" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('74a98e23-9ef8-49a2-8392-4401ff7c693b',event)" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串1.png" alt="" />
<div id="cnblogs_code_open_74a98e23-9ef8-49a2-8392-4401ff7c693b" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 正则表达式结合LINQ查询
            <span style="color: #008000;">//</span><span style="color: #008000;">请根据不同版本的VS进行路径修改</span>
            <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">string</span> floder = <span style="color: #800000;">@"</span><span style="color: #800000;">C:\Program Files (x86)\Microsoft Visual Studio\</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            </span><span style="color: #0000ff;">var</span> fileInfoes =<span style="color: #000000;"> GetFiles(floder);
            </span><span style="color: #008000;">//</span><span style="color: #008000;">创建正则表达式来寻找所有的"Visual"</span>
            <span style="color: #0000ff;">var</span> searchTerm = <span style="color: #0000ff;">new</span> Regex(<span style="color: #800000;">@"</span><span style="color: #800000;">http://(www.w3.org|www.npmjs.org)</span><span style="color: #800000;">"</span><span style="color: #000000;">);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">搜索每一个&ldquo;.html&rdquo;文件
            </span><span style="color: #008000;">//</span><span style="color: #008000;">通过where找到匹配项
            </span><span style="color: #008000;">//</span><span style="color: #008000;">注意：select中的变量要求显示声明其类型，因为MatchCollection不是泛型IEnumerable集合。</span>
            <span style="color: #0000ff;">var</span> query = <span style="color: #0000ff;">from</span> fileInfo <span style="color: #0000ff;">in</span><span style="color: #000000;"> fileInfoes
                        </span><span style="color: #0000ff;">where</span> fileInfo.Extension == <span style="color: #800000;">"</span><span style="color: #800000;">.html</span><span style="color: #800000;">"</span><span style="color: #000000;">
                        let text </span>=<span style="color: #000000;"> File.ReadAllText(fileInfo.FullName)
                        let matches </span>=<span style="color: #000000;"> searchTerm.Matches(text)
                        </span><span style="color: #0000ff;">where</span> matches.Count &gt; <span style="color: #800080;">0</span>
                        <span style="color: #0000ff;">select</span> <span style="color: #0000ff;">new</span><span style="color: #000000;">
                        {
                            name </span>=<span style="color: #000000;"> fileInfo.FullName,
                            matchValue </span>= <span style="color: #0000ff;">from</span> Match match <span style="color: #0000ff;">in</span> matches <span style="color: #0000ff;">select</span><span style="color: #000000;"> match.Value
                        };

            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">The term \"{searchTerm}\" was found in:</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            Console.WriteLine();
            </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> q <span style="color: #0000ff;">in</span><span style="color: #000000;"> query)
            {
                </span><span style="color: #008000;">//</span><span style="color: #008000;">修剪匹配找到的文件中的路径</span>
                Console.WriteLine($<span style="color: #800000;">"</span><span style="color: #800000;">name==&gt;{q.name.Substring(floder.Length - 1)}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                </span><span style="color: #008000;">//</span><span style="color: #008000;">输出找到的匹配值</span>
                <span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> v <span style="color: #0000ff;">in</span><span style="color: #000000;"> q.matchValue)
                {
                    Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">matchValue==&gt;{v}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                }
                </span><span style="color: #008000;">//</span><span style="color: #008000;">输出空白行</span>
<span style="color: #000000;">                Console.WriteLine();
            }
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 获取指定路径的文件信息
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="path"&gt;&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> IList&lt;FileInfo&gt; GetFiles(<span style="color: #0000ff;">string</span><span style="color: #000000;"> path)
        {
            </span><span style="color: #0000ff;">var</span> files = Directory.GetFiles(path, <span style="color: #800000;">"</span><span style="color: #800000;">*.*</span><span style="color: #800000;">"</span><span style="color: #000000;">, SearchOption.AllDirectories);

            </span><span style="color: #0000ff;">return</span> files.Select(file =&gt; <span style="color: #0000ff;">new</span><span style="color: #000000;"> FileInfo(file)).ToList();
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串11.png" alt="" /></p>
<p>&nbsp; &nbsp;&nbsp;<strong>五、查找两个集合间的差异</strong></p>
<p><strong>&nbsp; &nbsp;&nbsp;</strong>此示例演示如何使用LINQ对两个字符串列表进行比较，并输出那些位于text1.txt中但不在text2.txt中的行。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('b780111f-79d1-42ef-95a4-31a3cbf065f6')"><img id="code_img_closed_b780111f-79d1-42ef-95a4-31a3cbf065f6" class="code_img_closed" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串0.png" alt="" /><img id="code_img_opened_b780111f-79d1-42ef-95a4-31a3cbf065f6" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('b780111f-79d1-42ef-95a4-31a3cbf065f6',event)" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串1.png" alt="" />
<div id="cnblogs_code_open_b780111f-79d1-42ef-95a4-31a3cbf065f6" class="cnblogs_code_hide">
<pre><code><span style="color: #000000;">Bankov, Peter
Holm, Michael
Garcia, Hugo
Potra, Cristina
Noriega, Fabricio
Aw, Kam Foo
Beebe, Ann
Toyoshima, Tim
Guy, Wey Yuan
Garcia, Debra</span></pre>
</div>
<span class="cnblogs_code_collapse">text1.txt</span></div>
<div class="cnblogs_code" onclick="cnblogs_code_show('346e00d1-f16d-4ab9-bc9f-0096e31167e7')"><img id="code_img_closed_346e00d1-f16d-4ab9-bc9f-0096e31167e7" class="code_img_closed" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串0.png" alt="" /><img id="code_img_opened_346e00d1-f16d-4ab9-bc9f-0096e31167e7" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('346e00d1-f16d-4ab9-bc9f-0096e31167e7',event)" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串1.png" alt="" />
<div id="cnblogs_code_open_346e00d1-f16d-4ab9-bc9f-0096e31167e7" class="cnblogs_code_hide">
<pre><code><span style="color: #000000;">Liu, Jinghao
Bankov, Peter
Holm, Michael
Garcia, Hugo
Beebe, Ann
Gilchrist, Beth
Myrcha, Jacek
Giakoumakis, Leo
McLin, Nkenge
El Yassir, Mehdi</span></pre>
</div>
<span class="cnblogs_code_collapse">text2.txt</span></div>
<div class="cnblogs_code" onclick="cnblogs_code_show('3035ed4d-e303-42ce-ba79-a7fea088dee7')"><img id="code_img_closed_3035ed4d-e303-42ce-ba79-a7fea088dee7" class="code_img_closed" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串0.png" alt="" /><img id="code_img_opened_3035ed4d-e303-42ce-ba79-a7fea088dee7" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('3035ed4d-e303-42ce-ba79-a7fea088dee7',event)" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串1.png" alt="" />
<div id="cnblogs_code_open_3035ed4d-e303-42ce-ba79-a7fea088dee7" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 查找两个集合间的差异
            <span style="color: #008000;">//</span><span style="color: #008000;">创建数据源</span>
            <span style="color: #0000ff;">var</span> text1 = File.ReadAllLines(<span style="color: #800000;">@"</span><span style="color: #800000;">..\..\text1.txt</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            </span><span style="color: #0000ff;">var</span> text2 = File.ReadAllLines(<span style="color: #800000;">@"</span><span style="color: #800000;">..\..\text2.txt</span><span style="color: #800000;">"</span><span style="color: #000000;">);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">创建查询，这里必须使用方法语法。</span>
            <span style="color: #0000ff;">var</span> query =<span style="color: #000000;"> text1.Except(text2);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">执行查询</span>
            Console.WriteLine(<span style="color: #800000;">"</span><span style="color: #800000;">The following lines are in text1.txt but not text2.txt</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> name <span style="color: #0000ff;">in</span><span style="color: #000000;"> query)
            {
                Console.WriteLine(name);
            }
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串18.png" alt="" /></p>
<p>&nbsp; &nbsp; 注：某些类型的查询操作（如&nbsp;<a href="https://msdn.microsoft.com/zh-cn/library/bb300779.aspx">Except&lt;TSource&gt;</a>、<a href="https://msdn.microsoft.com/zh-cn/library/bb348436.aspx">Distinct&lt;TSource&gt;</a>、<a href="https://msdn.microsoft.com/zh-cn/library/bb341731.aspx">Union&lt;TSource&gt;</a>&nbsp;和&nbsp;<a href="https://msdn.microsoft.com/zh-cn/library/bb302894.aspx">Concat&lt;TSource&gt;</a>）只能用基于方法的语法表示。</p>
<p>&nbsp; &nbsp;&nbsp;<strong>六、排序或过滤任意单词或字段的文本数据</strong></p>
<p>&nbsp; &nbsp;&nbsp;下面的示例演示如何按结构化文本（如逗号分隔值）行中的任意字段对该文本行进行排序，可在运行时动态指定该字段。</p>
<p>&nbsp; &nbsp; 假定scores.csv中的字段表示学生的ID号，后面跟着四个测验分数。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('874c8dcd-74d5-4196-a765-c3688d2cf3a6')"><img id="code_img_closed_874c8dcd-74d5-4196-a765-c3688d2cf3a6" class="code_img_closed" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串0.png" alt="" /><img id="code_img_opened_874c8dcd-74d5-4196-a765-c3688d2cf3a6" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('874c8dcd-74d5-4196-a765-c3688d2cf3a6',event)" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串1.png" alt="" />
<div id="cnblogs_code_open_874c8dcd-74d5-4196-a765-c3688d2cf3a6" class="cnblogs_code_hide">
<pre><code><span style="color: #800080;">111</span>, <span style="color: #800080;">97</span>, <span style="color: #800080;">92</span>, <span style="color: #800080;">81</span>, <span style="color: #800080;">60</span>
<span style="color: #800080;">112</span>, <span style="color: #800080;">75</span>, <span style="color: #800080;">84</span>, <span style="color: #800080;">91</span>, <span style="color: #800080;">39</span>
<span style="color: #800080;">113</span>, <span style="color: #800080;">88</span>, <span style="color: #800080;">94</span>, <span style="color: #800080;">65</span>, <span style="color: #800080;">91</span>
<span style="color: #800080;">114</span>, <span style="color: #800080;">97</span>, <span style="color: #800080;">89</span>, <span style="color: #800080;">85</span>, <span style="color: #800080;">82</span>
<span style="color: #800080;">115</span>, <span style="color: #800080;">35</span>, <span style="color: #800080;">72</span>, <span style="color: #800080;">91</span>, <span style="color: #800080;">70</span>
<span style="color: #800080;">116</span>, <span style="color: #800080;">99</span>, <span style="color: #800080;">86</span>, <span style="color: #800080;">90</span>, <span style="color: #800080;">94</span>
<span style="color: #800080;">117</span>, <span style="color: #800080;">93</span>, <span style="color: #800080;">92</span>, <span style="color: #800080;">80</span>, <span style="color: #800080;">87</span>
<span style="color: #800080;">118</span>, <span style="color: #800080;">92</span>, <span style="color: #800080;">90</span>, <span style="color: #800080;">83</span>, <span style="color: #800080;">78</span>
<span style="color: #800080;">119</span>, <span style="color: #800080;">68</span>, <span style="color: #800080;">79</span>, <span style="color: #800080;">88</span>, <span style="color: #800080;">92</span>
<span style="color: #800080;">120</span>, <span style="color: #800080;">99</span>, <span style="color: #800080;">82</span>, <span style="color: #800080;">81</span>, <span style="color: #800080;">79</span>
<span style="color: #800080;">121</span>, <span style="color: #800080;">96</span>, <span style="color: #800080;">85</span>, <span style="color: #800080;">91</span>, <span style="color: #800080;">60</span>
<span style="color: #800080;">122</span>, <span style="color: #800080;">94</span>, <span style="color: #800080;">92</span>, <span style="color: #800080;">91</span>, <span style="color: #800080;">91</span></pre>
</div>
<span class="cnblogs_code_collapse">scores.csv</span></div>
<div class="cnblogs_code" onclick="cnblogs_code_show('db581ffc-984c-42aa-88b8-3d52d32210aa')"><img id="code_img_closed_db581ffc-984c-42aa-88b8-3d52d32210aa" class="code_img_closed" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串0.png" alt="" /><img id="code_img_opened_db581ffc-984c-42aa-88b8-3d52d32210aa" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('db581ffc-984c-42aa-88b8-3d52d32210aa',event)" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串1.png" alt="" />
<div id="cnblogs_code_open_db581ffc-984c-42aa-88b8-3d52d32210aa" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 排序或过滤任意单词或字段的文本数据
            <span style="color: #008000;">//</span><span style="color: #008000;">创建数据源</span>
            <span style="color: #0000ff;">var</span> scores = File.ReadAllLines(<span style="color: #800000;">@"</span><span style="color: #800000;">..\..\scores.csv</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            </span><span style="color: #008000;">//</span><span style="color: #008000;">可以改为0~4的任意值</span>
            <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> sortIndex = <span style="color: #800080;">1</span><span style="color: #000000;">;
            </span><span style="color: #008000;">//</span><span style="color: #008000;">演示从方法返回查询变量，非查询结果。</span>
            <span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> score <span style="color: #0000ff;">in</span><span style="color: #000000;"> SplitSortQuery(scores, sortIndex))
            {
                Console.WriteLine(score);
            }
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 分割字符串排序
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="scores"&gt;&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="num"&gt;&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> IEnumerable&lt;<span style="color: #0000ff;">string</span>&gt; SplitSortQuery(IEnumerable&lt;<span style="color: #0000ff;">string</span>&gt; scores, <span style="color: #0000ff;">int</span><span style="color: #000000;"> num)
        {
            </span><span style="color: #0000ff;">var</span> query = <span style="color: #0000ff;">from</span> line <span style="color: #0000ff;">in</span><span style="color: #000000;"> scores
                        let fields </span>= line.Split(<span style="color: #800000;">'</span><span style="color: #800000;">,</span><span style="color: #800000;">'</span><span style="color: #000000;">)
                        </span><span style="color: #0000ff;">orderby</span><span style="color: #000000;"> fields[num] descending
                        </span><span style="color: #0000ff;">select</span><span style="color: #000000;"> line;
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> query;
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串23.png" alt="" /></p>
<p>&nbsp; &nbsp;&nbsp;<strong>七、对一个分割的文件的字段重新排序</strong></p>
<p>&nbsp; &nbsp; 逗号分隔值 (CSV) 文件是一种文本文件，通常用于存储电子表格数据或其他由行和列表示的表格数据。通过使用<a href="https://msdn.microsoft.com/zh-cn/library/b873y76a.aspx">Split</a>方法分隔字段，可以非常轻松地使用</p>
<p>LINQ来查询和操作CSV文件。事实上，可以使用此技术来重新排列任何结构化文本行部分。此技术不局限于CSV文件。</p>
<p>&nbsp; &nbsp; 在下面的示例中，假定有三列分别代表学生的&ldquo;姓氏&rdquo;、&ldquo;名字&rdquo;和&ldquo;ID&rdquo;，这些字段基于学生的姓氏按字母顺序排列。查询生成一个新序列，其中首先出现的是</p>
<p>ID列，后面的第二列组合了学生的名字和姓氏。根据ID字段重新排列各行，结果保存到新文件，但不修改原始数据。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('01af3670-4dff-4c0b-8f68-77b36ce2aa1e')"><img id="code_img_closed_01af3670-4dff-4c0b-8f68-77b36ce2aa1e" class="code_img_closed" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串0.png" alt="" /><img id="code_img_opened_01af3670-4dff-4c0b-8f68-77b36ce2aa1e" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('01af3670-4dff-4c0b-8f68-77b36ce2aa1e',event)" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串1.png" alt="" />
<div id="cnblogs_code_open_01af3670-4dff-4c0b-8f68-77b36ce2aa1e" class="cnblogs_code_hide">
<pre><code>Adams,Terry,<span style="color: #800080;">120</span><span style="color: #000000;">
Fakhouri,Fadi,</span><span style="color: #800080;">116</span><span style="color: #000000;">
Feng,Hanying,</span><span style="color: #800080;">117</span><span style="color: #000000;">
Garcia,Cesar,</span><span style="color: #800080;">114</span><span style="color: #000000;">
Garcia,Debra,</span><span style="color: #800080;">115</span><span style="color: #000000;">
Garcia,Hugo,</span><span style="color: #800080;">118</span><span style="color: #000000;">
Mortensen,Sven,</span><span style="color: #800080;">113</span><span style="color: #000000;">
O</span><span style="color: #800000;">'</span><span style="color: #800000;">Donnell,Claire,112</span>
Omelchenko,Svetlana,<span style="color: #800080;">111</span><span style="color: #000000;">
Tucker,Lance,</span><span style="color: #800080;">119</span><span style="color: #000000;">
Tucker,Michael,</span><span style="color: #800080;">122</span><span style="color: #000000;">
Zabokritski,Eugene,</span><span style="color: #800080;">121</span></pre>
</div>
<span class="cnblogs_code_collapse">spread.csv</span></div>
<div class="cnblogs_code" onclick="cnblogs_code_show('ed9f57f6-e2b9-4c68-888e-5bd52a98f4fd')"><img id="code_img_closed_ed9f57f6-e2b9-4c68-888e-5bd52a98f4fd" class="code_img_closed" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串0.png" alt="" /><img id="code_img_opened_ed9f57f6-e2b9-4c68-888e-5bd52a98f4fd" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('ed9f57f6-e2b9-4c68-888e-5bd52a98f4fd',event)" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串1.png" alt="" />
<div id="cnblogs_code_open_ed9f57f6-e2b9-4c68-888e-5bd52a98f4fd" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 对一个分割的文件的字段重新排序
            <span style="color: #008000;">//</span><span style="color: #008000;">数据源</span>
            <span style="color: #0000ff;">var</span> lines = File.ReadAllLines(<span style="color: #800000;">@"</span><span style="color: #800000;">..\..\spread.csv</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            </span><span style="color: #008000;">//</span><span style="color: #008000;">将旧数据的第2列的字段放到第一位，逆向结合第0列和第1列的字段。</span>
            <span style="color: #0000ff;">var</span> query = <span style="color: #0000ff;">from</span> line <span style="color: #0000ff;">in</span><span style="color: #000000;"> lines
                        let t </span>= line.Split(<span style="color: #800000;">'</span><span style="color: #800000;">,</span><span style="color: #800000;">'</span><span style="color: #000000;">)
                        </span><span style="color: #0000ff;">orderby</span> t[<span style="color: #800080;">2</span><span style="color: #000000;">]
                        </span><span style="color: #0000ff;">select</span> $<span style="color: #800000;">"</span><span style="color: #800000;">{t[2]} {t[1]} {t[0]}</span><span style="color: #800000;">"</span><span style="color: #000000;">;

            </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> item <span style="color: #0000ff;">in</span><span style="color: #000000;"> query)
            {
                Console.WriteLine(item);
            }
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串28.png" alt="" /></p>
<p>&nbsp; &nbsp;&nbsp;<strong>八、组合和比较字符串集合</strong></p>
<p>&nbsp; &nbsp; 此示例演示如何合并包含文本行的文件，然后排序结果。<span id="mt2" class="sentence" data-source="Specifically, it shows how to perform a simple concatenation, a union, and an intersection on the two sets of text lines." data-guid="8075c6c3e5688b2aedc3e1c1ba5c2edc">具体来说，此示例演示如何对两组文本行执行简单的串联、联合和交集。</span></p>
<p><span class="sentence" data-source="Specifically, it shows how to perform a simple concatenation, a union, and an intersection on the two sets of text lines." data-guid="8075c6c3e5688b2aedc3e1c1ba5c2edc">&nbsp; &nbsp; 注：text1.txt及text2.txt与五、的一致。</span></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('3314e319-9964-435c-99dd-60316be236de')"><img id="code_img_closed_3314e319-9964-435c-99dd-60316be236de" class="code_img_closed" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串0.png" alt="" /><img id="code_img_opened_3314e319-9964-435c-99dd-60316be236de" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('3314e319-9964-435c-99dd-60316be236de',event)" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串1.png" alt="" />
<div id="cnblogs_code_open_3314e319-9964-435c-99dd-60316be236de" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 组合和比较字符串集合
            <span style="color: #0000ff;">var</span> text1 = File.ReadAllLines(<span style="color: #800000;">@"</span><span style="color: #800000;">..\..\text1.txt</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            </span><span style="color: #0000ff;">var</span> text2 = File.ReadAllLines(<span style="color: #800000;">@"</span><span style="color: #800000;">..\..\text2.txt</span><span style="color: #800000;">"</span><span style="color: #000000;">);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">简单连接并排序，重复保存。 </span>
            <span style="color: #0000ff;">var</span> concatQuery = text1.Concat(text2).OrderBy(x =&gt;<span style="color: #000000;"> x);
            OutputQueryResult(concatQuery, </span><span style="color: #800000;">"</span><span style="color: #800000;">Simple concatenate and sort,duplicates are preserved:</span><span style="color: #800000;">"</span><span style="color: #000000;">);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">基于默认字符串比较器连接，并删除重名。 </span>
            <span style="color: #0000ff;">var</span> unionQuery = text1.Union(text2).OrderBy(x =&gt;<span style="color: #000000;"> x);
            OutputQueryResult(unionQuery, </span><span style="color: #800000;">"</span><span style="color: #800000;">Union removes duplicate names:</span><span style="color: #800000;">"</span><span style="color: #000000;">);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">查找在两个文件中出现的名称 </span>
            <span style="color: #0000ff;">var</span> intersectQuery = text1.Intersect(text2).OrderBy(x =&gt;<span style="color: #000000;"> x);
            OutputQueryResult(intersectQuery, </span><span style="color: #800000;">"</span><span style="color: #800000;">Merge based on intersect:</span><span style="color: #800000;">"</span><span style="color: #000000;">);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">在每个列表中找到匹配的字段，使用concat将两个结果合并，然后使用默认的字符串比较器进行排序。</span>
            <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">string</span> nameMatch = <span style="color: #800000;">"</span><span style="color: #800000;">Garcia</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            </span><span style="color: #0000ff;">var</span> matchQuery1 = <span style="color: #0000ff;">from</span> name <span style="color: #0000ff;">in</span><span style="color: #000000;"> text1
                              let t </span>= name.Split(<span style="color: #800000;">'</span><span style="color: #800000;">,</span><span style="color: #800000;">'</span><span style="color: #000000;">)
                              </span><span style="color: #0000ff;">where</span> t[<span style="color: #800080;">0</span>] ==<span style="color: #000000;"> nameMatch
                              </span><span style="color: #0000ff;">select</span><span style="color: #000000;"> name;
            </span><span style="color: #0000ff;">var</span> matchQuery2 = <span style="color: #0000ff;">from</span> name <span style="color: #0000ff;">in</span><span style="color: #000000;"> text2
                              let t </span>= name.Split(<span style="color: #800000;">'</span><span style="color: #800000;">,</span><span style="color: #800000;">'</span><span style="color: #000000;">)
                              </span><span style="color: #0000ff;">where</span> t[<span style="color: #800080;">0</span>] ==<span style="color: #000000;"> nameMatch
                              </span><span style="color: #0000ff;">select</span><span style="color: #000000;"> name;
            </span><span style="color: #0000ff;">var</span> temp = matchQuery1.Concat(matchQuery2).OrderBy(x =&gt;<span style="color: #000000;"> x);
            OutputQueryResult(temp, $</span><span style="color: #800000;">"</span><span style="color: #800000;">Concat based on partial name match \"{nameMatch}\":</span><span style="color: #800000;">"</span><span style="color: #000000;">);

            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 输出查询结果
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="querys"&gt;&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="title"&gt;&lt;/param&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> OutputQueryResult(IEnumerable&lt;<span style="color: #0000ff;">string</span>&gt; querys, <span style="color: #0000ff;">string</span><span style="color: #000000;"> title)
        {
            Console.WriteLine(Environment.NewLine </span>+<span style="color: #000000;"> title);
            </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> query <span style="color: #0000ff;">in</span><span style="color: #000000;"> querys)
            {
                Console.WriteLine(query);
            }
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">Total {querys.Count()} names in list.</span><span style="color: #800000;">"</span><span style="color: #000000;">);
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p><span class="sentence" data-source="Specifically, it shows how to perform a simple concatenation, a union, and an intersection on the two sets of text lines." data-guid="8075c6c3e5688b2aedc3e1c1ba5c2edc">&nbsp; &nbsp; 运行结果如下：</span></p>
<p><img src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串31.png" alt="" /></p>
<p>&nbsp; &nbsp;&nbsp;<strong>九、从多个源中填充对象集合</strong></p>
<p>&nbsp; &nbsp;&nbsp;不要尝试将内存中的数据或文件系统中的数据与仍在数据库中的数据相联接。此种跨域联接会生成未定义的结果，因为数据库查询和其他类型的源定义联</p>
<p>接运算的方式可能不同。另外，如果数据库中的数据量足够大，则存在此类运算引发内存不足异常的风险。若要将数据库数据与内存中的数据相联接，请首</p>
<p>先对数据库查询调用ToList或ToArray，然后对返回的集合执行联接。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('3adc8f64-b812-4809-9118-4affd210d8c2')"><img id="code_img_closed_3adc8f64-b812-4809-9118-4affd210d8c2" class="code_img_closed" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串0.png" alt="" /><img id="code_img_opened_3adc8f64-b812-4809-9118-4affd210d8c2" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('3adc8f64-b812-4809-9118-4affd210d8c2',event)" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串1.png" alt="" />
<div id="cnblogs_code_open_3adc8f64-b812-4809-9118-4affd210d8c2" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 从多个源中填充对象集合
            <span style="color: #008000;">//</span><span style="color: #008000;">spread.csv每行包含姓氏、名字和身份证号，以逗号分隔。例如，Omelchenko,Svetlana,111</span>
            <span style="color: #0000ff;">var</span> names = File.ReadAllLines(<span style="color: #800000;">@"</span><span style="color: #800000;">..\..\spread.csv</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            </span><span style="color: #008000;">//</span><span style="color: #008000;">scores.csv每行包括身份证号码和四个测试评分，以逗号分隔。例如，111，97，92，81，60 </span>
            <span style="color: #0000ff;">var</span> scores = File.ReadAllLines(<span style="color: #800000;">@"</span><span style="color: #800000;">..\..\scores.csv</span><span style="color: #800000;">"</span><span style="color: #000000;">);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">使用一个匿名的类型合并数据源。
            </span><span style="color: #008000;">//</span><span style="color: #008000;">注：动态创建一个int的考试成绩成员列表。
            </span><span style="color: #008000;">//</span><span style="color: #008000;">跳过分割字符串中的第一项，因为它是学生的身份证，不是一个考试成绩。</span>
            <span style="color: #0000ff;">var</span> students = <span style="color: #0000ff;">from</span> name <span style="color: #0000ff;">in</span><span style="color: #000000;"> names
                           let t1 </span>= name.Split(<span style="color: #800000;">'</span><span style="color: #800000;">,</span><span style="color: #800000;">'</span><span style="color: #000000;">)
                           </span><span style="color: #0000ff;">from</span> score <span style="color: #0000ff;">in</span><span style="color: #000000;"> scores
                           let t2 </span>= score.Split(<span style="color: #800000;">'</span><span style="color: #800000;">,</span><span style="color: #800000;">'</span><span style="color: #000000;">)
                           </span><span style="color: #0000ff;">where</span> t1[<span style="color: #800080;">2</span>] == t2[<span style="color: #800080;">0</span><span style="color: #000000;">]
                           </span><span style="color: #0000ff;">select</span> <span style="color: #0000ff;">new</span><span style="color: #000000;">
                           {
                               FirstName </span>= t1[<span style="color: #800080;">0</span><span style="color: #000000;">],
                               LastName </span>= t1[<span style="color: #800080;">1</span><span style="color: #000000;">],
                               ID </span>= Convert.ToInt32(t1[<span style="color: #800080;">2</span><span style="color: #000000;">]),
                               ExamScores </span>= (<span style="color: #0000ff;">from</span> score <span style="color: #0000ff;">in</span> t2.Skip(<span style="color: #800080;">1</span>) <span style="color: #0000ff;">select</span><span style="color: #000000;"> Convert.ToInt32(score)).ToList()
                           };

            </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> student <span style="color: #0000ff;">in</span><span style="color: #000000;"> students)
            {
                Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">The average score of {student.FirstName} {student.LastName} is {student.ExamScores.Average()}.</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串34.png" alt="" /></p>
<p>&nbsp; &nbsp; <strong>十、使用group将一个文件拆分成多个文件</strong></p>
<p>&nbsp; &nbsp;&nbsp;此示例演示一种进行以下操作的方法：合并两个文件的内容，然后创建一组以新方式组织数据的新文件。</p>
<p>&nbsp; &nbsp;&nbsp;注：text1.txt及text2.txt与五、的一致。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('ca8acd22-dc59-4c49-9a1d-af44cac9eb0a')"><img id="code_img_closed_ca8acd22-dc59-4c49-9a1d-af44cac9eb0a" class="code_img_closed" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串0.png" alt="" /><img id="code_img_opened_ca8acd22-dc59-4c49-9a1d-af44cac9eb0a" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('ca8acd22-dc59-4c49-9a1d-af44cac9eb0a',event)" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串1.png" alt="" />
<div id="cnblogs_code_open_ca8acd22-dc59-4c49-9a1d-af44cac9eb0a" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 使用group将一个文件拆分成多个文件
            <span style="color: #0000ff;">var</span> text1 = File.ReadAllLines(<span style="color: #800000;">@"</span><span style="color: #800000;">..\..\text1.txt</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            </span><span style="color: #0000ff;">var</span> text2 = File.ReadAllLines(<span style="color: #800000;">@"</span><span style="color: #800000;">..\..\text2.txt</span><span style="color: #800000;">"</span><span style="color: #000000;">);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">并集：连接并删除重复的名字</span>
            <span style="color: #0000ff;">var</span> mergeQuery =<span style="color: #000000;"> text1.Union(text2);
            </span><span style="color: #008000;">//</span><span style="color: #008000;">根据姓氏的首字母对姓名进行分组</span>
            <span style="color: #0000ff;">var</span> query = <span style="color: #0000ff;">from</span> name <span style="color: #0000ff;">in</span><span style="color: #000000;"> mergeQuery
                        let t </span>= name.Split(<span style="color: #800000;">'</span><span style="color: #800000;">,</span><span style="color: #800000;">'</span><span style="color: #000000;">)
                        group name by t[</span><span style="color: #800080;">0</span>][<span style="color: #800080;">0</span><span style="color: #000000;">] into g
                        </span><span style="color: #0000ff;">orderby</span><span style="color: #000000;"> g.Key
                        </span><span style="color: #0000ff;">select</span><span style="color: #000000;"> g;

            </span><span style="color: #008000;">//</span><span style="color: #008000;">注意嵌套的 foreach 循环</span>
            <span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> g <span style="color: #0000ff;">in</span><span style="color: #000000;"> query)
            {
                </span><span style="color: #0000ff;">var</span> fileName = <span style="color: #800000;">@"</span><span style="color: #800000;">testFile_</span><span style="color: #800000;">"</span> + g.Key + <span style="color: #800000;">"</span><span style="color: #800000;">.txt</span><span style="color: #800000;">"</span><span style="color: #000000;">;
                Console.WriteLine(g.Key </span>+ <span style="color: #800000;">"</span><span style="color: #800000;">:</span><span style="color: #800000;">"</span><span style="color: #000000;">);

                </span><span style="color: #008000;">//</span><span style="color: #008000;">写入文件</span>
                <span style="color: #0000ff;">using</span> (<span style="color: #0000ff;">var</span> sw = <span style="color: #0000ff;">new</span><span style="color: #000000;"> StreamWriter(fileName))
                {
                    </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> name <span style="color: #0000ff;">in</span><span style="color: #000000;"> g)
                    {
                        sw.WriteLine(name);
                        Console.WriteLine(</span><span style="color: #800000;">"</span> <span style="color: #800000;">"</span> +<span style="color: #000000;"> name);
                    }
                }
            }
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串37.png" alt="" /></p>
<p>&nbsp; &nbsp;&nbsp;<strong>十一、向不同的文件中加入内容</strong></p>
<p>&nbsp; &nbsp; 此示例演示如何联接两个逗号分隔文件中的数据，这两个文件共享一个用作匹配键的共同值。如果您必须将两个电子表格的数据或一个电子表格和一个其</p>
<p>他格式的文件的数据组合为一个新文件，则此技术很有用，还可以修改此示例以适合任意种类的结构化文本。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('4c0f93dc-bdba-457e-9356-3702f518a8c2')"><img id="code_img_closed_4c0f93dc-bdba-457e-9356-3702f518a8c2" class="code_img_closed" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串0.png" alt="" /><img id="code_img_opened_4c0f93dc-bdba-457e-9356-3702f518a8c2" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('4c0f93dc-bdba-457e-9356-3702f518a8c2',event)" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串1.png" alt="" />
<div id="cnblogs_code_open_4c0f93dc-bdba-457e-9356-3702f518a8c2" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 向不同的文件中加入内容
            <span style="color: #0000ff;">var</span> names = File.ReadAllLines(<span style="color: #800000;">@"</span><span style="color: #800000;">..\..\spread.csv</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            </span><span style="color: #0000ff;">var</span> scores = File.ReadAllLines(<span style="color: #800000;">@"</span><span style="color: #800000;">..\..\scores.csv</span><span style="color: #800000;">"</span><span style="color: #000000;">);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">该查询基于ID连接两个不同的电子表格</span>
            <span style="color: #0000ff;">var</span> query = <span style="color: #0000ff;">from</span> name <span style="color: #0000ff;">in</span><span style="color: #000000;"> names
                        let t1 </span>= name.Split(<span style="color: #800000;">'</span><span style="color: #800000;">,</span><span style="color: #800000;">'</span><span style="color: #000000;">)
                        </span><span style="color: #0000ff;">from</span> score <span style="color: #0000ff;">in</span><span style="color: #000000;"> scores
                        let t2 </span>= score.Split(<span style="color: #800000;">'</span><span style="color: #800000;">,</span><span style="color: #800000;">'</span><span style="color: #000000;">)
                        </span><span style="color: #0000ff;">where</span> t1[<span style="color: #800080;">2</span>] == t2[<span style="color: #800080;">0</span><span style="color: #000000;">]
                        </span><span style="color: #0000ff;">orderby</span> t1[<span style="color: #800080;">0</span><span style="color: #000000;">]
                        </span><span style="color: #0000ff;">select</span> $<span style="color: #800000;">"</span><span style="color: #800000;">{t1[0]},{t2[1]},{t2[2]},{t2[3]},{t2[4]}</span><span style="color: #800000;">"</span><span style="color: #000000;">;

            </span><span style="color: #008000;">//</span><span style="color: #008000;">输出</span>
            OutputQueryResult(query, <span style="color: #800000;">"</span><span style="color: #800000;">Merge two spreadsheets:</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 输出查询结果
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="querys"&gt;&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="title"&gt;&lt;/param&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> OutputQueryResult(IEnumerable&lt;<span style="color: #0000ff;">string</span>&gt; querys, <span style="color: #0000ff;">string</span><span style="color: #000000;"> title)
        {
            Console.WriteLine(Environment.NewLine </span>+<span style="color: #000000;"> title);
            </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> query <span style="color: #0000ff;">in</span><span style="color: #000000;"> querys)
            {
                Console.WriteLine(query);
            }
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">Total {querys.Count()} names in list.</span><span style="color: #800000;">"</span><span style="color: #000000;">);
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串40.png" alt="" /></p>
<p><strong>&nbsp; &nbsp;&nbsp;十二、计算一个CSV文本文件中的列值</strong></p>
<p>&nbsp; &nbsp; 此示例演示如何对.csv文件的列执行诸如Sum、Average、Min和Max等聚合计算，此示例可以应用于其他类型的结构化文本。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('9d1791a5-0b76-47a8-8bbe-50c570c1a65c')"><img id="code_img_closed_9d1791a5-0b76-47a8-8bbe-50c570c1a65c" class="code_img_closed" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串0.png" alt="" /><img id="code_img_opened_9d1791a5-0b76-47a8-8bbe-50c570c1a65c" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('9d1791a5-0b76-47a8-8bbe-50c570c1a65c',event)" src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串1.png" alt="" />
<div id="cnblogs_code_open_9d1791a5-0b76-47a8-8bbe-50c570c1a65c" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 计算一个CSV文本文件中的列值
            <span style="color: #0000ff;">var</span> scores = File.ReadAllLines(<span style="color: #800000;">@"</span><span style="color: #800000;">..\..\scores.csv</span><span style="color: #800000;">"</span><span style="color: #000000;">);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">指定要计算的列</span>
            <span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> examNum = <span style="color: #800080;">3</span><span style="color: #000000;">;

            </span><span style="color: #008000;">//</span><span style="color: #008000;">+1表示跳过第一列
            </span><span style="color: #008000;">//</span><span style="color: #008000;">统计单列</span>
            SingleColumn(scores, examNum + <span style="color: #800080;">1</span><span style="color: #000000;">);

            Console.WriteLine();

            </span><span style="color: #008000;">//</span><span style="color: #008000;">统计多列</span>
<span style="color: #000000;">            MultiColumns(scores);

            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 统计单列
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="lines"&gt;&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="examNum"&gt;&lt;/param&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> SingleColumn(IEnumerable&lt;<span style="color: #0000ff;">string</span>&gt; lines, <span style="color: #0000ff;">int</span><span style="color: #000000;"> examNum)
        {
            Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">Single Column Query:</span><span style="color: #800000;">"</span><span style="color: #000000;">);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">查询步骤：
            </span><span style="color: #008000;">//</span><span style="color: #008000;">1.分割字符串
            </span><span style="color: #008000;">//</span><span style="color: #008000;">2.对要计算的列的值转换为int</span>
            <span style="color: #0000ff;">var</span> query = <span style="color: #0000ff;">from</span> line <span style="color: #0000ff;">in</span><span style="color: #000000;"> lines
                        let t </span>= line.Split(<span style="color: #800000;">'</span><span style="color: #800000;">,</span><span style="color: #800000;">'</span><span style="color: #000000;">)
                        </span><span style="color: #0000ff;">select</span><span style="color: #000000;"> Convert.ToInt32(t[examNum]);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">对指定的列进行统计</span>
            <span style="color: #0000ff;">var</span> average =<span style="color: #000000;"> query.Average();
            </span><span style="color: #0000ff;">var</span> max =<span style="color: #000000;"> query.Max();
            </span><span style="color: #0000ff;">var</span> min =<span style="color: #000000;"> query.Min();

            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">Exam #{examNum}: Average:{average:##.##} High Score:{max} Low Score:{min}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 统计多列
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="lines"&gt;&lt;/param&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> MultiColumns(IEnumerable&lt;<span style="color: #0000ff;">string</span>&gt;<span style="color: #000000;"> lines)
        {
            Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">Multi Column Query:</span><span style="color: #800000;">"</span><span style="color: #000000;">);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">查询步骤：
            </span><span style="color: #008000;">//</span><span style="color: #008000;">1.分割字符串
            </span><span style="color: #008000;">//</span><span style="color: #008000;">2.跳过ID列（第一列）
            </span><span style="color: #008000;">//</span><span style="color: #008000;">3.将当前行的每个评分都转换成int，并选择整个序列作为一行结果。 </span>
            <span style="color: #0000ff;">var</span> query1 = <span style="color: #0000ff;">from</span> line <span style="color: #0000ff;">in</span><span style="color: #000000;"> lines
                         let t1 </span>= line.Split(<span style="color: #800000;">'</span><span style="color: #800000;">,</span><span style="color: #800000;">'</span><span style="color: #000000;">)
                         let t2 </span>= t1.Skip(<span style="color: #800080;">1</span><span style="color: #000000;">)
                         </span><span style="color: #0000ff;">select</span> (<span style="color: #0000ff;">from</span> t <span style="color: #0000ff;">in</span> t2 <span style="color: #0000ff;">select</span><span style="color: #000000;"> Convert.ToInt32(t));

            </span><span style="color: #008000;">//</span><span style="color: #008000;">执行查询并缓存结果以提高性能</span>
            <span style="color: #0000ff;">var</span> results =<span style="color: #000000;"> query1.ToList();
            </span><span style="color: #008000;">//</span><span style="color: #008000;">找出结果的列数</span>
            <span style="color: #0000ff;">var</span> count = results[<span style="color: #800080;">0</span><span style="color: #000000;">].Count();

            </span><span style="color: #008000;">//</span><span style="color: #008000;">执行统计</span>
            <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">var</span> i = <span style="color: #800080;">0</span>; i &lt; count; i++<span style="color: #000000;">)
            {
                </span><span style="color: #0000ff;">var</span> query2 = <span style="color: #0000ff;">from</span> result <span style="color: #0000ff;">in</span><span style="color: #000000;"> results
                             </span><span style="color: #0000ff;">select</span><span style="color: #000000;"> result.ElementAt(i);
                </span><span style="color: #0000ff;">var</span> average =<span style="color: #000000;"> query2.Average();
                </span><span style="color: #0000ff;">var</span> max =<span style="color: #000000;"> query2.Max();
                </span><span style="color: #0000ff;">var</span> min =<span style="color: #000000;"> query2.Min();
                </span><span style="color: #008000;">//</span><span style="color: #008000;">#1表示第一次考试</span>
                Console.WriteLine($<span style="color: #800000;">"</span><span style="color: #800000;">Exam #{i + 1} Average: {average:##.##} High Score: {max} Low Score: {min}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }

        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C# LINQ学习笔记三：LINQ to OBJECT之操作字符串43.png" alt="" /></p>

</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>