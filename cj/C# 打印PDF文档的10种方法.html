<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修C# 打印PDF文档的10种方法' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>C# 打印PDF文档的10种方法</center></div><div class='banquan'>原文出处:本文由博客园博主E-iceblue提供。<br/>
原文连接:https://www.cnblogs.com/Yesi/p/10755996.html</div><br>
    <p>操作PDF文档时，打印是常见的需求之一。针对不同的打印需求，可分多种情况来进行，如设置静默打印、指定打印页码范围和打印纸张大小、双面打印、黑白打印等等。经过测试，下面将对常见的几种PDF打印需求做一些归纳总结，这里归纳了10种打印需求及方法。如下：</p>
<ol>
<li>使用默认打印机打印PDF文档</li>
<li>使用虚拟打印机（Microsoft XPS Document Writer）打印PDF文档</li>
<li>指定打印机及PDF文档打印页码范围</li>
<li>静默打印PDF文档</li>
<li>双面打印PDF文档</li>
<li>黑白打印PDF文档</li>
<li>打印PDF文档时选择不同的出纸盒</li>
<li>将PDF文档打印多份</li>
<li>打印PDF一页为多页、打印多页为一页</li>
<li>自定义纸张大小打印PDF</li>
</ol>
<h3><strong>使用工具</strong>：Spire.PDF for .NET</h3>
<h3><strong>获取方法：</strong></h3>
<p>1. 通过<span style="color: #339966;"><a href="https://www.e-iceblue.cn/Downloads/Spire-PDF-NET.html"><span style="color: #339966;">官网</span></a></span>下载。在程序中添加引用Spire.Pdf.dll，dll文件在安装路径下的bin文件夹中。</p>
<p>2. 通过<span style="color: #339966;"><a href="https://www.nuget.org/packages/Spire.PDF/"><span style="color: #339966;">Nuget</span></a></span>网站下载。</p>
<h2>&nbsp;C# 示例代码</h2>
<h3><strong>【示例</strong><strong>1</strong><strong>】使用默认打印机打印</strong><strong>PDF</strong></h3>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//创建PdfDocument类的对象，并</span><span style="color: #008000;">加载PDF文档</span>
PdfDocument doc = <span style="color: #0000ff;">new</span><span style="color: #000000;"> PdfDocument();
doc.LoadFromFile(</span><span style="color: #800000;">"</span><span style="color: #800000;">Test.pdf</span><span style="color: #800000;">"</span><span style="color: #000000;">);

</span><span style="color: #008000;">//</span><span style="color: #008000;">使用默认打印机打印文档所有页面</span>
doc.Print();</pre>
</div>
<p>&nbsp;</p>
<h3><strong>【示例</strong><strong>2</strong><strong>】使用虚拟打印机（</strong><strong>Microsoft XPS Document Writer</strong><strong>）打印</strong><strong>PDF</strong></h3>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">加载PDF文档</span>
PdfDocument doc = <span style="color: #0000ff;">new</span><span style="color: #000000;"> PdfDocument();
doc.LoadFromFile(</span><span style="color: #800000;">"</span><span style="color: #800000;">Test.pdf</span><span style="color: #800000;">"</span><span style="color: #000000;">);

</span><span style="color: #008000;">//</span><span style="color: #008000;">选择Microsoft XPS Document Writer打印机</span>
doc.PrintSettings.PrinterName = <span style="color: #800000;">"</span><span style="color: #800000;">Microsoft XPS Document Writer</span><span style="color: #800000;">"</span><span style="color: #000000;">;

</span><span style="color: #008000;">//</span><span style="color: #008000;">打印PDF文档到XPS格式</span>
doc.PrintSettings.PrintToFile(<span style="color: #800000;">"</span><span style="color: #800000;">PrintToXps.xps</span><span style="color: #800000;">"</span><span style="color: #000000;">);
doc.Print();</span></pre>
</div>
<p>&nbsp;</p>
<h3><strong>【示例</strong><strong>3</strong><strong>】指定打印机及</strong><strong>PDF</strong><strong>文档打印页码范围</strong></h3>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">加载PDF文档</span>
PdfDocument doc = <span style="color: #0000ff;">new</span><span style="color: #000000;"> PdfDocument();
doc.LoadFromFile(</span><span style="color: #800000;">"</span><span style="color: #800000;">Test.pdf</span><span style="color: #800000;">"</span><span style="color: #000000;">);

</span><span style="color: #008000;">//</span><span style="color: #008000;">指定打印机</span>
doc.PrintSettings.PrinterName = <span style="color: #800000;">"</span><span style="color: #800000;">HP LaserJet P1007</span><span style="color: #800000;">"</span><span style="color: #000000;">;

</span><span style="color: #008000;">//</span><span style="color: #008000;">设置文档打印页码范围</span>
doc.PrintSettings.SelectPageRange(<span style="color: #800080;">1</span>, <span style="color: #800080;">5</span><span style="color: #000000;">);

</span><span style="color: #008000;">//</span><span style="color: #008000;">打印不连续的页面
</span><span style="color: #008000;">//</span><span style="color: #008000;">doc.PrintSettings.SelectSomePages(new int[] { 1, 3, 5, 7 });

</span><span style="color: #008000;">//</span><span style="color: #008000;">打印PDF文档</span>
doc.Print();</pre>
</div>
<p>&nbsp;</p>
<h3><strong>【示例4】静默打印PDF</strong></h3>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">加载PDF文档</span>
PdfDocument doc = <span style="color: #0000ff;">new</span><span style="color: #000000;"> PdfDocument();
doc.LoadFromFile(</span><span style="color: #800000;">"</span><span style="color: #800000;">Test.pdf</span><span style="color: #800000;">"</span><span style="color: #000000;">);

</span><span style="color: #008000;">//</span><span style="color: #008000;">静默打印PDF文档</span>
doc.PrintSettings.PrintController = <span style="color: #0000ff;">new</span><span style="color: #000000;"> StandardPrintController();
doc.Print();</span></pre>
</div>
<p>&nbsp;</p>
<h3><strong>【示例</strong><strong>5</strong><strong>】双面打印</strong><strong>PDF</strong></h3>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">加载PDF文档</span>
PdfDocument doc = <span style="color: #0000ff;">new</span><span style="color: #000000;"> PdfDocument();
doc.LoadFromFile(</span><span style="color: #800000;">"</span><span style="color: #800000;">Test.pdf</span><span style="color: #800000;">"</span><span style="color: #000000;">);

</span><span style="color: #008000;">//</span><span style="color: #008000;">判断打印机是否支持双面打印</span>
<span style="color: #0000ff;">if</span><span style="color: #000000;"> (doc.PrintSettings.CanDuplex)
{
    </span><span style="color: #008000;">//</span><span style="color: #008000;">如果支持则设置双面打印模式，可选：Default/Simplex/Horizontal/Vertical</span>
    doc.PrintSettings.Duplex =<span style="color: #000000;"> Duplex.Default;
    </span><span style="color: #008000;">//</span><span style="color: #008000;">打印PDF文档</span>
<span style="color: #000000;">    doc.Print();
}</span></pre>
</div>
<p>&nbsp;</p>
<h3><strong>【示例</strong><strong>6</strong><strong>】黑白打印</strong><strong>PDF</strong></h3>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">加载PDF文档</span>
PdfDocument pdf = <span style="color: #0000ff;">new</span><span style="color: #000000;"> PdfDocument();
pdf.LoadFromFile(</span><span style="color: #800000;">"</span><span style="color: #800000;">Test.pdf</span><span style="color: #800000;">"</span><span style="color: #000000;">);

</span><span style="color: #008000;">//</span><span style="color: #008000;">黑白打印PDF文档</span>
pdf.PrintSettings.Color = <span style="color: #0000ff;">false</span><span style="color: #000000;">;
pdf.Print();</span></pre>
</div>
<p>&nbsp;</p>
<h3><strong>【示例7】打印PDF文档时选择不同的出纸盒</strong></h3>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">加载PDF文档</span>
PdfDocument doc = <span style="color: #0000ff;">new</span><span style="color: #000000;"> PdfDocument();
doc.LoadFromFile(</span><span style="color: #800000;">"</span><span style="color: #800000;">Test.pdf</span><span style="color: #800000;">"</span><span style="color: #000000;">);

</span><span style="color: #008000;">//</span><span style="color: #008000;">设置纸盒</span>
doc.PrintSettings.PaperSettings += <span style="color: #0000ff;">delegate</span>(<span style="color: #0000ff;">object</span><span style="color: #000000;"> sender, PdfPaperSettingsEventArgs e)
{
    </span><span style="color: #008000;">//</span><span style="color: #008000;">设置页面1-50的纸张来源为纸盒1</span>
    <span style="color: #0000ff;">if</span> (<span style="color: #800080;">1</span> &lt;= e.CurrentPaper &amp;&amp; e.CurrentPaper &lt;= <span style="color: #800080;">50</span><span style="color: #000000;">)
    {
        e.CurrentPaperSource </span>= e.PaperSources[<span style="color: #800080;">0</span><span style="color: #000000;">];
    }
    </span><span style="color: #008000;">//</span><span style="color: #008000;">设置余下页面的纸张来源为纸盒2</span>
    <span style="color: #0000ff;">else</span><span style="color: #000000;">
    {
        e.CurrentPaperSource </span>= e.PaperSources[<span style="color: #800080;">1</span><span style="color: #000000;">];
    }
};

</span><span style="color: #008000;">//</span><span style="color: #008000;">打印PDF文档</span>
doc.Print();</pre>
</div>
<p>&nbsp;</p>
<h3><strong>【示例</strong><strong>8</strong><strong>】将</strong><strong>PDF</strong><strong>文档打印多份</strong></h3>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">加载PDF文档</span>
PdfDocument doc = <span style="color: #0000ff;">new</span><span style="color: #000000;"> PdfDocument();
doc.LoadFromFile(</span><span style="color: #800000;">"</span><span style="color: #800000;">Test.pdf</span><span style="color: #800000;">"</span><span style="color: #000000;">);

</span><span style="color: #008000;">//</span><span style="color: #008000;">设置打印份数为2份</span>
doc.PrintSettings.Copies = <span style="color: #800080;">2</span><span style="color: #000000;">;

</span><span style="color: #008000;">//</span><span style="color: #008000;">打印PDF文档</span>
doc.Print();</pre>
</div>
<p>&nbsp;</p>
<h3><strong>【示例</strong><strong>9</strong><strong>】打印</strong><strong>PDF</strong><strong>一页为多页，多页为一页</strong></h3>
<p>1. 调用PdfPrintSettings类的SelectMultiPageLayout方法将一个PDF文档的多张页面打印到一张纸上。</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">实例化一个PdfDocument对象</span>
PdfDocument pdf = <span style="color: #0000ff;">new</span><span style="color: #000000;"> PdfDocument();
</span><span style="color: #008000;">//</span><span style="color: #008000;">载入PDF文档</span>
pdf.LoadFromFile(<span style="color: #800000;">"</span><span style="color: #800000;">Input.pdf</span><span style="color: #800000;">"</span><span style="color: #000000;">);

</span><span style="color: #008000;">//</span><span style="color: #008000;">将PDF文档的每两张页面打印到一张纸上（排版格式为1行，2列）</span>
pdf.PrintSettings.SelectMultiPageLayout(<span style="color: #800080;">1</span>, <span style="color: #800080;">2</span><span style="color: #000000;">);
pdf.Print()</span></pre>
</div>
<p>2. PdfPrintSettings类的SelectSplitPageLayout方法支持将一个PDF文档的单张页面打印到多张纸上。该方法是根据A4纸的标准尺寸595pt*842pt对PDF页面进行拆分，超过该大小的页面，打印时其超过部分将会被打印到下一张纸。</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">实例化一个PdfDocument对象</span>
PdfDocument pdf = <span style="color: #0000ff;">new</span><span style="color: #000000;"> PdfDocument();
</span><span style="color: #008000;">//</span><span style="color: #008000;">载入PDF文档</span>
pdf.LoadFromFile(<span style="color: #800000;">"</span><span style="color: #800000;">Input1.pdf</span><span style="color: #800000;">"</span><span style="color: #000000;">);

</span><span style="color: #008000;">//</span><span style="color: #008000;">将PDF文档的单张页面根据标准页面大小进行拆分并打印</span>
<span style="color: #000000;">pdf.PrintSettings.SelectSplitPageLayout();
pdf.Print()</span></pre>
</div>
<p>&nbsp;</p>
<h3><strong>【示例</strong><strong>10</strong><strong>】自定义纸张大小打印</strong><strong>PDF</strong></h3>
<p>1. 使用虚拟打印机自定义纸张大小打印：保持原来页面大小打印到PDF</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">加载需要打印的PDF文档</span>
Spire.Pdf.PdfDocument doc = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Spire.Pdf.PdfDocument();
doc.LoadFromFile(FileName);

</span><span style="color: #008000;">//</span><span style="color: #008000;">获取原文档第一页的纸张大小,这里的单位是Point</span>
SizeF size = doc.Pages[<span style="color: #800080;">0</span><span style="color: #000000;">].Size;

</span><span style="color: #008000;">//</span><span style="color: #008000;">实例化PaperSize对象，设置其宽高
</span><span style="color: #008000;">//</span><span style="color: #008000;">需要特别注意的是这里涉及到单位的转换，PaperSize的宽高参数默认单位是百英寸 </span>
PaperSize paper = <span style="color: #0000ff;">new</span> PaperSize(<span style="color: #800000;">"</span><span style="color: #800000;">Custom</span><span style="color: #800000;">"</span>, (<span style="color: #0000ff;">int</span>)size.Width/<span style="color: #800080;">72</span>*<span style="color: #800080;">100</span>, (<span style="color: #0000ff;">int</span>)size.Height/<span style="color: #800080;">72</span>*<span style="color: #800080;">100</span><span style="color: #000000;">);
paper.RawKind </span>= (<span style="color: #0000ff;">int</span><span style="color: #000000;">)PaperKind.Custom;

</span><span style="color: #008000;">//</span><span style="color: #008000;">设置打印的纸张大小为原来文档的大小</span>
doc.PrintSettings.PaperSize =<span style="color: #000000;"> paper;

</span><span style="color: #008000;">//</span><span style="color: #008000;">需要选择FitSize打印模式</span>
doc.PrintSettings.SelectSinglePageLayout(PdfSinglePageScalingMode.FitSize, <span style="color: #0000ff;">true</span><span style="color: #000000;">);
</span><span style="color: #008000;">//</span><span style="color: #008000;">打印</span>
doc.Print();</pre>
</div>
<p>2. 使用真实打印机设置纸盒中的纸张大小打印：将原来A4的文档打印成A3的大小。</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">加载需要打印的PDF文档</span>
 Spire.Pdf.PdfDocument doc = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Spire.Pdf.PdfDocument();
 doc.LoadFromFile(FileName);

 PaperSize p </span>= <span style="color: #0000ff;">null</span><span style="color: #000000;">;
 </span><span style="color: #008000;">//</span><span style="color: #008000;">实例化一个PrintDocument对象来获取当前打印机的纸盒信息</span>
 PrintDocument printDoc = <span style="color: #0000ff;">new</span><span style="color: #000000;"> PrintDocument();

 </span><span style="color: #008000;">//</span><span style="color: #008000;">遍历打印机纸盒里面的纸张，找到需要的A3</span>
<span style="color: #0000ff;">foreach</span> (PaperSize ps <span style="color: #0000ff;">in</span><span style="color: #000000;"> printDoc.PrinterSettings.PaperSizes)
            {
                </span><span style="color: #0000ff;">if</span> (ps.PaperName.Equals(<span style="color: #800000;">"</span><span style="color: #800000;">A3</span><span style="color: #800000;">"</span><span style="color: #000000;">))
                {
                    p </span>=<span style="color: #000000;"> ps;
                    </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
                }
               
            }

 </span><span style="color: #008000;">//</span><span style="color: #008000;">设置打印的纸张大小为A3</span>
 doc.PrintSettings.PaperSize =<span style="color: #000000;"> p;

 </span><span style="color: #008000;">//</span><span style="color: #008000;">打印</span>
 doc.PrintSettings.SelectSinglePageLayout(PdfSinglePageScalingMode.FitSize, <span style="color: #0000ff;">true</span><span style="color: #000000;">);
 doc.Print();</span></pre>
</div>
<p>&nbsp;</p>
<p>（本文完）</p>
<p>更多关于PDF打印详情，可查看视频 <a href="https://v.youku.com/v_show/id_XNDAyNzg3NDE3Ng==.html?spm=a2hzp.8253869.0.0" target="_blank">C# 打印PDF视频教程</a></p>
<p>转载请注明出处！</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>