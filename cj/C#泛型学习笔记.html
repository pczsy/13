<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修C#泛型学习笔记' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>C#泛型学习笔记</center></div><div class='banquan'>原文出处:本文由博客园博主缥缈的尘埃提供。<br/>
原文连接:https://www.cnblogs.com/atomy/p/12060753.html</div><br>
    <p>&nbsp; &nbsp;本笔记摘抄自：<a href="https://www.cnblogs.com/dotnet261010/p/9034594.html">https://www.cnblogs.com/dotnet261010/p/9034594.html</a>，记录一下学习过程以备后续查用。</p>
<p><strong>&nbsp; &nbsp; 一、什么是泛型</strong></p>
<p>&nbsp; &nbsp; 泛型是C#2.0推出的新语法，不是语法糖，而是2.0由框架升级提供的功能。泛型类就类似于一个模板，可以在需要时为这个模板传入任何我们需要的类型。</p>
<p>&nbsp; &nbsp; <strong>二、为什么使用泛型</strong></p>
<p>&nbsp; &nbsp; 下面代码演示输出几种类型的相关信息：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('2cb9a714-65ff-4c9e-852f-c986397251fa')"><img id="code_img_closed_2cb9a714-65ff-4c9e-852f-c986397251fa" class="code_img_closed" src="./images/C#泛型学习笔记0.png" alt="" /><img id="code_img_opened_2cb9a714-65ff-4c9e-852f-c986397251fa" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('2cb9a714-65ff-4c9e-852f-c986397251fa',event)" src="./images/C#泛型学习笔记1.png" alt="" />
<div id="cnblogs_code_open_2cb9a714-65ff-4c9e-852f-c986397251fa" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 打印帮助类
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> ShowHelper
        {
            </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
            <span style="color: #808080;">///</span><span style="color: #008000;"> ShowInt
            </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
            <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="intParam"&gt;&lt;/param&gt;</span>
            <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> ShowInt(<span style="color: #0000ff;">int</span><span style="color: #000000;"> intParam)
            {
                Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">Class={typeof(ShowHelper).Name},Type={intParam.GetType().Name},Parameter={intParam}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }

            </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
            <span style="color: #808080;">///</span><span style="color: #008000;"> ShowString
            </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
            <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="strParam"&gt;&lt;/param&gt;</span>
            <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> ShowString(<span style="color: #0000ff;">string</span><span style="color: #000000;"> strParam)
            {
                Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">Class={typeof(ShowHelper).Name},Type={strParam.GetType().Name},Parameter={strParam}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }

            </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
            <span style="color: #808080;">///</span><span style="color: #008000;"> ShowDateTime
            </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
            <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="dtParam"&gt;&lt;/param&gt;</span>
            <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> ShowDateTime(DateTime dtParam)
            {
                Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">Class={typeof(ShowHelper).Name},Type={dtParam.GetType().Name},Parameter={dtParam}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }
        }

        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> 非泛型打印方式一<span style="color: #000000;">
            ShowHelper.ShowInt(</span><span style="color: #800080;">123</span><span style="color: #000000;">);
            ShowHelper.ShowString(</span><span style="color: #800000;">"</span><span style="color: #800000;">Hello World.</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            ShowHelper.ShowDateTime(DateTime.Now);
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C#泛型学习笔记2.png" alt="" /></p>
<p>&nbsp; &nbsp; 上面3个方法很相似，除了参数类型不同外，实现的功能是一样的，可以稍作优化。</p>
<p>&nbsp; &nbsp; 下面代码演示使用继承的方式输出几种类型的相关信息：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('65bd2665-a190-4084-a846-12ae5e6e8914')"><img id="code_img_closed_65bd2665-a190-4084-a846-12ae5e6e8914" class="code_img_closed" src="./images/C#泛型学习笔记0.png" alt="" /><img id="code_img_opened_65bd2665-a190-4084-a846-12ae5e6e8914" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('65bd2665-a190-4084-a846-12ae5e6e8914',event)" src="./images/C#泛型学习笔记1.png" alt="" />
<div id="cnblogs_code_open_65bd2665-a190-4084-a846-12ae5e6e8914" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 打印帮助类
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> ShowHelper
        {
            </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
            <span style="color: #808080;">///</span><span style="color: #008000;"> ShowType
            </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
            <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="obj"&gt;&lt;/param&gt;</span>
            <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> ShowType(<span style="color: #0000ff;">object</span><span style="color: #000000;"> obj)
            {
                Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">Class={typeof(ShowHelper).Name},Type={obj.GetType().Name},Parameter={obj}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }
        }

        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> 非泛型打印方式二<span style="color: #000000;">
            ShowHelper.ShowType(</span><span style="color: #800080;">123</span><span style="color: #000000;">);
            ShowHelper.ShowType(</span><span style="color: #800000;">"</span><span style="color: #800000;">Hello World.</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            ShowHelper.ShowType(DateTime.Now);
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p><img src="./images/C#泛型学习笔记5.png" alt="" /></p>
<p>&nbsp; &nbsp; 功能实现没有问题，只是object与其它类型的转换，涉及到装箱和拆箱的过程，这个是会损耗程序的性能的。</p>
<p>&nbsp; &nbsp; <strong>三、泛型类型参数</strong></p>
<p><strong>&nbsp; &nbsp; </strong>在泛型类型或方法的定义中，泛型类型参数可认为是特定类型的占位符。</p>
<p>&nbsp; &nbsp;&nbsp;下面代码演示使用泛型的方式输出几种类型的相关信息：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('e65c6ed2-78ea-49f6-92e4-f6014099b869')"><img id="code_img_closed_e65c6ed2-78ea-49f6-92e4-f6014099b869" class="code_img_closed" src="./images/C#泛型学习笔记0.png" alt="" /><img id="code_img_opened_e65c6ed2-78ea-49f6-92e4-f6014099b869" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('e65c6ed2-78ea-49f6-92e4-f6014099b869',event)" src="./images/C#泛型学习笔记1.png" alt="" />
<div id="cnblogs_code_open_e65c6ed2-78ea-49f6-92e4-f6014099b869" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 打印帮助类
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> ShowHelper
        {
            </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
            <span style="color: #808080;">///</span><span style="color: #008000;"> Show
            </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
            <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="obj"&gt;&lt;/param&gt;</span>
            <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Show&lt;T&gt;<span style="color: #000000;">(T tParam)
            {
                Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">Class={typeof(ShowHelper).Name},Type={tParam.GetType().Name},Parameter={tParam}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }
        }

        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> 泛型打印方式<span style="color: #000000;">
            ShowHelper.Show(</span><span style="color: #800080;">123</span><span style="color: #000000;">);
            ShowHelper.Show(</span><span style="color: #800000;">"</span><span style="color: #800000;">Hello World.</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            ShowHelper.Show(DateTime.Now);
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C#泛型学习笔记8.png" alt="" /></p>
<p>&nbsp; &nbsp; 1、为什么泛型可以解决上面的问题呢？</p>
<p>&nbsp; &nbsp; 泛型是延迟声明的：即定义的时候没有指定具体的参数类型，把参数类型的声明推迟到调用的时候才给它指定。&nbsp;</p>
<p>&nbsp; &nbsp; 2、泛型究竟是如何工作的呢？</p>
<p>&nbsp; &nbsp; 程序执行原理：控制台程序最终会编译成一个exe程序。当exe被点击的时候，会经过JIT(即时编译器)的编译，最终生成二进制代码才能被计算机执行。</p>
<p>&nbsp; &nbsp; 泛型工作原理：泛型加入到语法以后，VS自带的编译器做了升级，升级之后编译时若遇到泛型，会做特殊的处理：生成占位符。然后经过JIT编译的时候，</p>
<p>会把上面编译生成的占位符替换成具体的数据类型。</p>
<p>&nbsp; &nbsp; 下面代码演示泛型占位符：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('f7765fe4-5f7e-4bfc-b128-2823a0addcd7')"><img id="code_img_closed_f7765fe4-5f7e-4bfc-b128-2823a0addcd7" class="code_img_closed" src="./images/C#泛型学习笔记0.png" alt="" /><img id="code_img_opened_f7765fe4-5f7e-4bfc-b128-2823a0addcd7" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('f7765fe4-5f7e-4bfc-b128-2823a0addcd7',event)" src="./images/C#泛型学习笔记1.png" alt="" />
<div id="cnblogs_code_open_f7765fe4-5f7e-4bfc-b128-2823a0addcd7" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> 泛型占位符<span style="color: #000000;">
            Console.WriteLine(</span><span style="color: #0000ff;">typeof</span>(List&lt;&gt;<span style="color: #000000;">));
            Console.WriteLine(</span><span style="color: #0000ff;">typeof</span>(Dictionary&lt;,&gt;<span style="color: #000000;">));
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C#泛型学习笔记11.png" alt="" /></p>
<p>&nbsp; &nbsp; 3、泛型性能问题</p>
<p>&nbsp; &nbsp; 下面代码演示泛型性能测试：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('e3c8e7f7-327e-43eb-8f87-b537abf34769')"><img id="code_img_closed_e3c8e7f7-327e-43eb-8f87-b537abf34769" class="code_img_closed" src="./images/C#泛型学习笔记0.png" alt="" /><img id="code_img_opened_e3c8e7f7-327e-43eb-8f87-b537abf34769" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('e3c8e7f7-327e-43eb-8f87-b537abf34769',event)" src="./images/C#泛型学习笔记1.png" alt="" />
<div id="cnblogs_code_open_e3c8e7f7-327e-43eb-8f87-b537abf34769" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> 泛型性能测试
            <span style="color: #0000ff;">long</span> commonTime = <span style="color: #800080;">0</span><span style="color: #000000;">;
            </span><span style="color: #0000ff;">long</span> objectTime = <span style="color: #800080;">0</span><span style="color: #000000;">;
            </span><span style="color: #0000ff;">long</span> genericTime = <span style="color: #800080;">0</span><span style="color: #000000;">;
            Stopwatch watch </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Stopwatch();
            watch.Start();
            </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">0</span>; i &lt; <span style="color: #800080;">10000</span>; i++<span style="color: #000000;">)
            {
                ShowHelper.ShowInt(</span><span style="color: #800080;">123</span><span style="color: #000000;">);
            }
            watch.Stop();
            commonTime </span>=<span style="color: #000000;"> watch.ElapsedMilliseconds;

            watch.Reset();
            watch.Start();
            </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">0</span>; i &lt; <span style="color: #800080;">10000</span>; i++<span style="color: #000000;">)
            {
                ShowHelper.ShowType(</span><span style="color: #800080;">123</span><span style="color: #000000;">);
            }
            watch.Stop();
            objectTime </span>=<span style="color: #000000;"> watch.ElapsedMilliseconds;

            watch.Reset();
            watch.Start();
            </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">0</span>; i &lt; <span style="color: #800080;">10000</span>; i++<span style="color: #000000;">)
            {
                ShowHelper.Show(</span><span style="color: #800080;">123</span><span style="color: #000000;">);
            }
            watch.Stop();
            genericTime </span>=<span style="color: #000000;"> watch.ElapsedMilliseconds;

            Console.Clear();
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">Common time={commonTime}ms</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">Object time={objectTime}ms</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">Generic time={genericTime}ms</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C#泛型学习笔记14.png" alt="" /></p>
<p>&nbsp; &nbsp; 从结果可以看出，泛型的性能是最高的。</p>
<p>&nbsp; &nbsp; <strong>四、泛型类</strong></p>
<p>&nbsp; &nbsp; 下面代码演示泛型类：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('b38959e6-bc8f-4c2c-9956-782ee62b040b')"><img id="code_img_closed_b38959e6-bc8f-4c2c-9956-782ee62b040b" class="code_img_closed" src="./images/C#泛型学习笔记0.png" alt="" /><img id="code_img_opened_b38959e6-bc8f-4c2c-9956-782ee62b040b" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('b38959e6-bc8f-4c2c-9956-782ee62b040b',event)" src="./images/C#泛型学习笔记1.png" alt="" />
<div id="cnblogs_code_open_b38959e6-bc8f-4c2c-9956-782ee62b040b" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 泛型类
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;typeparam name="T"&gt;&lt;/typeparam&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> GenericClass&lt;T&gt;<span style="color: #000000;">
        {
            </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> T varT;
        }

        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> 泛型类
            <span style="color: #008000;">//</span><span style="color: #008000;">T是int类型</span>
            GenericClass&lt;<span style="color: #0000ff;">int</span>&gt; genericInt = <span style="color: #0000ff;">new</span> GenericClass&lt;<span style="color: #0000ff;">int</span>&gt;<span style="color: #000000;">
            {
                varT </span>= <span style="color: #800080;">123</span><span style="color: #000000;">
            };
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">The value of T={genericInt.varT}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            </span><span style="color: #008000;">//</span><span style="color: #008000;">T是string类型</span>
            GenericClass&lt;<span style="color: #0000ff;">string</span>&gt; genericString = <span style="color: #0000ff;">new</span> GenericClass&lt;<span style="color: #0000ff;">string</span>&gt;<span style="color: #000000;">
            {
                varT </span>= <span style="color: #800000;">"</span><span style="color: #800000;">123</span><span style="color: #800000;">"</span><span style="color: #000000;">
            };
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">The value of T={genericString.varT}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C#泛型学习笔记17.png" alt="" /></p>
<p><strong>&nbsp; &nbsp; 五、泛型接口</strong></p>
<p>&nbsp; &nbsp; 注：泛型在声明的时候可以不指定具体的类型，继承的时候也可以不指定具体类型，但是在使用的时候必须指定具体类型。</p>
<p>&nbsp; &nbsp; 下面代码演示泛型接口：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('545e5092-a298-47a3-abe9-0ce122f37ee5')"><img id="code_img_closed_545e5092-a298-47a3-abe9-0ce122f37ee5" class="code_img_closed" src="./images/C#泛型学习笔记0.png" alt="" /><img id="code_img_opened_545e5092-a298-47a3-abe9-0ce122f37ee5" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('545e5092-a298-47a3-abe9-0ce122f37ee5',event)" src="./images/C#泛型学习笔记1.png" alt="" />
<div id="cnblogs_code_open_545e5092-a298-47a3-abe9-0ce122f37ee5" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 泛型接口
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span> IGenericInterface&lt;T&gt;<span style="color: #000000;">
        {
            T GetT(T t);
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 泛型接口实现类
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="args"&gt;&lt;/param&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> GenericGet&lt;T&gt; : IGenericInterface&lt;T&gt;<span style="color: #000000;">
        {
            T varT;
            </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> T GetT(T t)
            {
                varT </span>=<span style="color: #000000;"> t;
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> varT;
            }
        }

        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> 泛型接口<span style="color: #000000;">
            IGenericInterface</span>&lt;<span style="color: #0000ff;">int</span>&gt; genericInterface = <span style="color: #0000ff;">new</span> GenericGet&lt;<span style="color: #0000ff;">int</span>&gt;<span style="color: #000000;">();
            </span><span style="color: #0000ff;">var</span> result = genericInterface.GetT(<span style="color: #800080;">123</span><span style="color: #000000;">);
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">Result={result}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C#泛型学习笔记20.png" alt="" /></p>
<p>&nbsp; &nbsp; <strong>六、泛型委托</strong></p>
<p><strong>&nbsp; &nbsp; </strong>下面代码演示泛型委托：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('645ce00b-b098-4af1-b1d4-616f216e0ab3')"><img id="code_img_closed_645ce00b-b098-4af1-b1d4-616f216e0ab3" class="code_img_closed" src="./images/C#泛型学习笔记0.png" alt="" /><img id="code_img_opened_645ce00b-b098-4af1-b1d4-616f216e0ab3" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('645ce00b-b098-4af1-b1d4-616f216e0ab3',event)" src="./images/C#泛型学习笔记1.png" alt="" />
<div id="cnblogs_code_open_645ce00b-b098-4af1-b1d4-616f216e0ab3" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 泛型委托
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;typeparam name="T"&gt;&lt;/typeparam&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="t"&gt;&lt;/param&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">delegate</span> <span style="color: #0000ff;">void</span> SayHi&lt;T&gt;<span style="color: #000000;">(T t);

        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> 泛型委托<span style="color: #000000;">
            SayHi</span>&lt;<span style="color: #0000ff;">string</span>&gt; sayHi =<span style="color: #000000;"> SayHello;
            sayHi(</span><span style="color: #800000;">"</span><span style="color: #800000;">Hello World</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> SayHello
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="greeting"&gt;&lt;/param&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> SayHello(<span style="color: #0000ff;">string</span><span style="color: #000000;"> greeting)
        {
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">{greeting}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C#泛型学习笔记23.png" alt="" /></p>
<p>&nbsp; &nbsp; <strong>七、泛型约束</strong></p>
<p>&nbsp; &nbsp; 泛型约束，实际上就是约束的类型T，使T必须遵循一定的规则。比如T必须继承自某个类或者T必须实现某个接口等等。</p>
<p>&nbsp; &nbsp; 怎样给泛型指定约束？其实也很简单，只需要where关键字，加上约束的条件。</p>
<p>&nbsp; &nbsp; 泛型约束总共有五种：</p>
<table border="0">
<tbody>
<tr>
<td>约束</td>
<td>s说明</td>
</tr>
<tr>
<td>T：结构</td>
<td>类型参数必须是值类型</td>
</tr>
<tr>
<td>T：类</td>
<td>类型参数必须是引用类型；这一点也适用于任何类、接口、委托或数组类型。</td>
</tr>
<tr>
<td>T：new()</td>
<td>类型参数必须具有无参数的公共构造函数。 当与其他约束一起使用时，new() 约束必须最后指定。</td>
</tr>
<tr>
<td>T：&lt;基类名&gt;</td>
<td>类型参数必须是指定的基类或派生自指定的基类。</td>
</tr>
<tr>
<td>T：&lt;接口名称&gt;</td>
<td>类型参数必须是指定的接口或实现指定的接口。 可以指定多个接口约束。 约束接口也可以是泛型的。</td>
</tr>
</tbody>
</table>
<p>&nbsp; &nbsp; 7.1基类约束</p>
<p>&nbsp; &nbsp; 下面代码演示基类约束：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('758b407b-0b0c-42fa-a02a-df47949c4225')"><img id="code_img_closed_758b407b-0b0c-42fa-a02a-df47949c4225" class="code_img_closed" src="./images/C#泛型学习笔记0.png" alt="" /><img id="code_img_opened_758b407b-0b0c-42fa-a02a-df47949c4225" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('758b407b-0b0c-42fa-a02a-df47949c4225',event)" src="./images/C#泛型学习笔记1.png" alt="" />
<div id="cnblogs_code_open_758b407b-0b0c-42fa-a02a-df47949c4225" class="cnblogs_code_hide">
<pre><code>        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 运动类接口
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> ISports
        {
            </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> Pingpong();
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 人类基类
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> People
        {
            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> Name { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }

            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">virtual</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> Greeting()
            {
                Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">Hello World.</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 中国人
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Chinese : People, ISports
        {
            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> FineTradition()
            {
                Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">自古以来，中华民族就保持着勤劳的优良传统。</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }
            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">override</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> Greeting()
            {
                Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">吃饭了没？</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }

            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> Pingpong()
            {
                Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">乒乓球是中国的国球。</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }
        }

        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> 泛型约束：基类约束<span style="color: #000000;">
            Chinese chinese </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Chinese()
            {
                Name </span>= <span style="color: #800000;">"</span><span style="color: #800000;">中国人</span><span style="color: #800000;">"</span><span style="color: #000000;">
            };
            ShowPeople(chinese);
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 基类约束
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="obj"&gt;&lt;/param&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> ShowPeople&lt;T&gt;(T tParam) <span style="color: #0000ff;">where</span><span style="color: #000000;"> T:People
        {
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">{((People)tParam).Name}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C#泛型学习笔记26.png" alt="" /></p>
<p>&nbsp; &nbsp; 注：基类约束时，基类不能是密封类，即不能是sealed类。sealed类表示该类不能被继承，在这里用作约束就无任何意义了，因为sealed类没有子类。</p>
<p>&nbsp; &nbsp; 7.2接口约束</p>
<p>&nbsp; &nbsp; 下面代码演示接口约束：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('68a0e871-e1d3-4c62-97d8-29d5be58966a')"><img id="code_img_closed_68a0e871-e1d3-4c62-97d8-29d5be58966a" class="code_img_closed" src="./images/C#泛型学习笔记0.png" alt="" /><img id="code_img_opened_68a0e871-e1d3-4c62-97d8-29d5be58966a" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('68a0e871-e1d3-4c62-97d8-29d5be58966a',event)" src="./images/C#泛型学习笔记1.png" alt="" />
<div id="cnblogs_code_open_68a0e871-e1d3-4c62-97d8-29d5be58966a" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 运动类接口
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> ISports
        {
            </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> Pingpong();
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 人类基类
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> People
        {
            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> Name { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }

            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">virtual</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> Greeting()
            {
                Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">Hello World.</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 中国人
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Chinese : People, ISports
        {
            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> FineTradition()
            {
                Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">自古以来，中华民族就保持着勤劳的优良传统。</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }
            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">override</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> Greeting()
            {
                Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">吃饭了没？</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }

            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> Pingpong()
            {
                Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">乒乓球是中国的国球。</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }
        }

        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> 泛型约束：接口约束<span style="color: #000000;">
            Chinese chinese </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Chinese()
            {
                Name </span>= <span style="color: #800000;">"</span><span style="color: #800000;">中国人</span><span style="color: #800000;">"</span><span style="color: #000000;">
            };
            GetSportsByInterface(chinese);
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 接口约束
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;typeparam name="T"&gt;&lt;/typeparam&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="t"&gt;&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> T GetSportsByInterface&lt;T&gt;(T t) <span style="color: #0000ff;">where</span><span style="color: #000000;"> T : ISports
        {
            t.Pingpong();
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> t;
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C#泛型学习笔记29.png" alt="" /></p>
<p>&nbsp; &nbsp; 7.3引用类型约束 class</p>
<p>&nbsp; &nbsp;&nbsp;引用类型约束保证T一定是引用类型的。</p>
<p>&nbsp; &nbsp; 下面代码演示引用类型约束：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('36df0bd3-87f3-4a21-9e19-776d756e1d91')"><img id="code_img_closed_36df0bd3-87f3-4a21-9e19-776d756e1d91" class="code_img_closed" src="./images/C#泛型学习笔记0.png" alt="" /><img id="code_img_opened_36df0bd3-87f3-4a21-9e19-776d756e1d91" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('36df0bd3-87f3-4a21-9e19-776d756e1d91',event)" src="./images/C#泛型学习笔记1.png" alt="" />
<div id="cnblogs_code_open_36df0bd3-87f3-4a21-9e19-776d756e1d91" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 运动类接口
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> ISports
        {
            </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> Pingpong();
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 人类基类
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> People
        {
            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> Name { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }

            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">virtual</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> Greeting()
            {
                Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">Hello World.</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 中国人
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Chinese : People, ISports
        {
            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> FineTradition()
            {
                Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">自古以来，中华民族就保持着勤劳的优良传统。</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }
            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">override</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> Greeting()
            {
                Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">吃饭了没？</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }

            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> Pingpong()
            {
                Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">乒乓球是中国的国球。</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }
        }

        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> 泛型约束：引用类型约束<span style="color: #000000;">
            Chinese chinese </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Chinese()
            {
                Name </span>= <span style="color: #800000;">"</span><span style="color: #800000;">中国人</span><span style="color: #800000;">"</span><span style="color: #000000;">
            };
            GetSportsByClass(chinese);
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 引用类型约束
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;typeparam name="T"&gt;&lt;/typeparam&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="t"&gt;&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> T GetSportsByClass&lt;T&gt;(T t) <span style="color: #0000ff;">where</span> T : <span style="color: #0000ff;">class</span><span style="color: #000000;">
        {
            </span><span style="color: #0000ff;">if</span> (t <span style="color: #0000ff;">is</span><span style="color: #000000;"> ISports)
            {
                (t </span><span style="color: #0000ff;">as</span><span style="color: #000000;"> ISports).Pingpong();
            }
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> t;
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C#泛型学习笔记32.png" alt="" /></p>
<p>&nbsp; &nbsp; 7.4值类型约束 struct</p>
<p>&nbsp; &nbsp;&nbsp;值类型约束保证T一定是值类型的。</p>
<p>&nbsp; &nbsp;&nbsp;下面代码演示值类型约束：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('1b90a97d-d306-4cfa-94cb-e0066be36462')"><img id="code_img_closed_1b90a97d-d306-4cfa-94cb-e0066be36462" class="code_img_closed" src="./images/C#泛型学习笔记0.png" alt="" /><img id="code_img_opened_1b90a97d-d306-4cfa-94cb-e0066be36462" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('1b90a97d-d306-4cfa-94cb-e0066be36462',event)" src="./images/C#泛型学习笔记1.png" alt="" />
<div id="cnblogs_code_open_1b90a97d-d306-4cfa-94cb-e0066be36462" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 绩效工资
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">struct</span><span style="color: #000000;"> Achievement
        {
            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">double</span> MeritPay { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> Level { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">double</span><span style="color: #000000;"> ReallyPay()
            {
                </span><span style="color: #0000ff;">switch</span><span style="color: #000000;"> (Level)
                {
                    </span><span style="color: #0000ff;">case</span> <span style="color: #800000;">"</span><span style="color: #800000;">A</span><span style="color: #800000;">"</span><span style="color: #000000;">:
                        MeritPay </span>= MeritPay * <span style="color: #800080;">1.0</span><span style="color: #000000;">;
                        </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
                    </span><span style="color: #0000ff;">case</span> <span style="color: #800000;">"</span><span style="color: #800000;">B</span><span style="color: #800000;">"</span><span style="color: #000000;">:
                        MeritPay </span>= MeritPay * <span style="color: #800080;">0.8</span><span style="color: #000000;">;
                        </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
                    </span><span style="color: #0000ff;">case</span> <span style="color: #800000;">"</span><span style="color: #800000;">C</span><span style="color: #800000;">"</span><span style="color: #000000;">:
                        MeritPay </span>= MeritPay * <span style="color: #800080;">0.6</span><span style="color: #000000;">;
                        </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
                    </span><span style="color: #0000ff;">case</span> <span style="color: #800000;">"</span><span style="color: #800000;">D</span><span style="color: #800000;">"</span><span style="color: #000000;">:
                        MeritPay </span>= <span style="color: #800080;">0</span><span style="color: #000000;">;
                        </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
                    </span><span style="color: #0000ff;">default</span><span style="color: #000000;">:
                        MeritPay </span>= <span style="color: #800080;">0</span><span style="color: #000000;">;
                        </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
                };
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> MeritPay;
            }
        }

        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> 泛型约束：值类型约束<span style="color: #000000;">
            Achievement achievement </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Achievement
            {
                MeritPay </span>= <span style="color: #800080;">500</span><span style="color: #000000;">,
                Level </span>= <span style="color: #800000;">"</span><span style="color: #800000;">B</span><span style="color: #800000;">"</span><span style="color: #000000;">
            };
            </span><span style="color: #0000ff;">var</span> result =<span style="color: #000000;"> GetReallyPay(achievement).ReallyPay();
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">ReallyPay={result}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 值类型约束
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;typeparam name="T"&gt;&lt;/typeparam&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="t"&gt;&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> T GetReallyPay&lt;T&gt;(T t) <span style="color: #0000ff;">where</span> T : <span style="color: #0000ff;">struct</span><span style="color: #000000;">
        {
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> t;
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C#泛型学习笔记35.png" alt="" /></p>
<p>&nbsp; &nbsp; 7.5无参数构造函数约束 new()&nbsp;</p>
<p>&nbsp; &nbsp;&nbsp;下面代码演示无参数构造函数约束：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('520b0efb-ac48-4131-b3fd-bdba480b6710')"><img id="code_img_closed_520b0efb-ac48-4131-b3fd-bdba480b6710" class="code_img_closed" src="./images/C#泛型学习笔记0.png" alt="" /><img id="code_img_opened_520b0efb-ac48-4131-b3fd-bdba480b6710" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('520b0efb-ac48-4131-b3fd-bdba480b6710',event)" src="./images/C#泛型学习笔记1.png" alt="" />
<div id="cnblogs_code_open_520b0efb-ac48-4131-b3fd-bdba480b6710" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 运动类接口
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> ISports
        {
            </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> Pingpong();
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 人类基类
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> People
        {
            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> Name { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }

            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">virtual</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> Greeting()
            {
                Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">Hello World.</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 中国人
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Chinese : People, ISports
        {
            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> FineTradition()
            {
                Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">自古以来，中华民族就保持着勤劳的优良传统。</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }
            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">override</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> Greeting()
            {
                Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">吃饭了没？</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }

            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> Pingpong()
            {
                Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">乒乓球是中国的国球。</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 广东人
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Guangdong : Chinese
        {
            </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> Guangdong() { }
            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> Dialect { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> Mahjong()
            {
                Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">这麻将上瘾的时候，一个人也说是三缺一呀。</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }
        }

        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> 泛型约束：无参数构造函数约束<span style="color: #000000;">
            Guangdong guangdong </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Guangdong()
            {
                Name </span>= <span style="color: #800000;">"</span><span style="color: #800000;">广东人</span><span style="color: #800000;">"</span><span style="color: #000000;">
            };
            GetMahjong(guangdong);
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 无参数构造函数约束
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;typeparam name="T"&gt;&lt;/typeparam&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="t"&gt;&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> T GetMahjong&lt;T&gt;(T t) <span style="color: #0000ff;">where</span> T : People, ISports, <span style="color: #0000ff;">new</span><span style="color: #000000;">()
        {
            </span><span style="color: #0000ff;">if</span> (t <span style="color: #0000ff;">is</span><span style="color: #000000;"> Guangdong)
            {
                (t </span><span style="color: #0000ff;">as</span><span style="color: #000000;"> Guangdong).Mahjong();
            }
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> t;
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C#泛型学习笔记38.png" alt="" /></p>
<p>&nbsp; &nbsp; 从上面可以看出，泛型约束可以有多个，但是有多个泛型约束时，new()约束要放到最后。</p>
<p>&nbsp; &nbsp; <strong>八：泛型的协变和逆变</strong></p>
<p>&nbsp; &nbsp; 协变和逆变是在.NET 4.0的时候出现的，只能放在接口或者委托的泛型参数前面，out协变covariant，用来修饰返回值；in：逆变contravariant，用来修饰</p>
<p>传入参数。</p>
<p>&nbsp; &nbsp; 下面代码演示父类与子类的声明方式：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('71dd4aff-9a81-4bb6-9929-ab22a63e35f6')"><img id="code_img_closed_71dd4aff-9a81-4bb6-9929-ab22a63e35f6" class="code_img_closed" src="./images/C#泛型学习笔记0.png" alt="" /><img id="code_img_opened_71dd4aff-9a81-4bb6-9929-ab22a63e35f6" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('71dd4aff-9a81-4bb6-9929-ab22a63e35f6',event)" src="./images/C#泛型学习笔记1.png" alt="" />
<div id="cnblogs_code_open_71dd4aff-9a81-4bb6-9929-ab22a63e35f6" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 动物基类
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Animal
        {
            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> Breed { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 猫类
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Cat : Animal
        {
            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> Name { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
        }

        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> 泛型的协变和逆变
            <span style="color: #008000;">//</span><span style="color: #008000;">直接声明Animal类</span>
            Animal animal = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Animal();
            </span><span style="color: #008000;">//</span><span style="color: #008000;">直接声明Cat类</span>
            Cat cat = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Cat();
            </span><span style="color: #008000;">//</span><span style="color: #008000;">声明子类对象指向父类</span>
            Animal animal2 = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Cat();
            </span><span style="color: #008000;">//</span><span style="color: #008000;">声明Animal类的集合</span>
            List&lt;Animal&gt; listAnimal = <span style="color: #0000ff;">new</span> List&lt;Animal&gt;<span style="color: #000000;">();
            </span><span style="color: #008000;">//</span><span style="color: #008000;">声明Cat类的集合</span>
            List&lt;Cat&gt; listCat = <span style="color: #0000ff;">new</span> List&lt;Cat&gt;<span style="color: #000000;">();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 以上代码是可以正常运行的。假如使用下面的声明方式，是否正确呢？</p>
<div class="cnblogs_code">
<pre><code>List&lt;Animal&gt; list = <span style="color: #0000ff;">new</span> List&lt;Cat&gt;();</pre>
</div>
<p>&nbsp; &nbsp; 答案是错误的，因为List&lt;Animal&gt;和List&lt;Cat&gt;之间没有父子关系。</p>
<p>&nbsp; &nbsp; 解决方法是使用<strong>协变</strong>的方式：</p>
<div class="cnblogs_code">
<pre><code>IEnumerable&lt;Animal&gt; List1 = <span style="color: #0000ff;">new</span> List&lt;Animal&gt;<span style="color: #000000;">();
IEnumerable</span>&lt;Animal&gt; List2 = <span style="color: #0000ff;">new</span> List&lt;Cat&gt;();</pre>
</div>
<p>&nbsp; &nbsp; 按F12查看IEnumerable定义：</p>
<p><img src="./images/C#泛型学习笔记41.png" alt="" /></p>
<p>&nbsp; &nbsp; 可以看到，<strong>在泛型接口的T前面有一个out关键字修饰，而且T只能是返回值类型，不能作为参数类型，这就是协变。</strong>使用协变以后，左边声明的是基类，</p>
<p>右边的声明可以是基类或者基类的子类。</p>
<p>&nbsp; &nbsp;&nbsp;协变除了可以用在接口上面外，还可以用在委托上面：</p>
<div class="cnblogs_code">
<pre><code>Func&lt;Animal&gt; func = <span style="color: #0000ff;">new</span> Func&lt;Cat&gt;(() =&gt; <span style="color: #0000ff;">null</span>);</pre>
</div>
<p>&nbsp; &nbsp;&nbsp;除了使用.NET框架定义好协变以外，我们也可以自定义协变：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">使用自定义协变</span>
ICustomerListOut&lt;Animal&gt; customerList1 = <span style="color: #0000ff;">new</span> CustomerListOut&lt;Animal&gt;<span style="color: #000000;">();
ICustomerListOut</span>&lt;Animal&gt; customerList2 = <span style="color: #0000ff;">new</span> CustomerListOut&lt;Cat&gt;();</pre>
</div>
<p>&nbsp; &nbsp; 再来看看<strong>逆变</strong>：</p>
<p>&nbsp; &nbsp;&nbsp;<strong>在泛型接口的T前面有一个In关键字修饰，而且T只能方法参数，不能作为返回值类型，这就是逆变。</strong></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('e68cd3ef-38c7-492f-90cc-0d1ac42981fb')"><img id="code_img_closed_e68cd3ef-38c7-492f-90cc-0d1ac42981fb" class="code_img_closed" src="./images/C#泛型学习笔记0.png" alt="" /><img id="code_img_opened_e68cd3ef-38c7-492f-90cc-0d1ac42981fb" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('e68cd3ef-38c7-492f-90cc-0d1ac42981fb',event)" src="./images/C#泛型学习笔记1.png" alt="" />
<div id="cnblogs_code_open_e68cd3ef-38c7-492f-90cc-0d1ac42981fb" class="cnblogs_code_hide">
<pre><code><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
<span style="color: #808080;">///</span><span style="color: #008000;"> 逆变 只能是方法参数
</span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
<span style="color: #808080;">///</span> <span style="color: #808080;">&lt;typeparam name="T"&gt;&lt;/typeparam&gt;</span>
<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span> ICustomerListIn&lt;<span style="color: #0000ff;">in</span> T&gt;<span style="color: #000000;">
{
     </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> Show(T t);
}

</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> CustomerListIn&lt;T&gt; : ICustomerListIn&lt;T&gt;<span style="color: #000000;">
{
     </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> Show(T t)
     {
     }
}</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp;&nbsp;使用自定义逆变：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">使用自定义逆变</span>
ICustomerListIn&lt;Cat&gt; customerListCat1 = <span style="color: #0000ff;">new</span> CustomerListIn&lt;Cat&gt;<span style="color: #000000;">();
ICustomerListIn</span>&lt;Cat&gt; customerListCat2 = <span style="color: #0000ff;">new</span> CustomerListIn&lt;Animal&gt;();</pre>
</div>
<p>&nbsp; &nbsp;&nbsp;协变和逆变也可以同时使用。</p>
<p>&nbsp; &nbsp; 下面代码演示自定义协变与逆变：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('7594d4a2-16bb-422b-b116-2c8a70554678')"><img id="code_img_closed_7594d4a2-16bb-422b-b116-2c8a70554678" class="code_img_closed" src="./images/C#泛型学习笔记0.png" alt="" /><img id="code_img_opened_7594d4a2-16bb-422b-b116-2c8a70554678" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('7594d4a2-16bb-422b-b116-2c8a70554678',event)" src="./images/C#泛型学习笔记1.png" alt="" />
<div id="cnblogs_code_open_7594d4a2-16bb-422b-b116-2c8a70554678" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 动物基类
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Animal
        {
            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> Breed { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 猫类
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Cat : Animal
        {
            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> Name { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
        }

        </span><span style="color: #0000ff;">#region</span> 泛型的自定义协变和逆变
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> inT-逆变 outT-协变
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;typeparam name="inT"&gt;&lt;/typeparam&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;typeparam name="outT"&gt;&lt;/typeparam&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span> IMyList&lt;<span style="color: #0000ff;">in</span> inT, <span style="color: #0000ff;">out</span> outT&gt;<span style="color: #000000;">
        {
            </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> Show(inT t);
            outT Get();
            outT Do(inT t);
        }

        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> MyList&lt;T1, T2&gt; : IMyList&lt;T1, T2&gt;<span style="color: #000000;">
        {

            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> Show(T1 t)
            {
                Console.WriteLine(t.GetType().Name);
            }

            </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> T2 Get()
            {
                Console.WriteLine(</span><span style="color: #0000ff;">typeof</span><span style="color: #000000;">(T2).Name);
                </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">default</span><span style="color: #000000;">(T2);
            }

            </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> T2 Do(T1 t)
            {
                Console.WriteLine(t.GetType().Name);
                Console.WriteLine(</span><span style="color: #0000ff;">typeof</span><span style="color: #000000;">(T2).Name);
                </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">default</span><span style="color: #000000;">(T2);
            }
        }
        </span><span style="color: #0000ff;">#endregion</span>

        <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> 泛型的自定义协变与逆变<span style="color: #000000;">
            IMyList</span>&lt;Cat, Animal&gt; myList1 = <span style="color: #0000ff;">new</span> MyList&lt;Cat, Animal&gt;<span style="color: #000000;">();
            IMyList</span>&lt;Cat, Animal&gt; myList2 = <span style="color: #0000ff;">new</span> MyList&lt;Cat, Cat&gt;();          <span style="color: #008000;">//</span><span style="color: #008000;">协变</span>
            IMyList&lt;Cat, Animal&gt; myList3 = <span style="color: #0000ff;">new</span> MyList&lt;Animal, Animal&gt;();    <span style="color: #008000;">//</span><span style="color: #008000;">逆变</span>
            IMyList&lt;Cat, Animal&gt; myList4 = <span style="color: #0000ff;">new</span> MyList&lt;Animal, Cat&gt;();       <span style="color: #008000;">//</span><span style="color: #008000;">逆变+协变</span>
<span style="color: #000000;">            myList1.Get();
            myList2.Get();
            myList3.Get();
            myList4.Get();
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C#泛型学习笔记46.png" alt="" /></p>
<p>&nbsp; &nbsp; <strong>九、泛型缓存</strong></p>
<p><strong>&nbsp; &nbsp; </strong>类中的静态类型无论实例化多少次，在内存中只会有一个，静态构造函数只会执行一次。在泛型类中，T类型不同，每个不同的T类型，都会产生一个不同</p>
<p>的副本，所以会产生不同的静态属性、不同的静态构造函数。</p>
<p>&nbsp; &nbsp; 下面代码演示泛型缓存：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('40ccab71-3c79-4320-98c7-a9d133e04876')"><img id="code_img_closed_40ccab71-3c79-4320-98c7-a9d133e04876" class="code_img_closed" src="./images/C#泛型学习笔记0.png" alt="" /><img id="code_img_opened_40ccab71-3c79-4320-98c7-a9d133e04876" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('40ccab71-3c79-4320-98c7-a9d133e04876',event)" src="./images/C#泛型学习笔记1.png" alt="" />
<div id="cnblogs_code_open_40ccab71-3c79-4320-98c7-a9d133e04876" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 泛型缓存
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;typeparam name="T"&gt;&lt;/typeparam&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> GenericCache&lt;T&gt;<span style="color: #000000;">
        {
            </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">readonly</span> <span style="color: #0000ff;">string</span> TypeTime = <span style="color: #800000;">""</span><span style="color: #000000;">;
            </span><span style="color: #0000ff;">static</span><span style="color: #000000;"> GenericCache()
            {
                Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">这个是泛型缓存的静态构造函数：</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                TypeTime </span>= <span style="color: #0000ff;">string</span>.Format(<span style="color: #800000;">"</span><span style="color: #800000;">{0}_{1}</span><span style="color: #800000;">"</span>, <span style="color: #0000ff;">typeof</span>(T).FullName, DateTime.Now.ToString(<span style="color: #800000;">"</span><span style="color: #800000;">yyyyMMddHHmmss.fff</span><span style="color: #800000;">"</span><span style="color: #000000;">));
            }
            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> GetCache()
            {
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> TypeTime;
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 泛型缓存测试类
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> GenericCacheTest
        {
            </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> Show()
            {
                </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">0</span>; i &lt; <span style="color: #800080;">5</span>; i++<span style="color: #000000;">)
                {
                    Console.WriteLine(GenericCache</span>&lt;<span style="color: #0000ff;">int</span>&gt;<span style="color: #000000;">.GetCache());
                    Thread.Sleep(</span><span style="color: #800080;">10</span><span style="color: #000000;">);
                    Console.WriteLine(GenericCache</span>&lt;<span style="color: #0000ff;">long</span>&gt;<span style="color: #000000;">.GetCache());
                    Thread.Sleep(</span><span style="color: #800080;">10</span><span style="color: #000000;">);
                    Console.WriteLine(GenericCache</span>&lt;DateTime&gt;<span style="color: #000000;">.GetCache());
                    Thread.Sleep(</span><span style="color: #800080;">10</span><span style="color: #000000;">);
                    Console.WriteLine(GenericCache</span>&lt;<span style="color: #0000ff;">string</span>&gt;<span style="color: #000000;">.GetCache());
                    Thread.Sleep(</span><span style="color: #800080;">10</span><span style="color: #000000;">);
                    Console.WriteLine(GenericCache</span>&lt;GenericCacheTest&gt;<span style="color: #000000;">.GetCache());
                    Thread.Sleep(</span><span style="color: #800080;">10</span><span style="color: #000000;">);
                }
            }
        }

        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> 泛型缓存<span style="color: #000000;">
            GenericCacheTest.Show();
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C#泛型学习笔记49.png" alt="" /></p>
<p>&nbsp; &nbsp;&nbsp;从上面的截图中可以看出，泛型会为不同的类型都创建一个副本，因此静态构造函数会执行5次，另外每次静态属性的值都是一样的。利用泛型的这一特性，可以实现缓存。</p>
<p>&nbsp; &nbsp; 注：只能为不同的类型缓存一次；泛型缓存比字典缓存效率高；泛型缓存不能主动释放。</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>