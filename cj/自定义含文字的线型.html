<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修自定义含文字的线型' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>自定义含文字的线型</center></div><div class='banquan'>原文出处:本文由博客园博主小石头|Stone提供。<br/>
原文连接:https://www.cnblogs.com/smallstoneman/p/11212506.html</div><br>
    <p><span style="font-size: 16px;">先看一下系统自带的线型文件acadiso.lin：</span></p>
<div class="cnblogs_code">
<pre><code>*HOT_WATER_SUPPLY,Hot water supply ---- HW ---- HW ---- HW ----<span style="color: #000000;">
A,</span><span style="color: #800080;">12.7</span>,-<span style="color: #800080;">5.08</span>,[<span style="color: #800000;">"</span><span style="color: #800000;">HW</span><span style="color: #800000;">"</span>,STANDARD,S=<span style="color: #800080;">2.54</span>,U=<span style="color: #800080;">0.0</span>,X=-<span style="color: #800080;">2.54</span>,Y=-<span style="color: #800080;">1.27</span>],-<span style="color: #800080;">5.08</span></pre>
</div>
<table style="height: 463px; width: 728px;" border="1" align="left">
<tbody>
<tr>
<td>*</td>
<td>线型文件中，每种线型必须以（*）开头</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>HOT_WATER_SUPPLY</td>
<td>线型名称</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>Hot water supply ---- HW ---- HW ---- HW ----</td>
<td>线型描述</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>A</td>
<td>对齐方式，必须的，也是唯一的</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>12.7</td>
<td>起始为12.7个单位长的实线</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>-5.08</td>
<td>接上为长5.08的空白</td>
<td>可以看出：正数为实线，虚线为空白</td>
</tr>
<tr>
<td>[]</td>
<td>内为图案定义</td>
<td>这里是文字图案</td>
</tr>
<tr>
<td>&ldquo;HW&rdquo;</td>
<td>文字内容</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>STANDARD</td>
<td>文字样式，需要注意的是，如果文档中未发现文字样式，会发生错误（eKeyNotFound），建议设置成STANDARD</td>
<td>
<p>因为STANDARD是每个CAD文档必须要有的文字样式，同样的，如果想更改系统自定义的带文字的线型样式，需要更改STANDARD</p>
</td>
</tr>
<tr>
<td>S=2.54</td>
<td>要用于文字样式的缩放比例与线型的比例相关。文字样式的高度需乘以缩放比例。如果高度为 0，则 S=值的值本身用作高度</td>
<td>&nbsp;</td>
</tr>
<tr>
<td>U=0.0</td>
<td>U = 值、<span class="code">R = 值或&nbsp;<span class="code">A = 值。<span class="code">U=&nbsp;指定正立或易于阅读的文字。<span class="code">R=&nbsp;指定相对于直线的相对或相切旋转。<span class="code">A=&nbsp;指定文字相对于原点的绝对旋转；即所有文字不论其相对于直线的位置如何，都将进行相同的旋转</span></span></span></span></span></td>
<td>旋转是围绕基线和实际大写高度之间的中点进行的</td>
</tr>
<tr>
<td>X=-2.54</td>
<td>文字在线型的&nbsp;<em class="mild">X</em>&nbsp;轴方向上沿直线的移动。使用该字段控制文字与前面提笔或落笔笔划间的距离</td>
<td>该值不能按照&nbsp;<span class="code">S=值定义的缩放比例进行缩放，但是它可以根据线型进行缩放</span></td>
</tr>
<tr>
<td>Y=-1.27</td>
<td>文字在线型的&nbsp;<em class="mild">Y</em>&nbsp;轴方向垂直于该直线的移动。使用此字段控制文字相对于直线的垂直对齐。</td>
<td>该值不能按照&nbsp;<span class="code">S=值定义的缩放比例进行缩放，但是它可以根据线型进行缩放。</span></td>
</tr>
<tr>
<td>-5.08</td>
<td>以长5.08的空白结束</td>
<td>
<p>&nbsp;</p>
</td>
</tr>
</tbody>
</table>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><code>        [CommandMethod(<span style="color: #800000;">"</span><span style="color: #800000;">CTL</span><span style="color: #800000;">"</span><span style="color: #000000;">)]
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> CreateTextLinetype()
        {
            Document doc </span>=<span style="color: #000000;"> Application.DocumentManager.MdiActiveDocument;
            Database db </span>=<span style="color: #000000;"> doc.Database;
            Editor ed </span>=<span style="color: #000000;"> doc.Editor;
            Transaction tr </span>=<span style="color: #000000;"> db.TransactionManager.StartTransaction();
            </span><span style="color: #0000ff;">using</span><span style="color: #000000;"> (tr)
            {
                TextStyleTable tt </span>=<span style="color: #000000;"> (TextStyleTable)tr.GetObject(db.TextStyleTableId, OpenMode.ForRead);
                LinetypeTable lt </span>=<span style="color: #000000;"> (LinetypeTable)tr.GetObject(db.LinetypeTableId, OpenMode.ForWrite);
                LinetypeTableRecord ltr </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> LinetypeTableRecord();

                ltr.Name </span>= <span style="color: #800000;">"</span><span style="color: #800000;">管线</span><span style="color: #800000;">"</span><span style="color: #000000;">;
                ltr.AsciiDescription </span>= <span style="color: #800000;">"</span><span style="color: #800000;">管线线型 ---- 管线 ---- 管线 ---- 管线 ----</span><span style="color: #800000;">"</span><span style="color: #000000;">;
                ltr.PatternLength </span>= <span style="color: #800080;">1.3</span>;<span style="color: #008000;">//</span><span style="color: #008000;">所有实线+空白的长度总和</span>
                ltr.NumDashes = <span style="color: #800080;">3</span>;<span style="color: #008000;">//</span><span style="color: #008000;">所有实线+空白的段落总和
                </span><span style="color: #008000;">//</span><span style="color: #008000;">第一段</span>
                ltr.SetDashLengthAt(<span style="color: #800080;">0</span>, <span style="color: #800080;">0.5</span><span style="color: #000000;">);
                </span><span style="color: #008000;">//</span><span style="color: #008000;">第二段</span>
                ltr.SetDashLengthAt(<span style="color: #800080;">1</span>, -<span style="color: #800080;">0.4</span><span style="color: #000000;">);
                ltr.SetShapeStyleAt(</span><span style="color: #800080;">1</span>, tt[<span style="color: #800000;">"</span><span style="color: #800000;">STANDARD</span><span style="color: #800000;">"</span><span style="color: #000000;">]);
                ltr.SetShapeNumberAt(</span><span style="color: #800080;">1</span>, <span style="color: #800080;">0</span>);<span style="color: #008000;">//</span><span style="color: #008000;">图案在图形文件中的编号，由于这里是文字，可以省略该设置</span>
                ltr.SetShapeScaleAt(<span style="color: #800080;">1</span>, <span style="color: #800080;">0.1</span><span style="color: #000000;">);
                ltr.SetTextAt(</span><span style="color: #800080;">1</span>, <span style="color: #800000;">"</span><span style="color: #800000;">管线</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                ltr.SetShapeRotationAt(</span><span style="color: #800080;">1</span>, <span style="color: #800080;">0</span><span style="color: #000000;">);
                ltr.SetShapeOffsetAt(</span><span style="color: #800080;">1</span>, <span style="color: #0000ff;">new</span> Vector2d(<span style="color: #800080;">0</span>, -<span style="color: #800080;">0.05</span>));<span style="color: #008000;">//</span><span style="color: #008000;">X轴不对，Y轴向下移动0.05个单位
                </span><span style="color: #008000;">//</span><span style="color: #008000;">第三段</span>
                ltr.SetDashLengthAt(<span style="color: #800080;">2</span>, -<span style="color: #800080;">0.4</span><span style="color: #000000;">);

                </span><span style="color: #008000;">//</span><span style="color: #008000;"> 添加新线型到线型表</span>
                ObjectId ltId =<span style="color: #000000;"> lt.Add(ltr);
                tr.AddNewlyCreatedDBObject(ltr, </span><span style="color: #0000ff;">true</span><span style="color: #000000;">);
                tr.Commit();
            }
        }</span></pre>
</div>
<p><img src="./images/自定义含文字的线型0.png" alt="" /></p>
<p><span style="font-size: 16px;">需要注意的是，文字（管线）两侧的空白并不对称，这是因为文字（管线）或图形的长度实际是占用了下一个段落的长度，</span></p>
<p><span style="font-size: 16px;">这里就是占用了第三段空白0.4的长度一部分，所以该段空白长度实际小于0.4。</span></p>
<p><span style="font-size: 16px;">我们向来提倡对称美，那么应该怎么处理使文字两侧的空白看起来是对称的呢，思路是用包围圈计算出文字（管线）的单位长度，</span></p>
<p><span style="font-size: 16px;">然后第三段在0.4的基础上加上文字（管线）的长度即可。</span></p>
<p><span style="font-size: 16px;">改善后效果如下：</span></p>
<p><img src="./images/自定义含文字的线型1.png" alt="" /></p>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>