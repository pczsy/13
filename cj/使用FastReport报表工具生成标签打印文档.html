<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修使用FastReport报表工具生成标签打印文档' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>使用FastReport报表工具生成标签打印文档</center></div><div class='banquan'>原文出处:本文由博客园博主伍华聪提供。<br/>
原文连接:https://www.cnblogs.com/wuhuacong/p/11763741.html</div><br>
    <p>在我们实际开发报表的时候，我们需要按一定的业务规则组织好报表的模板设计，让报表尽可能的贴近实际的需求，在之前的随笔中《<a class="postTitle2" href="https://www.cnblogs.com/wuhuacong/p/11690849.html">使用FastReport报表工具生成报表PDF文档</a>》介绍了FastReport生成常规报表的处理，本篇随笔回顾常规报表的处理效果，并介绍基于FastReport生成标签纸打印需要的报表格式。</p>
<h3>1、常规报表的处理</h3>
<p>我们一般处理报表的时候，大多数情况碰到的是明细报表，或者有主从表这种样式的报表格式，明细报表就是只需要设计一个表头，按列表展示即可，如下所示格式。</p>
<p><img src="./images/使用FastReport报表工具生成标签打印文档0.png" alt="" width="604" height="362" /></p>
<p>&nbsp;</p>
<p>或者类似一个基于XtraReport报表的功能界面，如下面图示所示。</p>
<p>&nbsp;<img src="./images/使用FastReport报表工具生成标签打印文档1.png" alt="" /></p>
<p>这里面涉及的字段，包括字符型、日期型，数值型、枚举类型等，还有统计值、打印时间（参数），因此也算一个比较完整的报表展示了。</p>
<p>或者一些有一条记录构建成的报表信息，如下报表所示，这些也只是设计模板上的差异，在模板里面绑定对应的字段或者参数即可实现。</p>
<p><img src="./images/使用FastReport报表工具生成标签打印文档2.png" alt="" width="501" height="422" /></p>
<p>&nbsp;还有一种是主表有信息，从表有明细的数据展示方式，这个在随笔《<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/wuhuacong/p/11690849.html">使用FastReport报表工具生成报表PDF文档</a>》有介绍过。</p>
<p><img src="./images/使用FastReport报表工具生成标签打印文档3.png" alt="" width="337" height="545" /></p>
<p>&nbsp;</p>
<h3>2、基于标签信息报表的打印处理</h3>
<p>之前在随笔《<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/wuhuacong/p/10523734.html">在Winform开发中使用Grid++报表</a>》和《<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/wuhuacong/p/10529587.html">在Bootstrap开发框架中使用Grid++报表</a>》中介绍了使用锐浪报表来设计展现标签打印报表的处理，如下效果所示。</p>
<p><img src="./images/使用FastReport报表工具生成标签打印文档4.png" alt="" width="650" height="445" /></p>
<p><img src="./images/使用FastReport报表工具生成标签打印文档5.png" alt="" /></p>
<p>本篇随笔介绍基于FastReport报表工具生成标签打印文档的操作。</p>
<p>其实如果细心查找，FastReport也提供了很多Demo案例，其中就有标签的案例介绍，设计效果如下所示。</p>
<p><img src="./images/使用FastReport报表工具生成标签打印文档6.png" alt="" width="649" height="309" /></p>
<p>&nbsp;</p>
<p>&nbsp;报表预览效果如下所示。</p>
<p><img src="./images/使用FastReport报表工具生成标签打印文档7.png" alt="" /></p>
<p>&nbsp;</p>
<p>我们要做的类似，不过我们需要增加二维码、条码上去进行打印而已。</p>
<p>首先我们需要设计一个报表模板，设计格式如下所示。</p>
<p><img src="./images/使用FastReport报表工具生成标签打印文档8.png" alt="" width="798" height="460" /></p>
<p>&nbsp;</p>
<p>&nbsp;在其中我们需要加入一个数据源进行绑定和测试预览效果，我们选择SQLServer一个表的数据进行创建数据源，如下所示。</p>
<p><img src="./images/使用FastReport报表工具生成标签打印文档9.png" alt="" width="301" height="260" /></p>
<p>&nbsp;</p>
<p>设计报表，我们需要根据实际标签纸张预先设计好报表页面大小，如下所示。</p>
<p><img src="./images/使用FastReport报表工具生成标签打印文档10.png" alt="" width="321" height="251" /></p>
<p>&nbsp;</p>
<p>如果需要展示多少列，可以通过页面设置中的列进行指定划分多少列，如下所示。</p>
<p><img src="./images/使用FastReport报表工具生成标签打印文档11.png" alt="" width="320" height="250" /></p>
<p>&nbsp;</p>
<p>不过在实际测试的时候，这样的属性设置，报表渲染的时候，是按指定高度，从左列到右列进行依次展现的，如果我们需要按实际渲染高度，那么这里可以设置为1，然后由数据区进行设置列的数量即可。如下所示。</p>
<p><img src="./images/使用FastReport报表工具生成标签打印文档12.png" alt="" width="324" height="253" /></p>
<p>&nbsp;</p>
<p>数据区设置列数为实际需要展现的列数，这个根据宽度预览看大概设计多少列合适，让页面高宽尽可能利用好即可。</p>
<p>二维码标签报表格式设计效果大概如下所示。</p>
<p><img src="./images/使用FastReport报表工具生成标签打印文档13.png" alt="" /></p>
<p>&nbsp;</p>
<p>我们使用数据源的数据预览下效果，效果还是杠杠的。</p>
<p><img src="./images/使用FastReport报表工具生成标签打印文档14.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;报表模板弄好了，我们就需要如何生成FastReport报表或者导出PDF了。</p>
<p>我在之前的随笔《<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/wuhuacong/p/11690849.html">使用FastReport报表工具生成报表PDF文档</a>》里面介绍了FastReport报表的处理代码，这里做法依旧差不多，绑定数据源即可展示或者导出PDF了。</p>
<p>最主要的代码如下所示。</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">生成PDF报表文档到具体文件</span>
Report report = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Report();
report.Load(reportPath);

</span><span style="color: #008000;">//</span><span style="color: #008000;">定义参数和数据格式</span>
<span style="color: #0000ff;">var</span> dict = <span style="color: #0000ff;">new</span> Dictionary&lt;<span style="color: #0000ff;">string</span>, <span style="color: #0000ff;">object</span>&gt;<span style="color: #000000;">();
</span><span style="color: #0000ff;">var</span> dt = DataTableHelper.CreateTable(<span style="color: #800000;">"</span><span style="color: #800000;">ID,Name,CurrDept,Code,UsePerson,KeepAddr</span><span style="color: #800000;">"</span><span style="color: #000000;">);
</span><span style="color: #0000ff;">if</span> (list != <span style="color: #0000ff;">null</span><span style="color: #000000;">)
{
    </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> info <span style="color: #0000ff;">in</span><span style="color: #000000;"> list)
    {
        </span><span style="color: #0000ff;">var</span> dr =<span style="color: #000000;"> dt.NewRow();
        dr[</span><span style="color: #800000;">"</span><span style="color: #800000;">ID</span><span style="color: #800000;">"</span>] =<span style="color: #000000;"> info.ID;
        dr[</span><span style="color: #800000;">"</span><span style="color: #800000;">Name</span><span style="color: #800000;">"</span>] =<span style="color: #000000;"> info.Name;
        dr[</span><span style="color: #800000;">"</span><span style="color: #800000;">CurrDept</span><span style="color: #800000;">"</span>] =<span style="color: #000000;"> info.CurrDept;
        dr[</span><span style="color: #800000;">"</span><span style="color: #800000;">Code</span><span style="color: #800000;">"</span>] =<span style="color: #000000;"> info.Code;
        dr[</span><span style="color: #800000;">"</span><span style="color: #800000;">UsePerson</span><span style="color: #800000;">"</span>] =<span style="color: #000000;"> info.UsePerson;
        dr[</span><span style="color: #800000;">"</span><span style="color: #800000;">KeepAddr</span><span style="color: #800000;">"</span>] =<span style="color: #000000;"> info.KeepAddr;
        dt.Rows.Add(dr);
    }
}

</span><span style="color: #008000;">//</span><span style="color: #008000;">刷新数据源</span>
<span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">string</span> key <span style="color: #0000ff;">in</span><span style="color: #000000;"> dict.Keys)
{
    report.SetParameterValue(key, dict[key]);
}
report.RegisterData(dt, </span><span style="color: #800000;">"</span><span style="color: #800000;">T_Asset</span><span style="color: #800000;">"</span><span style="color: #000000;">);

</span><span style="color: #008000;">//</span><span style="color: #008000;">运行报表</span>
report.Prepare();</pre>
</div>
<p>如果需要导出PDF，那么代码增加部分导出处理即可。</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">导出PDF报表</span>
PDFExport export = <span style="color: #0000ff;">new</span><span style="color: #000000;"> PDFExport();
report.Export(export, realPath);
report.Dispose();</span></pre>
</div>
<p>我们来看看实际在浏览器预览的效果，如下所示。</p>
<p><img src="./images/使用FastReport报表工具生成标签打印文档15.png" alt="" width="797" height="575" /></p>
<p>以上效果结合了pdfJS的在线预览PDF操作，如果需要了解PDF的在线处理，参考下随笔《<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/wuhuacong/p/9566764.html">实现在线预览PDF的几种解决方案</a>》。</p>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>