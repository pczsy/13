<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修C# LINQ学习笔记五：LINQ to XML' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>C# LINQ学习笔记五：LINQ to XML</center></div><div class='banquan'>原文出处:本文由博客园博主缥缈的尘埃提供。<br/>
原文连接:https://www.cnblogs.com/atomy/p/12109713.html</div><br>
    <p>&nbsp; &nbsp;&nbsp;本笔记摘抄自：<a href="https://www.cnblogs.com/yaozhenfa/p/CSharp_Linq_For_Xml.html">https://www.cnblogs.com/yaozhenfa/p/CSharp_Linq_For_Xml.html</a>，记录一下学习过程以备后续查用。</p>
<p>&nbsp; &nbsp; <strong>一、生成xml</strong></p>
<p>&nbsp; &nbsp;&nbsp;<strong>1.1创建简单的xml</strong></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('60be9b92-d724-4cac-95b2-ca90b82e0d27')"><img id="code_img_closed_60be9b92-d724-4cac-95b2-ca90b82e0d27" class="code_img_closed" src="./images/C# LINQ学习笔记五：LINQ to XML0.png" alt="" /><img id="code_img_opened_60be9b92-d724-4cac-95b2-ca90b82e0d27" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('60be9b92-d724-4cac-95b2-ca90b82e0d27',event)" src="./images/C# LINQ学习笔记五：LINQ to XML1.png" alt="" />
<div id="cnblogs_code_open_60be9b92-d724-4cac-95b2-ca90b82e0d27" class="cnblogs_code_hide">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> CreateXml类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> CreateXml
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 返回xml文件路径
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> Path
        {
            </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">string</span> path = <span style="color: #800000;">@"</span><span style="color: #800000;">..\..\LinqToXml.xml</span><span style="color: #800000;">"</span><span style="color: #000000;">;
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> path;
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 创建简单的xml并保存
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> CreateElement()
        {
            XDocument xdoc </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> XDocument
                (
                    </span><span style="color: #008000;">//</span><span style="color: #008000;">创建一个xml文档
                    </span><span style="color: #008000;">//</span><span style="color: #008000;">设置该xml的版本为1.0，采用utf - 8编码，后面的yes表示该xml是独立的。</span>
                    <span style="color: #0000ff;">new</span> XDeclaration(<span style="color: #800000;">"</span><span style="color: #800000;">1.0</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">yes</span><span style="color: #800000;">"</span><span style="color: #000000;">),
                    </span><span style="color: #008000;">//</span><span style="color: #008000;">开始创建每个节点的，首先是Root节点，然后在Root节点中添加两个Item节点。</span>
                    <span style="color: #0000ff;">new</span><span style="color: #000000;"> XElement
                    (
                        </span><span style="color: #800000;">"</span><span style="color: #800000;">Root</span><span style="color: #800000;">"</span><span style="color: #000000;">,
                        </span><span style="color: #0000ff;">new</span> XElement(<span style="color: #800000;">"</span><span style="color: #800000;">Item</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">1</span><span style="color: #800000;">"</span><span style="color: #000000;">),
                        </span><span style="color: #0000ff;">new</span> XElement(<span style="color: #800000;">"</span><span style="color: #800000;">Item</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">2</span><span style="color: #800000;">"</span><span style="color: #000000;">)
                    )
                );
            xdoc.Save(Path);
        }
    }

    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> 创建简单的xml<span style="color: #000000;">
            CreateXml xml </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> CreateXml();
            xml.CreateElement();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp;&nbsp;最终生成的xml如下所示：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="utf-8" standalone="yes"</span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>1<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>2<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>&nbsp; &nbsp;&nbsp;<strong>1.2创建xml注释</strong></p>
<p>&nbsp; &nbsp;&nbsp;当xml有很多项时，我们就需要利用注释加以区别，通过linq to xml我们一样可以在其中添加注释。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('f9c26ed7-5645-4450-b6b3-cd745ab13a3a')"><img id="code_img_closed_f9c26ed7-5645-4450-b6b3-cd745ab13a3a" class="code_img_closed" src="./images/C# LINQ学习笔记五：LINQ to XML0.png" alt="" /><img id="code_img_opened_f9c26ed7-5645-4450-b6b3-cd745ab13a3a" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('f9c26ed7-5645-4450-b6b3-cd745ab13a3a',event)" src="./images/C# LINQ学习笔记五：LINQ to XML1.png" alt="" />
<div id="cnblogs_code_open_f9c26ed7-5645-4450-b6b3-cd745ab13a3a" class="cnblogs_code_hide">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> CreateXml类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> CreateXml
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 返回xml文件路径
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> Path
        {
            </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">string</span> path = <span style="color: #800000;">@"</span><span style="color: #800000;">..\..\LinqToXml.xml</span><span style="color: #800000;">"</span><span style="color: #000000;">;
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> path;
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 创建xml注释
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> CreateComment()
        {
            XDocument xdoc </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> XDocument
                (
                    </span><span style="color: #0000ff;">new</span> XDeclaration(<span style="color: #800000;">"</span><span style="color: #800000;">1.0</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">utf-8</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">yes</span><span style="color: #800000;">"</span><span style="color: #000000;">),
                    </span><span style="color: #0000ff;">new</span> XComment(<span style="color: #800000;">"</span><span style="color: #800000;">这里是注释</span><span style="color: #800000;">"</span><span style="color: #000000;">),
                    </span><span style="color: #0000ff;">new</span><span style="color: #000000;"> XElement
                        (
                            </span><span style="color: #800000;">"</span><span style="color: #800000;">Root</span><span style="color: #800000;">"</span><span style="color: #000000;">,
                            </span><span style="color: #0000ff;">new</span> XElement(<span style="color: #800000;">"</span><span style="color: #800000;">Item</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">1</span><span style="color: #800000;">"</span><span style="color: #000000;">),
                            </span><span style="color: #0000ff;">new</span> XElement(<span style="color: #800000;">"</span><span style="color: #800000;">Item</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">2</span><span style="color: #800000;">"</span><span style="color: #000000;">)
                        )
                );
            xdoc.Save(Path);
        }
    }

    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 创建xml注释<span style="color: #000000;">
            CreateXml xml </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> CreateXml();
            xml.CreateComment();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp;&nbsp;最终生成的xml如下所示：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="utf-8" standalone="yes"</span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #008000;">&lt;!--</span><span style="color: #008000;">这里是注释</span><span style="color: #008000;">--&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>1<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>2<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>&nbsp; &nbsp; <strong>1.3根据对象创建xml</strong></p>
<p>&nbsp; &nbsp;&nbsp;很多时候我们都会将数组之类的类型转换成xml以便保存进永久性存储介质中。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('5e5fa2a7-8a75-4a44-bc8c-c9e9d8d0e8fd')"><img id="code_img_closed_5e5fa2a7-8a75-4a44-bc8c-c9e9d8d0e8fd" class="code_img_closed" src="./images/C# LINQ学习笔记五：LINQ to XML0.png" alt="" /><img id="code_img_opened_5e5fa2a7-8a75-4a44-bc8c-c9e9d8d0e8fd" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('5e5fa2a7-8a75-4a44-bc8c-c9e9d8d0e8fd',event)" src="./images/C# LINQ学习笔记五：LINQ to XML1.png" alt="" />
<div id="cnblogs_code_open_5e5fa2a7-8a75-4a44-bc8c-c9e9d8d0e8fd" class="cnblogs_code_hide">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> CreateXml类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> CreateXml
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 返回xml文件路径
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> Path
        {
            </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">string</span> path = <span style="color: #800000;">@"</span><span style="color: #800000;">..\..\LinqToXml.xml</span><span style="color: #800000;">"</span><span style="color: #000000;">;
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> path;
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 根据对象创建xml并保存
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> CreateElementByObjects()
        {
            </span><span style="color: #0000ff;">var</span> objs = Enumerable.Range(<span style="color: #800080;">1</span>, <span style="color: #800080;">6</span><span style="color: #000000;">);
            XElement xe </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> XElement
                (
                    </span><span style="color: #800000;">"</span><span style="color: #800000;">Root</span><span style="color: #800000;">"</span><span style="color: #000000;">,
                    </span><span style="color: #0000ff;">from</span> obj <span style="color: #0000ff;">in</span><span style="color: #000000;"> objs
                    </span><span style="color: #0000ff;">select</span> <span style="color: #0000ff;">new</span> XElement(<span style="color: #800000;">"</span><span style="color: #800000;">Item</span><span style="color: #800000;">"</span><span style="color: #000000;">, obj.ToString())
                );
            xe.Save(Path);
        }
    }

    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 根据对象创建xml<span style="color: #000000;">
            CreateXml xml </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> CreateXml();
            xml.CreateElementByObjects();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp;&nbsp;最终生成的xml如下所示：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="utf-8"</span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>1<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>2<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>3<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>4<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>5<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>6<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>&nbsp; &nbsp;&nbsp;<strong>1.4创建xml属性</strong></p>
<p>&nbsp; &nbsp; 有时我们不想创建新的子项去保存数据，而是使用属性的方式去保存。理所应当，<strong>linq to xml</strong>一样也支持这个功能，下面我们可以通过简单的语句去</p>
<p>实现它。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('1e3b3a03-edd1-457c-a72b-c9d0f51f7c6e')"><img id="code_img_closed_1e3b3a03-edd1-457c-a72b-c9d0f51f7c6e" class="code_img_closed" src="./images/C# LINQ学习笔记五：LINQ to XML0.png" alt="" /><img id="code_img_opened_1e3b3a03-edd1-457c-a72b-c9d0f51f7c6e" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('1e3b3a03-edd1-457c-a72b-c9d0f51f7c6e',event)" src="./images/C# LINQ学习笔记五：LINQ to XML1.png" alt="" />
<div id="cnblogs_code_open_1e3b3a03-edd1-457c-a72b-c9d0f51f7c6e" class="cnblogs_code_hide">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> CreateXml类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> CreateXml
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 返回xml文件路径
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> Path
        {
            </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">string</span> path = <span style="color: #800000;">@"</span><span style="color: #800000;">..\..\LinqToXml.xml</span><span style="color: #800000;">"</span><span style="color: #000000;">;
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> path;
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 创建xml属性
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> CreateAttribute()
        {
            XAttribute xa </span>= <span style="color: #0000ff;">new</span> XAttribute(<span style="color: #800000;">"</span><span style="color: #800000;">V2</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">2</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            XElement xe </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> XElement
                (
                    </span><span style="color: #800000;">"</span><span style="color: #800000;">Root</span><span style="color: #800000;">"</span><span style="color: #000000;">,
                    </span><span style="color: #0000ff;">new</span><span style="color: #000000;"> XElement
                        (
                            </span><span style="color: #800000;">"</span><span style="color: #800000;">Item</span><span style="color: #800000;">"</span><span style="color: #000000;">,
                            </span><span style="color: #0000ff;">new</span> XAttribute(<span style="color: #800000;">"</span><span style="color: #800000;">V1</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">1</span><span style="color: #800000;">"</span><span style="color: #000000;">),
                            xa
                        )
                );
            xe.Save(Path);
        }
    }

    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 创建xml属性<span style="color: #000000;">
            CreateXml xml </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> CreateXml();
            xml.CreateAttribute();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp;&nbsp;最终生成的xml如下所示：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="utf-8"</span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item </span><span style="color: #ff0000;">V1</span><span style="color: #0000ff;">="1"</span><span style="color: #ff0000;"> V2</span><span style="color: #0000ff;">="2"</span> <span style="color: #0000ff;">/&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>&nbsp; &nbsp; <strong>1.5创建xml命名空间</strong></p>
<p>&nbsp; &nbsp; 对于一些企业级的xml格式，会非常的严格，特别是在同一个xml中可能会出现重复的项，但是我们又想区分开来，这个时候我们可以利用命名空间将</p>
<p>他们分开（跟C#中的命名空间类似）。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('defbb879-8c12-4c82-a937-2f28fe61ffe6')"><img id="code_img_closed_defbb879-8c12-4c82-a937-2f28fe61ffe6" class="code_img_closed" src="./images/C# LINQ学习笔记五：LINQ to XML0.png" alt="" /><img id="code_img_opened_defbb879-8c12-4c82-a937-2f28fe61ffe6" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('defbb879-8c12-4c82-a937-2f28fe61ffe6',event)" src="./images/C# LINQ学习笔记五：LINQ to XML1.png" alt="" />
<div id="cnblogs_code_open_defbb879-8c12-4c82-a937-2f28fe61ffe6" class="cnblogs_code_hide">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> CreateXml类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> CreateXml
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 返回xml文件路径
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> Path
        {
            </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">string</span> path = <span style="color: #800000;">@"</span><span style="color: #800000;">..\..\LinqToXml.xml</span><span style="color: #800000;">"</span><span style="color: #000000;">;
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> path;
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 创建xml命名空间
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> CreateNamespace()
        {
            XElement xe </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> XElement
                (
                    </span><span style="color: #800000;">"</span><span style="color: #800000;">{http://www.xamarin-cn.com/}Root</span><span style="color: #800000;">"</span><span style="color: #000000;">,
                    </span><span style="color: #0000ff;">new</span> XElement(<span style="color: #800000;">"</span><span style="color: #800000;">Item</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">1</span><span style="color: #800000;">"</span><span style="color: #000000;">),
                    </span><span style="color: #0000ff;">new</span> XElement(<span style="color: #800000;">"</span><span style="color: #800000;">{http://www.baidu.com/}Item</span><span style="color: #800000;">"</span>, <span style="color: #800080;">2</span><span style="color: #000000;">)
                );
            xe.Save(Path);
        }
    }

    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 创建xml命名空间<span style="color: #000000;">
            CreateXml xml </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> CreateXml();
            xml.CreateNamespace();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp;&nbsp;最终生成的xml如下所示：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="utf-8"</span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Root </span><span style="color: #ff0000;">xmlns</span><span style="color: #0000ff;">="http://www.xamarin-cn.com/"</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item </span><span style="color: #ff0000;">xmlns</span><span style="color: #0000ff;">=""</span><span style="color: #0000ff;">&gt;</span>1<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item </span><span style="color: #ff0000;">xmlns</span><span style="color: #0000ff;">="http://www.baidu.com/"</span><span style="color: #0000ff;">&gt;</span>2<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>&nbsp; &nbsp;&nbsp;从这个结果中我们可以看到对应的属性中有了<strong>xmlns</strong>属性，并且值就是我们赋给它的命名空间。</p>
<p>&nbsp; &nbsp;&nbsp;<strong>二、查询并修改Xml</strong></p>
<p>&nbsp; &nbsp;&nbsp;linq to xml不仅创建xml简单，在查询、编辑和删除方面也一样是非常方便的。</p>
<p>&nbsp; &nbsp; 创建一个XmlReadWrite.xml文件：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="utf-8"</span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item </span><span style="color: #ff0000;">v1</span><span style="color: #0000ff;">="1"</span><span style="color: #ff0000;"> v2</span><span style="color: #0000ff;">="2"</span><span style="color: #0000ff;">&gt;</span>Item1<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item </span><span style="color: #ff0000;">v1</span><span style="color: #0000ff;">="1"</span><span style="color: #ff0000;"> v2</span><span style="color: #0000ff;">="2"</span><span style="color: #0000ff;">&gt;</span>Item2<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>&nbsp; &nbsp; <strong>2.1读取xml文件</strong></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('33860060-97a5-4352-a760-850bcb36d842')"><img id="code_img_closed_33860060-97a5-4352-a760-850bcb36d842" class="code_img_closed" src="./images/C# LINQ学习笔记五：LINQ to XML0.png" alt="" /><img id="code_img_opened_33860060-97a5-4352-a760-850bcb36d842" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('33860060-97a5-4352-a760-850bcb36d842',event)" src="./images/C# LINQ学习笔记五：LINQ to XML1.png" alt="" />
<div id="cnblogs_code_open_33860060-97a5-4352-a760-850bcb36d842" class="cnblogs_code_hide">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> QueryXml类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> QueryXml
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 返回xml文件路径
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> Path
        {
            </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">string</span> path = <span style="color: #800000;">@"</span><span style="color: #800000;">..\..\XmlReadWrite.xml</span><span style="color: #800000;">"</span><span style="color: #000000;">;
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> path;
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 读取xml文件
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> QueryElementByFile()
        {
            XElement xe </span>=<span style="color: #000000;"> XElement.Load(Path);
            XElement xe1 </span>= xe.Element(<span style="color: #800000;">"</span><span style="color: #800000;">Item</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            Console.Write(xe1.Value.Trim());
            Console.ReadKey();
        }
    }

    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 读取xml文件<span style="color: #000000;">
            QueryXml xml </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> QueryXml();
            xml.QueryElementByFile();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C# LINQ学习笔记五：LINQ to XML12.png" alt="" /></p>
<p>&nbsp; &nbsp;&nbsp;上面的示例，我们利用XElement的静态方法<strong>Load</strong>读取指定路径下的xml文件，同时还获取了该xml文件的第一个item的值并输出。</p>
<p>&nbsp; &nbsp; <strong>2.2在xml指定节点前后添加新节点</strong></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('1f13fb8a-d212-4f7a-8103-b3b45b13a50d')"><img id="code_img_closed_1f13fb8a-d212-4f7a-8103-b3b45b13a50d" class="code_img_closed" src="./images/C# LINQ学习笔记五：LINQ to XML0.png" alt="" /><img id="code_img_opened_1f13fb8a-d212-4f7a-8103-b3b45b13a50d" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('1f13fb8a-d212-4f7a-8103-b3b45b13a50d',event)" src="./images/C# LINQ学习笔记五：LINQ to XML1.png" alt="" />
<div id="cnblogs_code_open_1f13fb8a-d212-4f7a-8103-b3b45b13a50d" class="cnblogs_code_hide">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> QueryXml类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> QueryXml
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 返回xml文件路径
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> Path
        {
            </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">string</span> path = <span style="color: #800000;">@"</span><span style="color: #800000;">..\..\XmlReadWrite.xml</span><span style="color: #800000;">"</span><span style="color: #000000;">;
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> path;
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 在xml指定节点前后添加新节点
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> AddElementBeforeAndAfter()
        {
            XElement xe </span>=<span style="color: #000000;"> XElement.Load(Path);
            </span><span style="color: #0000ff;">var</span> item = (<span style="color: #0000ff;">from</span> t <span style="color: #0000ff;">in</span> xe.Elements(<span style="color: #800000;">"</span><span style="color: #800000;">Item</span><span style="color: #800000;">"</span><span style="color: #000000;">)
                        </span><span style="color: #0000ff;">where</span> t.Value.Equals(<span style="color: #800000;">"</span><span style="color: #800000;">Item2</span><span style="color: #800000;">"</span><span style="color: #000000;">)
                        </span><span style="color: #0000ff;">select</span><span style="color: #000000;"> t).SingleOrDefault();
            </span><span style="color: #0000ff;">if</span> (item != <span style="color: #0000ff;">null</span><span style="color: #000000;">)
            {
                XElement bxe </span>= <span style="color: #0000ff;">new</span> XElement(<span style="color: #800000;">"</span><span style="color: #800000;">Item</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">ItemB</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                XElement axe </span>= <span style="color: #0000ff;">new</span> XElement(<span style="color: #800000;">"</span><span style="color: #800000;">Item</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">ItemA</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                item.AddBeforeSelf(bxe);
                item.AddAfterSelf(axe);
                xe.Save(Path);
            }
        }
    }

    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 在xml指定节点前后添加新节点<span style="color: #000000;">
            QueryXml xml </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> QueryXml();
            xml.AddElementBeforeAndAfter();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp;&nbsp;最终生成的xml如下所示：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="utf-8"</span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item </span><span style="color: #ff0000;">v1</span><span style="color: #0000ff;">="1"</span><span style="color: #ff0000;"> v2</span><span style="color: #0000ff;">="2"</span><span style="color: #0000ff;">&gt;</span>Item1<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>ItemB<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item </span><span style="color: #ff0000;">v1</span><span style="color: #0000ff;">="1"</span><span style="color: #ff0000;"> v2</span><span style="color: #0000ff;">="2"</span><span style="color: #0000ff;">&gt;</span>Item2<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>ItemA<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p><strong>&nbsp; &nbsp; 2.3添加属性到xml节点中</strong></p>
<p>&nbsp; &nbsp; 我们已经可以动态的添加节点，但是创建的时候不仅仅可以创建节点，并且还能创建属性，下面我们可以通过<strong>SetAttributeValue</strong>去添加新的属性或者</p>
<p>修改现有属性。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('864970f7-baf3-4c73-98dd-01bd16ae4098')"><img id="code_img_closed_864970f7-baf3-4c73-98dd-01bd16ae4098" class="code_img_closed" src="./images/C# LINQ学习笔记五：LINQ to XML0.png" alt="" /><img id="code_img_opened_864970f7-baf3-4c73-98dd-01bd16ae4098" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('864970f7-baf3-4c73-98dd-01bd16ae4098',event)" src="./images/C# LINQ学习笔记五：LINQ to XML1.png" alt="" />
<div id="cnblogs_code_open_864970f7-baf3-4c73-98dd-01bd16ae4098" class="cnblogs_code_hide">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> QueryXml类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> QueryXml
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 返回xml文件路径
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> Path
        {
            </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">string</span> path = <span style="color: #800000;">@"</span><span style="color: #800000;">..\..\XmlReadWrite.xml</span><span style="color: #800000;">"</span><span style="color: #000000;">;
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> path;
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 添加属性到xml节点中
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> AddAttributeToElement()
        {
            XElement xe </span>= XElement.Parse(<span style="color: #800000;">@"</span><span style="color: #800000;">&lt;?xml version='1.0' encoding='utf-8'?&gt;&lt;Root&gt;
                &lt;Item v1='1' v2='2'&gt;Item1&lt;/Item&gt;&lt;Item v1='1' v2='2'&gt;Item2&lt;/Item&gt;&lt;/Root&gt;</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            </span><span style="color: #0000ff;">var</span> item = (<span style="color: #0000ff;">from</span> t <span style="color: #0000ff;">in</span> xe.Elements(<span style="color: #800000;">"</span><span style="color: #800000;">Item</span><span style="color: #800000;">"</span><span style="color: #000000;">)
                        </span><span style="color: #0000ff;">where</span> t.Value.Equals(<span style="color: #800000;">"</span><span style="color: #800000;">Item2</span><span style="color: #800000;">"</span><span style="color: #000000;">)
                        </span><span style="color: #0000ff;">select</span><span style="color: #000000;"> t).SingleOrDefault();
            item.SetAttributeValue(</span><span style="color: #800000;">"</span><span style="color: #800000;">v3</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">3</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            xe.Save(Path);
        }
    }

    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 添加属性到xml节点中<span style="color: #000000;">
            QueryXml xml </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> QueryXml();
            xml.AddAttributeToElement();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp;&nbsp;最终生成的xml如下所示：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="utf-8"</span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item </span><span style="color: #ff0000;">v1</span><span style="color: #0000ff;">="1"</span><span style="color: #ff0000;"> v2</span><span style="color: #0000ff;">="2"</span><span style="color: #0000ff;">&gt;</span>Item1<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item </span><span style="color: #ff0000;">v1</span><span style="color: #0000ff;">="1"</span><span style="color: #ff0000;"> v2</span><span style="color: #0000ff;">="2"</span><span style="color: #ff0000;"> v3</span><span style="color: #0000ff;">="3"</span><span style="color: #0000ff;">&gt;</span>Item2<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>&nbsp; &nbsp;&nbsp;<strong>2.4添加注释到xml指定节点前后</strong></p>
<p>&nbsp; &nbsp; 这里的语法基本跟【在xml指定节点前后添加新节点】是相似的，只是读取xml的方式不同。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('1ac0b189-e144-4a52-b7c7-554dda21bebc')"><img id="code_img_closed_1ac0b189-e144-4a52-b7c7-554dda21bebc" class="code_img_closed" src="./images/C# LINQ学习笔记五：LINQ to XML0.png" alt="" /><img id="code_img_opened_1ac0b189-e144-4a52-b7c7-554dda21bebc" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('1ac0b189-e144-4a52-b7c7-554dda21bebc',event)" src="./images/C# LINQ学习笔记五：LINQ to XML1.png" alt="" />
<div id="cnblogs_code_open_1ac0b189-e144-4a52-b7c7-554dda21bebc" class="cnblogs_code_hide">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> QueryXml类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> QueryXml
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 返回xml文件路径
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> Path
        {
            </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">string</span> path = <span style="color: #800000;">@"</span><span style="color: #800000;">..\..\XmlReadWrite.xml</span><span style="color: #800000;">"</span><span style="color: #000000;">;
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> path;
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 添加注释到xml指定节点前后
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> AddCommentBeforeAndAfter()
        {
            TextReader tr </span>= <span style="color: #0000ff;">new</span> StringReader(<span style="color: #800000;">@"</span><span style="color: #800000;">&lt;?xml version='1.0' encoding='utf-8'?&gt;&lt;Root&gt;
                &lt;Item v1='1' v2='2'&gt;Item1&lt;/Item&gt;&lt;Item v1='1' v2='2' v3='3'&gt;Item2&lt;/Item&gt;&lt;/Root&gt;</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            XElement xe </span>=<span style="color: #000000;"> XElement.Load(tr);
            </span><span style="color: #0000ff;">var</span> item = (<span style="color: #0000ff;">from</span> t <span style="color: #0000ff;">in</span> xe.Elements(<span style="color: #800000;">"</span><span style="color: #800000;">Item</span><span style="color: #800000;">"</span><span style="color: #000000;">)
                        </span><span style="color: #0000ff;">where</span> t.Value.Equals(<span style="color: #800000;">"</span><span style="color: #800000;">Item1</span><span style="color: #800000;">"</span><span style="color: #000000;">)
                        </span><span style="color: #0000ff;">select</span><span style="color: #000000;"> t).FirstOrDefault();
            </span><span style="color: #0000ff;">if</span> (item != <span style="color: #0000ff;">null</span><span style="color: #000000;">)
            {
                XComment bcom </span>= <span style="color: #0000ff;">new</span> XComment(<span style="color: #800000;">"</span><span style="color: #800000;">前面的注释</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                XComment acom </span>= <span style="color: #0000ff;">new</span> XComment(<span style="color: #800000;">"</span><span style="color: #800000;">后面的注释</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                item.AddBeforeSelf(bcom);
                item.AddAfterSelf(acom);
            }
            tr.Close();
            xe.Save(Path);
        }
    }

    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 添加注释到xml指定节点前后<span style="color: #000000;">
            QueryXml xml </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> QueryXml();
            xml.AddCommentBeforeAndAfter();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp;&nbsp;最终生成的xml如下所示：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="utf-8"</span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #008000;">&lt;!--</span><span style="color: #008000;">前面的注释</span><span style="color: #008000;">--&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item </span><span style="color: #ff0000;">v1</span><span style="color: #0000ff;">="1"</span><span style="color: #ff0000;"> v2</span><span style="color: #0000ff;">="2"</span><span style="color: #0000ff;">&gt;</span>Item1<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #008000;">&lt;!--</span><span style="color: #008000;">后面的注释</span><span style="color: #008000;">--&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item </span><span style="color: #ff0000;">v1</span><span style="color: #0000ff;">="1"</span><span style="color: #ff0000;"> v2</span><span style="color: #0000ff;">="2"</span><span style="color: #ff0000;"> v3</span><span style="color: #0000ff;">="3"</span><span style="color: #0000ff;">&gt;</span>Item2<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>&nbsp; &nbsp; <strong>2.5替换xml指定节点</strong></p>
<p>&nbsp; &nbsp;&nbsp;修改节点的值通过<strong>SetValue</strong>即可做到，但是有时涉及到子节点，而我们想一次性全部替换掉，那么我们就需要使用<strong>ReplaceWith</strong>。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('2a3af4e6-4d58-48a9-a121-8b80f5c6c052')"><img id="code_img_closed_2a3af4e6-4d58-48a9-a121-8b80f5c6c052" class="code_img_closed" src="./images/C# LINQ学习笔记五：LINQ to XML0.png" alt="" /><img id="code_img_opened_2a3af4e6-4d58-48a9-a121-8b80f5c6c052" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('2a3af4e6-4d58-48a9-a121-8b80f5c6c052',event)" src="./images/C# LINQ学习笔记五：LINQ to XML1.png" alt="" />
<div id="cnblogs_code_open_2a3af4e6-4d58-48a9-a121-8b80f5c6c052" class="cnblogs_code_hide">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> QueryXml类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> QueryXml
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 返回xml文件路径
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> Path
        {
            </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">string</span> path = <span style="color: #800000;">@"</span><span style="color: #800000;">..\..\XmlReadWrite.xml</span><span style="color: #800000;">"</span><span style="color: #000000;">;
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> path;
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 替换xml指定节点
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> ReplaceElement()
        {
            XElement xe </span>=<span style="color: #000000;"> XElement.Load(Path);
            </span><span style="color: #0000ff;">var</span> item = (<span style="color: #0000ff;">from</span> t <span style="color: #0000ff;">in</span> xe.Elements(<span style="color: #800000;">"</span><span style="color: #800000;">Item</span><span style="color: #800000;">"</span><span style="color: #000000;">)
                        </span><span style="color: #0000ff;">where</span> t.Value.Equals(<span style="color: #800000;">"</span><span style="color: #800000;">Item2</span><span style="color: #800000;">"</span><span style="color: #000000;">)
                        </span><span style="color: #0000ff;">select</span><span style="color: #000000;"> t).FirstOrDefault();
            </span><span style="color: #0000ff;">if</span> (item != <span style="color: #0000ff;">null</span><span style="color: #000000;">)
            {
                item.ReplaceWith(</span><span style="color: #0000ff;">new</span> XElement(<span style="color: #800000;">"</span><span style="color: #800000;">Item</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">Item3</span><span style="color: #800000;">"</span><span style="color: #000000;">));
            }
            xe.Save(Path);
        }
    }

    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 替换xml指定节点<span style="color: #000000;">
            QueryXml xml </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> QueryXml();
            xml.ReplaceElement();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp;&nbsp;最终生成的xml如下所示：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="utf-8"</span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #008000;">&lt;!--</span><span style="color: #008000;">前面的注释</span><span style="color: #008000;">--&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item </span><span style="color: #ff0000;">v1</span><span style="color: #0000ff;">="1"</span><span style="color: #ff0000;"> v2</span><span style="color: #0000ff;">="2"</span><span style="color: #0000ff;">&gt;</span>Item1<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #008000;">&lt;!--</span><span style="color: #008000;">后面的注释</span><span style="color: #008000;">--&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>Item3<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>&nbsp; &nbsp; <strong>2.6删除xml指定属性</strong></p>
<p>&nbsp; &nbsp;&nbsp;前面我们介绍了创建、修改和添加属性，但是还没有介绍如何删除指定的属性，下面我们就通过一个简单的实例来演示。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('db21d276-0a4b-44b9-ac2b-350355addf7f')"><img id="code_img_closed_db21d276-0a4b-44b9-ac2b-350355addf7f" class="code_img_closed" src="./images/C# LINQ学习笔记五：LINQ to XML0.png" alt="" /><img id="code_img_opened_db21d276-0a4b-44b9-ac2b-350355addf7f" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('db21d276-0a4b-44b9-ac2b-350355addf7f',event)" src="./images/C# LINQ学习笔记五：LINQ to XML1.png" alt="" />
<div id="cnblogs_code_open_db21d276-0a4b-44b9-ac2b-350355addf7f" class="cnblogs_code_hide">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> QueryXml类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> QueryXml
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 返回xml文件路径
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> Path
        {
            </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">string</span> path = <span style="color: #800000;">@"</span><span style="color: #800000;">..\..\XmlReadWrite.xml</span><span style="color: #800000;">"</span><span style="color: #000000;">;
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> path;
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 删除xml指定属性
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> RemoveAttribute()
        {
            XElement xe </span>=<span style="color: #000000;"> XElement.Load(Path);
            </span><span style="color: #0000ff;">var</span> item = (<span style="color: #0000ff;">from</span> t <span style="color: #0000ff;">in</span> xe.Elements(<span style="color: #800000;">"</span><span style="color: #800000;">Item</span><span style="color: #800000;">"</span><span style="color: #000000;">)
                        </span><span style="color: #0000ff;">where</span> t.Value.Equals(<span style="color: #800000;">"</span><span style="color: #800000;">Item1</span><span style="color: #800000;">"</span><span style="color: #000000;">)
                        </span><span style="color: #0000ff;">select</span> t).FirstOrDefault().Attribute(<span style="color: #800000;">"</span><span style="color: #800000;">v2</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            </span><span style="color: #0000ff;">if</span> (item != <span style="color: #0000ff;">null</span><span style="color: #000000;">)
            {
                item.Remove();
            }
            xe.Save(Path);
        }
    }

    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 删除xml指定属性<span style="color: #000000;">
            QueryXml xml </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> QueryXml();
            xml.RemoveAttribute();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 最终生成的xml如下所示：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="utf-8"</span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #008000;">&lt;!--</span><span style="color: #008000;">前面的注释</span><span style="color: #008000;">--&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item </span><span style="color: #ff0000;">v1</span><span style="color: #0000ff;">="1"</span><span style="color: #0000ff;">&gt;</span>Item1<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #008000;">&lt;!--</span><span style="color: #008000;">后面的注释</span><span style="color: #008000;">--&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>Item3<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>&nbsp; &nbsp; <strong>2.7删除xml指定节点</strong></p>
<p>&nbsp; &nbsp;&nbsp;既然上面已经可以删除属性，自然也少不了删除属性。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('7dfdb9e6-f93b-4bde-ba41-33903698ee83')"><img id="code_img_closed_7dfdb9e6-f93b-4bde-ba41-33903698ee83" class="code_img_closed" src="./images/C# LINQ学习笔记五：LINQ to XML0.png" alt="" /><img id="code_img_opened_7dfdb9e6-f93b-4bde-ba41-33903698ee83" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('7dfdb9e6-f93b-4bde-ba41-33903698ee83',event)" src="./images/C# LINQ学习笔记五：LINQ to XML1.png" alt="" />
<div id="cnblogs_code_open_7dfdb9e6-f93b-4bde-ba41-33903698ee83" class="cnblogs_code_hide">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> QueryXml类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> QueryXml
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 返回xml文件路径
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> Path
        {
            </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">string</span> path = <span style="color: #800000;">@"</span><span style="color: #800000;">..\..\XmlReadWrite.xml</span><span style="color: #800000;">"</span><span style="color: #000000;">;
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> path;
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 删除xml指定节点
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> RemoveElement()
        {
            XElement xe </span>=<span style="color: #000000;"> XElement.Load(Path);
            </span><span style="color: #0000ff;">var</span> item = (<span style="color: #0000ff;">from</span> t <span style="color: #0000ff;">in</span> xe.Elements(<span style="color: #800000;">"</span><span style="color: #800000;">Item</span><span style="color: #800000;">"</span><span style="color: #000000;">)
                        </span><span style="color: #0000ff;">where</span> t.Value.Equals(<span style="color: #800000;">"</span><span style="color: #800000;">Item3</span><span style="color: #800000;">"</span><span style="color: #000000;">)
                        </span><span style="color: #0000ff;">select</span><span style="color: #000000;"> t).FirstOrDefault();
            </span><span style="color: #0000ff;">if</span> (item != <span style="color: #0000ff;">null</span><span style="color: #000000;">)
            {
                item.Remove();
            }
            xe.Save(Path);
        }
    }

    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 删除xml指定节点<span style="color: #000000;">
            QueryXml xml </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> QueryXml();
            xml.RemoveElement();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp;&nbsp;最终生成的xml如下所示：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="utf-8"</span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #008000;">&lt;!--</span><span style="color: #008000;">前面的注释</span><span style="color: #008000;">--&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item </span><span style="color: #ff0000;">v1</span><span style="color: #0000ff;">="1"</span><span style="color: #0000ff;">&gt;</span>Item1<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #008000;">&lt;!--</span><span style="color: #008000;">后面的注释</span><span style="color: #008000;">--&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>&nbsp; &nbsp;&nbsp;<strong>三、按节点关系查询</strong></p>
<p>&nbsp; &nbsp; 上面的查询都是通过相关的条件进行查询，但是我们有时仅仅只需要通过之间的关系即可，这样反而可以避免很多的代码，当然稍加探索可以发现其</p>
<p>实<strong>XElement</strong>都提供给我们了。</p>
<p>&nbsp; &nbsp;&nbsp;创建一个Structure.xml文件：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="utf-8" </span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">SubItem1</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
      1
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">SubItem1</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">SubItem</span><span style="color: #0000ff;">&gt;</span>
      <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Child</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
        sss
      </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Child</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">SubItem</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">SubItem2</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
      2
    </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">SubItem2</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>&nbsp; &nbsp;&nbsp;<strong>3.1显示xml指定节点的所有父节点</strong></p>
<p>&nbsp; &nbsp;&nbsp;通过上面的xml文件，我们清晰的看出xml是具有结构性的，彼此之间都存在关系，而现在我们需要显示某个节点的父级节点的名称。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('092f2d31-b0ad-4fa8-af33-84c079fe59cf')"><img id="code_img_closed_092f2d31-b0ad-4fa8-af33-84c079fe59cf" class="code_img_closed" src="./images/C# LINQ学习笔记五：LINQ to XML0.png" alt="" /><img id="code_img_opened_092f2d31-b0ad-4fa8-af33-84c079fe59cf" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('092f2d31-b0ad-4fa8-af33-84c079fe59cf',event)" src="./images/C# LINQ学习笔记五：LINQ to XML1.png" alt="" />
<div id="cnblogs_code_open_092f2d31-b0ad-4fa8-af33-84c079fe59cf" class="cnblogs_code_hide">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> StructureXml类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> StructureXml
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> Path
        {
            </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">string</span> path = <span style="color: #0000ff;">string</span>.Format(<span style="color: #800000;">@"</span><span style="color: #800000;">..\..\Structure.xml</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> path;
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 显示xml指定节点的所有父节点
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> ShowAllParentElement()
        {
            XElement xe </span>=<span style="color: #000000;"> XElement.Load(Path);
            </span><span style="color: #0000ff;">var</span> item = (<span style="color: #0000ff;">from</span> t <span style="color: #0000ff;">in</span> xe.Descendants(<span style="color: #800000;">"</span><span style="color: #800000;">Child</span><span style="color: #800000;">"</span><span style="color: #000000;">)
                        </span><span style="color: #0000ff;">select</span><span style="color: #000000;"> t).FirstOrDefault();
            </span><span style="color: #0000ff;">if</span> (item != <span style="color: #0000ff;">null</span><span style="color: #000000;">)
            {
                Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">----------------------------</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">{item.Name}的向上父节点有：</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> upper <span style="color: #0000ff;">in</span><span style="color: #000000;"> item.Ancestors())
                {
                    Console.WriteLine(upper.Name);
                }
                Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">----------------------------</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">{item.Name}及向上父节点有：</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> selfAndUpper <span style="color: #0000ff;">in</span><span style="color: #000000;"> item.AncestorsAndSelf())
                {
                    Console.WriteLine(selfAndUpper.Name);
                }
                Console.Read();
            }
        }
    }

    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 显示xml指定节点的所有父节点<span style="color: #000000;">
            StructureXml xml </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> StructureXml();
            xml.ShowAllParentElement();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C# LINQ学习笔记五：LINQ to XML27.png" alt="" /></p>
<p>&nbsp; &nbsp;&nbsp;<strong>3.2显示xml指定节点的所有子节点</strong></p>
<p>&nbsp; &nbsp;&nbsp;我们不仅仅可以输出一个节点的所有父级节点，同样也可以输出一个节点的所有子节点。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('02eb5ad0-83db-4436-84ae-f6e113616b80')"><img id="code_img_closed_02eb5ad0-83db-4436-84ae-f6e113616b80" class="code_img_closed" src="./images/C# LINQ学习笔记五：LINQ to XML0.png" alt="" /><img id="code_img_opened_02eb5ad0-83db-4436-84ae-f6e113616b80" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('02eb5ad0-83db-4436-84ae-f6e113616b80',event)" src="./images/C# LINQ学习笔记五：LINQ to XML1.png" alt="" />
<div id="cnblogs_code_open_02eb5ad0-83db-4436-84ae-f6e113616b80" class="cnblogs_code_hide">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> StructureXml类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> StructureXml
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> Path
        {
            </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">string</span> path = <span style="color: #0000ff;">string</span>.Format(<span style="color: #800000;">@"</span><span style="color: #800000;">..\..\Structure.xml</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> path;
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 显示xml指定节点的所有子节点
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> ShowAllChildElement()
        {
            XElement xe </span>=<span style="color: #000000;"> XElement.Load(Path);
            Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">----------------------------</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> sub <span style="color: #0000ff;">in</span><span style="color: #000000;"> xe.Descendants())
            {
                Console.WriteLine(sub.Name);
            }
            Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">----------------------------</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> sub <span style="color: #0000ff;">in</span><span style="color: #000000;"> xe.DescendantsAndSelf())
            {
                Console.WriteLine(sub.Name);
            }
            Console.ReadKey();
        }
    }

    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 显示xml指定节点的所有子节点<span style="color: #000000;">
            StructureXml xml </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> StructureXml();
            xml.ShowAllChildElement();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C# LINQ学习笔记五：LINQ to XML30.png" alt="" /></p>
<p>&nbsp; &nbsp;&nbsp;<strong>3.3显示xml同级节点之前的节点</strong></p>
<p>&nbsp; &nbsp; 既然有了父子关系，当然也少不了同级关系，首先我们先显示同级节点之前的节点。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('1accfce7-0089-447b-9d21-0c7ffb7fd5df')"><img id="code_img_closed_1accfce7-0089-447b-9d21-0c7ffb7fd5df" class="code_img_closed" src="./images/C# LINQ学习笔记五：LINQ to XML0.png" alt="" /><img id="code_img_opened_1accfce7-0089-447b-9d21-0c7ffb7fd5df" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('1accfce7-0089-447b-9d21-0c7ffb7fd5df',event)" src="./images/C# LINQ学习笔记五：LINQ to XML1.png" alt="" />
<div id="cnblogs_code_open_1accfce7-0089-447b-9d21-0c7ffb7fd5df" class="cnblogs_code_hide">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> StructureXml类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> StructureXml
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> Path
        {
            </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">string</span> path = <span style="color: #0000ff;">string</span>.Format(<span style="color: #800000;">@"</span><span style="color: #800000;">..\..\Structure.xml</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> path;
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 显示xml同级节点之前的节点
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> ShowPrevElement()
        {
            XElement xe </span>=<span style="color: #000000;"> XElement.Load(Path);
            </span><span style="color: #0000ff;">var</span> item = (<span style="color: #0000ff;">from</span> t <span style="color: #0000ff;">in</span> xe.Descendants(<span style="color: #800000;">"</span><span style="color: #800000;">SubItem2</span><span style="color: #800000;">"</span><span style="color: #000000;">)
                        </span><span style="color: #0000ff;">select</span><span style="color: #000000;"> t).FirstOrDefault();
            </span><span style="color: #0000ff;">if</span> (item != <span style="color: #0000ff;">null</span><span style="color: #000000;">)
            {
                Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">与{item.Name}同级的前节点有：</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> sub <span style="color: #0000ff;">in</span><span style="color: #000000;"> item.ElementsBeforeSelf())
                {
                    Console.WriteLine(sub.Name);
                }
            }
            Console.Read();
        }
    }

    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 显示xml同级节点之前的节点<span style="color: #000000;">
            StructureXml xml </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> StructureXml();
            xml.ShowPrevElement();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C# LINQ学习笔记五：LINQ to XML33.png" alt="" /></p>
<p>&nbsp; &nbsp;&nbsp;<strong>3.4显示xml同级节点之后的节点</strong></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('7587f5ea-e313-4baa-a2e3-af7e215713e7')"><img id="code_img_closed_7587f5ea-e313-4baa-a2e3-af7e215713e7" class="code_img_closed" src="./images/C# LINQ学习笔记五：LINQ to XML0.png" alt="" /><img id="code_img_opened_7587f5ea-e313-4baa-a2e3-af7e215713e7" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('7587f5ea-e313-4baa-a2e3-af7e215713e7',event)" src="./images/C# LINQ学习笔记五：LINQ to XML1.png" alt="" />
<div id="cnblogs_code_open_7587f5ea-e313-4baa-a2e3-af7e215713e7" class="cnblogs_code_hide">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> StructureXml类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> StructureXml
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> Path
        {
            </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">string</span> path = <span style="color: #0000ff;">string</span>.Format(<span style="color: #800000;">@"</span><span style="color: #800000;">..\..\Structure.xml</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> path;
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 显示xml同级节点之后的节点
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> ShowNextElement()
        {
            XElement xe </span>=<span style="color: #000000;"> XElement.Load(Path);
            </span><span style="color: #0000ff;">var</span> item = (<span style="color: #0000ff;">from</span> t <span style="color: #0000ff;">in</span> xe.Descendants(<span style="color: #800000;">"</span><span style="color: #800000;">SubItem1</span><span style="color: #800000;">"</span><span style="color: #000000;">)
                        </span><span style="color: #0000ff;">select</span><span style="color: #000000;"> t).FirstOrDefault();
            </span><span style="color: #0000ff;">if</span> (item != <span style="color: #0000ff;">null</span><span style="color: #000000;">)
            {
                Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">与{item.Name}同级的后节点有：</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> sub <span style="color: #0000ff;">in</span><span style="color: #000000;"> item.ElementsAfterSelf())
                {
                    Console.WriteLine(sub.Name);
                }
            }
            Console.Read();
        }
    }

    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 显示xml同级节点之后的节点<span style="color: #000000;">
            StructureXml xml </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> StructureXml();
            xml.ShowNextElement();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C# LINQ学习笔记五：LINQ to XML36.png" alt="" /></p>
<p>&nbsp; &nbsp;&nbsp;<strong>四、监听xml事件</strong></p>
<p>&nbsp; &nbsp; 你可能会疑惑xml为什么还要监听？其实这样是有意义的，比如你要根据某个节点的值作为依赖，那么你就要监听这个节点，如果这个节点发生改变</p>
<p>的时候，你才可以及时的作出反应。但是xml的事件监听有一个特点，跟浏览器中的DOM事件类似，监听父节点同样也可以监听的到它的子节点的事件。</p>
<p>&nbsp; &nbsp; 下面我们通过一个简单的示例来说明：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('68090fe0-526a-4ac6-9f93-3bfc03801b03')"><img id="code_img_closed_68090fe0-526a-4ac6-9f93-3bfc03801b03" class="code_img_closed" src="./images/C# LINQ学习笔记五：LINQ to XML0.png" alt="" /><img id="code_img_opened_68090fe0-526a-4ac6-9f93-3bfc03801b03" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('68090fe0-526a-4ac6-9f93-3bfc03801b03',event)" src="./images/C# LINQ学习笔记五：LINQ to XML1.png" alt="" />
<div id="cnblogs_code_open_68090fe0-526a-4ac6-9f93-3bfc03801b03" class="cnblogs_code_hide">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> EventXml类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> EventXml
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> BindChangeing()
        {
            XElement xe </span>= <span style="color: #0000ff;">new</span> XElement(<span style="color: #800000;">"</span><span style="color: #800000;">Root</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            xe.Changing </span>+=<span style="color: #000000;"> XElement_Changing;
            xe.Changed </span>+=<span style="color: #000000;"> XElement_Changed;
            </span><span style="color: #008000;">//</span><span style="color: #008000;">添加元素</span>
            xe.Add(<span style="color: #0000ff;">new</span> XElement(<span style="color: #800000;">"</span><span style="color: #800000;">Item</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">1</span><span style="color: #800000;">"</span><span style="color: #000000;">));
            </span><span style="color: #0000ff;">var</span> item = xe.Element(<span style="color: #800000;">"</span><span style="color: #800000;">Item</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            </span><span style="color: #008000;">//</span><span style="color: #008000;">替换元素</span>
            item.ReplaceWith(<span style="color: #0000ff;">new</span> XElement(<span style="color: #800000;">"</span><span style="color: #800000;">Item</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">2</span><span style="color: #800000;">"</span><span style="color: #000000;">));
            </span><span style="color: #008000;">//</span><span style="color: #008000;">删除元素</span>
            item = xe.Element(<span style="color: #800000;">"</span><span style="color: #800000;">Item</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            item.Remove();
            </span><span style="color: #008000;">//</span><span style="color: #008000;">读取结果</span>
<span style="color: #000000;">            Console.Read();
        }

        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> XElement_Changing(<span style="color: #0000ff;">object</span><span style="color: #000000;"> sender, XObjectChangeEventArgs e)
        {
            XElement xe </span>= sender <span style="color: #0000ff;">as</span><span style="color: #000000;"> XElement;
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">{xe.Name}正在进行{e.ObjectChange}操作中，sender={sender.ToString()}。</span><span style="color: #800000;">"</span><span style="color: #000000;">);
        }

        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> XElement_Changed(<span style="color: #0000ff;">object</span><span style="color: #000000;"> sender, XObjectChangeEventArgs e)
        {
            XElement xe </span>= sender <span style="color: #0000ff;">as</span><span style="color: #000000;"> XElement;
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">{xe.Name}已完成{e.ObjectChange}操作，sender={sender.ToString()}。\n</span><span style="color: #800000;">"</span><span style="color: #000000;">);
        }
    }

    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 监听xml事件<span style="color: #000000;">
            EventXml.BindChangeing();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C# LINQ学习笔记五：LINQ to XML39.png" alt="" /></p>
<p>&nbsp; &nbsp;&nbsp;<strong>五、处理xml流</strong></p>
<p>&nbsp; &nbsp; 在实际的商业化的开发中，xml不可能仅仅保存这么点数据，有可能保存着非常多的数据。假如我们还是按照以往的方式，就会将xml全部读取进内</p>
<p>存，这样会占用非常多的内存从而影响系统的性能。针对这种情况我们需要使用流的方式去处理xml，因为流会按照我们的顺序读取部分xml进内存，</p>
<p>并不会将所有xml都读取到内存中。</p>
<p>&nbsp; &nbsp; 创建一个Stream.xml文件：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="utf-8" </span><span style="color: #0000ff;">?&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">SubItem</span><span style="color: #0000ff;">&gt;</span>1<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">SubItem</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">SubItem</span><span style="color: #0000ff;">&gt;</span>1<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">SubItem</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">SubItem</span><span style="color: #0000ff;">&gt;</span>1<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">SubItem</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>A<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">SubItem</span><span style="color: #0000ff;">&gt;</span>1<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">SubItem</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>B<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Item</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">Root</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>&nbsp; &nbsp;&nbsp;这里我们通过<strong>XmlReader</strong>的<strong>Create</strong>静态方法打开<strong>xml</strong>文件，并通过<strong>Read</strong>一个节点的进行读取，并判断该节点的类型。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('079d4a3d-53cd-455e-951d-292a5fb2198b')"><img id="code_img_closed_079d4a3d-53cd-455e-951d-292a5fb2198b" class="code_img_closed" src="./images/C# LINQ学习笔记五：LINQ to XML0.png" alt="" /><img id="code_img_opened_079d4a3d-53cd-455e-951d-292a5fb2198b" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('079d4a3d-53cd-455e-951d-292a5fb2198b',event)" src="./images/C# LINQ学习笔记五：LINQ to XML1.png" alt="" />
<div id="cnblogs_code_open_079d4a3d-53cd-455e-951d-292a5fb2198b" class="cnblogs_code_hide">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> ReadXmlStream类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> ReadXmlStream
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> Path
        {
            </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">string</span> path = <span style="color: #800000;">@"</span><span style="color: #800000;">..\..\Stream.xml</span><span style="color: #800000;">"</span><span style="color: #000000;">;
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> path;
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 流式处理XML
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> ReadXml()
        {
            XmlReader reader </span>=<span style="color: #000000;"> XmlReader.Create(Path);
            </span><span style="color: #0000ff;">while</span><span style="color: #000000;"> (reader.Read())
            {
                </span><span style="color: #0000ff;">if</span> (reader.NodeType == XmlNodeType.Element &amp;&amp; reader.Name.Equals(<span style="color: #800000;">"</span><span style="color: #800000;">Item</span><span style="color: #800000;">"</span><span style="color: #000000;">))
                {
                    XElement xe </span>= XNode.ReadFrom(reader) <span style="color: #0000ff;">as</span><span style="color: #000000;"> XElement;
                    Console.WriteLine(xe.Value.Trim());
                }
            }
            Console.Read();
        }
    }

    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> LINQ 处理xml流<span style="color: #000000;">
            ReadXmlStream.ReadXml();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C# LINQ学习笔记五：LINQ to XML42.png" alt="" /></p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>