<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修C#线程学习笔记九：async &amp; await入门二' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>C#线程学习笔记九：async &amp; await入门二</center></div><div class='banquan'>原文出处:本文由博客园博主缥缈的尘埃提供。<br/>
原文连接:https://www.cnblogs.com/atomy/p/12047697.html</div><br>
    <p>&nbsp; &nbsp;&nbsp;<strong>一、异步方法返回类型</strong></p>
<p>&nbsp; &nbsp;&nbsp;只能返回3种类型（void、Task和Task&lt;T&gt;）。</p>
<p>&nbsp; &nbsp; 1.1、void返回类型：调用方法执行异步方法，但又不需要做进一步的交互。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('b89f3360-b7e9-495b-84f1-8589e0eac828')"><img id="code_img_closed_b89f3360-b7e9-495b-84f1-8589e0eac828" class="code_img_closed" src="./images/C#线程学习笔记九：async &amp; await入门二0.png" alt="" /><img id="code_img_opened_b89f3360-b7e9-495b-84f1-8589e0eac828" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('b89f3360-b7e9-495b-84f1-8589e0eac828',event)" src="./images/C#线程学习笔记九：async &amp; await入门二1.png" alt="" />
<div id="cnblogs_code_open_b89f3360-b7e9-495b-84f1-8589e0eac828" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> async &amp; await入门二之void返回类型<span style="color: #000000;">
            AddAsync(</span><span style="color: #800080;">1</span>, <span style="color: #800080;">2</span><span style="color: #000000;">);
            Thread.Sleep(</span><span style="color: #800080;">1000</span><span style="color: #000000;">);
            Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">AddAsync方法执行完成。</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 加法
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="n"&gt;&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="m"&gt;&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">int</span> Add(<span style="color: #0000ff;">int</span> n, <span style="color: #0000ff;">int</span><span style="color: #000000;"> m)
        {
            </span><span style="color: #0000ff;">return</span> n +<span style="color: #000000;"> m;
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 异步加法
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="n"&gt;&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="m"&gt;&lt;/param&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">async</span> <span style="color: #0000ff;">void</span> AddAsync(<span style="color: #0000ff;">int</span> n, <span style="color: #0000ff;">int</span><span style="color: #000000;"> m)
        {
            </span><span style="color: #0000ff;">int</span> val = <span style="color: #0000ff;">await</span> Task.Run(() =&gt;<span style="color: #000000;"> Add(n, m));
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">Result: {val}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C#线程学习笔记九：async &amp; await入门二2.png" alt="" /></p>
<p>&nbsp; &nbsp; 1.2、Task返回类型：调用方法不需要从异步方法中取返回值，但是希望检查异步方法的状态，那么可以选择可以返回Task类型的对象。不过，就算异步方法中包含</p>
<p>return语句，也不会返回任何东西。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('90b4e3cc-f8c5-4fde-930b-44d653614cad')"><img id="code_img_closed_90b4e3cc-f8c5-4fde-930b-44d653614cad" class="code_img_closed" src="./images/C#线程学习笔记九：async &amp; await入门二0.png" alt="" /><img id="code_img_opened_90b4e3cc-f8c5-4fde-930b-44d653614cad" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('90b4e3cc-f8c5-4fde-930b-44d653614cad',event)" src="./images/C#线程学习笔记九：async &amp; await入门二1.png" alt="" />
<div id="cnblogs_code_open_90b4e3cc-f8c5-4fde-930b-44d653614cad" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> async &amp; await入门二之Task返回类型<span style="color: #000000;">
            Task task </span>= TaskAddAsync(<span style="color: #800080;">1</span>, <span style="color: #800080;">2</span><span style="color: #000000;">);
            task.Wait();
            Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">TaskAddAsync方法执行完成。</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 加法
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="n"&gt;&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="m"&gt;&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">int</span> Add(<span style="color: #0000ff;">int</span> n, <span style="color: #0000ff;">int</span><span style="color: #000000;"> m)
        {
            </span><span style="color: #0000ff;">return</span> n +<span style="color: #000000;"> m;
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 异步加法
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="n"&gt;&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="m"&gt;&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">async</span> Task TaskAddAsync(<span style="color: #0000ff;">int</span> n, <span style="color: #0000ff;">int</span><span style="color: #000000;"> m)
        {
            </span><span style="color: #0000ff;">int</span> val = <span style="color: #0000ff;">await</span> Task.Run(() =&gt;<span style="color: #000000;"> Add(n, m));
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">Result: {val}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C#线程学习笔记九：async &amp; await入门二5.png" alt="" /></p>
<p>&nbsp; &nbsp;&nbsp;1.3、Task&lt;T&gt;返回类型：调用方法要从调用中获取一个T类型的值，异步方法的返回类型就必须是Task&lt;T&gt;。调用方法从Task的Result属性获取的就是T类型的值。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('8cbcb304-e66e-41bf-8932-56bc25d73327')"><img id="code_img_closed_8cbcb304-e66e-41bf-8932-56bc25d73327" class="code_img_closed" src="./images/C#线程学习笔记九：async &amp; await入门二0.png" alt="" /><img id="code_img_opened_8cbcb304-e66e-41bf-8932-56bc25d73327" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('8cbcb304-e66e-41bf-8932-56bc25d73327',event)" src="./images/C#线程学习笔记九：async &amp; await入门二1.png" alt="" />
<div id="cnblogs_code_open_8cbcb304-e66e-41bf-8932-56bc25d73327" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> async &amp; await入门二之Task&lt;T&gt;返回类型<span style="color: #000000;">
            Task</span>&lt;<span style="color: #0000ff;">int</span>&gt; task = TaskTAddAsync(<span style="color: #800080;">1</span>, <span style="color: #800080;">2</span><span style="color: #000000;">);
            task.Wait();
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">Result: {task.Result}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 加法
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="n"&gt;&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="m"&gt;&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">int</span> Add(<span style="color: #0000ff;">int</span> n, <span style="color: #0000ff;">int</span><span style="color: #000000;"> m)
        {
            </span><span style="color: #0000ff;">return</span> n +<span style="color: #000000;"> m;
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 异步加法
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="n"&gt;&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="m"&gt;&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">async</span> Task&lt;<span style="color: #0000ff;">int</span>&gt; TaskTAddAsync(<span style="color: #0000ff;">int</span> n, <span style="color: #0000ff;">int</span><span style="color: #000000;"> m)
        {
            </span><span style="color: #0000ff;">int</span> val = <span style="color: #0000ff;">await</span> Task.Run(() =&gt;<span style="color: #000000;"> Add(n, m));
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> val;
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C#线程学习笔记九：async &amp; await入门二8.png" alt="" /></p>
<p>&nbsp; &nbsp; <strong>二、异步方法控制流</strong></p>
<p>&nbsp;<img src="./images/C#线程学习笔记九：async &amp; await入门二9.png" alt="" /></p>
<p>&nbsp; &nbsp;&nbsp;异步方法的控制流：</p>
<p>&nbsp; &nbsp;&nbsp;1）异步执行await表达式的空闲任务。</p>
<p>&nbsp; &nbsp;&nbsp;2）await表达式执行完毕并释放线程，然后<strong>从线程池中申请新的线程</strong>继续执行表达式后续部分。如再遇到await表达式，按相同情况进行处理。</p>
<p>&nbsp; &nbsp;&nbsp;3）到达末尾或遇到return语句时，根据返回类型可以分三种情况：</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&lt;1&gt;void：退出控制流。</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&lt;2&gt;Task：设置Task的属性并退出。</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&lt;3&gt;Task&lt;T&gt;：设置Task的属性和返回值(Result属性)并退出。</p>
<p>&nbsp; &nbsp;&nbsp;4）调用方法将继续执行。需要注意的是：若调用方法需要用到异步方法结果的时候，会暂停等到Task对象的Result属性被赋值后才会继续执行。</p>
<p>&nbsp; &nbsp;&nbsp;【难点】</p>
<p>&nbsp; &nbsp;&nbsp;1）第一次遇到await所返回对象的类型，是同步方法头的返回类型，跟await表达式的返回值没有关系。</p>
<p>&nbsp; &nbsp;&nbsp;2）到达异步方法的末尾或遇到return语句，它并没有真正的返回一个值，而是退出了该方法。</p>
<p><strong>&nbsp; &nbsp; 三、异步方法await表达式</strong></p>
<p>&nbsp; &nbsp; 在大多数的时候，await一般和Task一起使用，用await表达式来指定一个异步执行的任务，以实现更高的灵活性和效率。</p>
<p>&nbsp; &nbsp; 可以用于await运算符的对象要求如下：</p>
<p>&nbsp; &nbsp; 1）有一个GetAwaiter()方法或扩展方法，它返回一个实现了INotifyCompletion接口的awaiter对象（或结构）</p>
<p>&nbsp; &nbsp; 2）返回的awaiter对象（或结构）要求实现如下方法：</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;1&gt;void&nbsp;OnCompleted(Action&nbsp;continuation)</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;2&gt;bool&nbsp;IsCompleted {&nbsp;get&nbsp;; }</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &lt;3&gt;TResult&nbsp;GetResult()&nbsp;//TResult也可以是void类型</p>
<p>&nbsp; &nbsp; 下面简单的介绍一下await运算符是如何实现异步操作的？</p>
<p>&nbsp; &nbsp; 例如，对于如下代码</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;j =&nbsp;await&nbsp;3;</p>
<p>&nbsp; &nbsp;&nbsp;DoContinue(j);</p>
<p>&nbsp; &nbsp; 在编译的时候会被编译器翻译为类似如下流程的代码（注：这个只是功能类似的简化流程示例，实际并非如此）。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;awaiter = 3.GetAwaiter();<br />&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;continuation =&nbsp;new&nbsp;Action(() =&gt;<br />&nbsp;&nbsp;&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;j = awaiter.GetResult();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DoContinue(j);<br />&nbsp;&nbsp;&nbsp;&nbsp;});<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(awaiter.IsCompleted)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;continuation();<br />&nbsp;&nbsp;&nbsp;&nbsp;else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;awaiter.OnCompleted(continuation);</p>
<p>&nbsp; &nbsp; 有了这个基础，我们就可以对一个int型的变量实现await操作了：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('e3d9c983-4fc6-45bb-98ff-7221bc6aacb4')"><img id="code_img_closed_e3d9c983-4fc6-45bb-98ff-7221bc6aacb4" class="code_img_closed" src="./images/C#线程学习笔记九：async &amp; await入门二0.png" alt="" /><img id="code_img_opened_e3d9c983-4fc6-45bb-98ff-7221bc6aacb4" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('e3d9c983-4fc6-45bb-98ff-7221bc6aacb4',event)" src="./images/C#线程学习笔记九：async &amp; await入门二1.png" alt="" />
<div id="cnblogs_code_open_e3d9c983-4fc6-45bb-98ff-7221bc6aacb4" class="cnblogs_code_hide">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> MyAwaiter类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">class</span><span style="color: #000000;"> MyAwaiter : System.Runtime.CompilerServices.INotifyCompletion
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">bool</span> IsCompleted { <span style="color: #0000ff;">get</span> { <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">; } }

        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> OnCompleted(Action continuation)
        {
            Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">OnCompleted</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            ThreadPool.QueueUserWorkItem(_ </span>=&gt;<span style="color: #000000;">
            {
                Thread.Sleep(</span><span style="color: #800080;">1000</span><span style="color: #000000;">);
                result </span>= <span style="color: #800080;">300</span><span style="color: #000000;">;
                continuation();
            });
        }

        </span><span style="color: #0000ff;">int</span><span style="color: #000000;"> result;
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> GetResult()
        {
            Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">GetResult</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> result;
        }
    }

    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> MyAwaiter类扩展
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> MyAwaiterExtend
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> MyAwaiter GetAwaiter(<span style="color: #0000ff;">this</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> i)
        {
            </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> MyAwaiter();
        }
    }

    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {        
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> async &amp; await入门二之await如何实现异步<span style="color: #000000;">
            AwaitAchieveAsync();
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> AwaitAchieveAsync异步方法
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">async</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> AwaitAchieveAsync()
        {
            </span><span style="color: #0000ff;">var</span> j = <span style="color: #0000ff;">await</span> <span style="color: #800080;">3</span><span style="color: #000000;">;
            Console.WriteLine(j);
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C#线程学习笔记九：async &amp; await入门二12.png" alt="" /></p>
<p>&nbsp; &nbsp; 这样我们就能看出await是如何实现call/cc式的异步操作了：</p>
<p>&nbsp; &nbsp; 1）编译器把后续操作封装为一个Action对象continuation，传入awaiter的OnCompleted函数并执行。</p>
<p>&nbsp; &nbsp; 2）awaiter在OnCompleted函数中执行异步操作，并在异步操作完成后（一般是异步调用的回调函数）执行continuation操作。</p>
<p>&nbsp; &nbsp; 3）continuation操作的第一步就是调用awaiter.GetResult()获取异步操作的返回值，并继续执行后续操作。</p>
<p>&nbsp; &nbsp; 看到这里，相信大家对await的机制已经有了简单的认识，也就不难理解为什么AsyncTargetingPack能使得.NET 4.0程序也支持await操作了&mdash;&mdash;该库在</p>
<p>AsyncCompatLibExtensions类中对Task类提供了GetAwaiter扩展函数而已。</p>
<p>&nbsp; &nbsp; 以上是通过创建自己的awaitable类型来演示await实现异步的过程，实际上，你并不需要构建自己的awaitable类型，只需要使用Task类即可。每一个任务都是awaitable</p>
<p>类的实例。</p>
<p>&nbsp; &nbsp; 下面代码演示使用Task.Run()来创建一个Task。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('f2f03c92-00c7-4dac-a42f-d58dfc35c121')"><img id="code_img_closed_f2f03c92-00c7-4dac-a42f-d58dfc35c121" class="code_img_closed" src="./images/C#线程学习笔记九：async &amp; await入门二0.png" alt="" /><img id="code_img_opened_f2f03c92-00c7-4dac-a42f-d58dfc35c121" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('f2f03c92-00c7-4dac-a42f-d58dfc35c121',event)" src="./images/C#线程学习笔记九：async &amp; await入门二1.png" alt="" />
<div id="cnblogs_code_open_f2f03c92-00c7-4dac-a42f-d58dfc35c121" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> async &amp; await入门二之使用Task.Run创建Task
            <span style="color: #0000ff;">var</span> task =<span style="color: #000000;"> GetGuidAsync();
            task.Wait();
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 获取 Guid
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> Guid GetGuid()
        {
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> Guid.NewGuid();
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 异步获取Guid
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">async</span><span style="color: #000000;"> Task GetGuidAsync()
        {
            </span><span style="color: #0000ff;">var</span> myFunc = <span style="color: #0000ff;">new</span> Func&lt;Guid&gt;<span style="color: #000000;">(GetGuid);
            </span><span style="color: #0000ff;">var</span> t1 = <span style="color: #0000ff;">await</span><span style="color: #000000;"> Task.Run(myFunc);
            </span><span style="color: #0000ff;">var</span> t2 = <span style="color: #0000ff;">await</span> Task.Run(<span style="color: #0000ff;">new</span> Func&lt;Guid&gt;<span style="color: #000000;">(GetGuid));
            </span><span style="color: #0000ff;">var</span> t3 = <span style="color: #0000ff;">await</span> Task.Run(() =&gt;<span style="color: #000000;"> GetGuid());
            </span><span style="color: #0000ff;">var</span> t4 = <span style="color: #0000ff;">await</span> Task.Run(() =&gt;<span style="color: #000000;"> Guid.NewGuid());

            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">t1: {t1}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">t2: {t2}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">t3: {t3}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">t4: {t4}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 上面4个Task.Run() 都是采用了Task.Run(Func&lt;TResult&gt; func) 形式来直接或间接调用Guid.NewGuid()。</p>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C#线程学习笔记九：async &amp; await入门二15.png" alt="" /></p>
<p>&nbsp; &nbsp;&nbsp;Task.Run()支持4种不同的委托类型：Action、Func&lt;TResult&gt;、Func&lt;Task&gt; 和 Func&lt;Task&lt;TResult&gt;&gt;</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('64601326-df78-486b-99bd-dcad67cfb005')"><img id="code_img_closed_64601326-df78-486b-99bd-dcad67cfb005" class="code_img_closed" src="./images/C#线程学习笔记九：async &amp; await入门二0.png" alt="" /><img id="code_img_opened_64601326-df78-486b-99bd-dcad67cfb005" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('64601326-df78-486b-99bd-dcad67cfb005',event)" src="./images/C#线程学习笔记九：async &amp; await入门二1.png" alt="" />
<div id="cnblogs_code_open_64601326-df78-486b-99bd-dcad67cfb005" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> async &amp; await入门二之使用Task.Run支持的4种委托类型
            <span style="color: #0000ff;">var</span> task =<span style="color: #000000;"> GetGuidFrom4Async();
            task.Wait();
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 获取 Guid
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> Guid GetGuid()
        {
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> Guid.NewGuid();
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 异步获取Guid(Task.Run支持的4种委托类型)
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">async</span><span style="color: #000000;"> Task GetGuidFrom4Async()
        {
            </span><span style="color: #0000ff;">await</span> Task.Run(() =&gt; { Console.WriteLine(Guid.NewGuid()); });                   <span style="color: #008000;">//</span><span style="color: #008000;">Action</span>
            Console.WriteLine(<span style="color: #0000ff;">await</span> Task.Run(() =&gt; Guid.NewGuid()));                        <span style="color: #008000;">//</span><span style="color: #008000;">Func&lt;TResult&gt;</span>
            <span style="color: #0000ff;">await</span> Task.Run(() =&gt; Task.Run(() =&gt; { Console.WriteLine(Guid.NewGuid()); }));   <span style="color: #008000;">//</span><span style="color: #008000;">Func&lt;Task&gt;</span>
            Console.WriteLine(<span style="color: #0000ff;">await</span> Task.Run(() =&gt; Task.Run(() =&gt; Guid.NewGuid())));        <span style="color: #008000;">//</span><span style="color: #008000;">Func&lt;Task&lt;TResult&gt;&gt;</span>
        }</pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C#线程学习笔记九：async &amp; await入门二18.png" alt="" /></p>
<p>&nbsp; &nbsp; <strong>四、异步方法暂停</strong></p>
<p>&nbsp; &nbsp; Task.Delay() 与Thread.Sleep不同的是，它不会阻塞线程，意味着线程可以继续处理其它工作。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('192a746c-8dd2-4a43-a84d-e4c53c1926dc')"><img id="code_img_closed_192a746c-8dd2-4a43-a84d-e4c53c1926dc" class="code_img_closed" src="./images/C#线程学习笔记九：async &amp; await入门二0.png" alt="" /><img id="code_img_opened_192a746c-8dd2-4a43-a84d-e4c53c1926dc" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('192a746c-8dd2-4a43-a84d-e4c53c1926dc',event)" src="./images/C#线程学习笔记九：async &amp; await入门二1.png" alt="" />
<div id="cnblogs_code_open_192a746c-8dd2-4a43-a84d-e4c53c1926dc" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> async &amp; await入门二之异步方法暂停<span style="color: #000000;">
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">{nameof(Main)} start.</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            DoAsync();
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">{nameof(Main)} end.</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 异步执行
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">async</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> DoAsync()
        {
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">{nameof(DoAsync)} start.</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            </span><span style="color: #0000ff;">await</span> Task.Delay(<span style="color: #800080;">500</span><span style="color: #000000;">);
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">{nameof(DoAsync)} end.</span><span style="color: #800000;">"</span><span style="color: #000000;">);
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C#线程学习笔记九：async &amp; await入门二21.png" alt="" /></p>
<p>&nbsp; &nbsp; 五<strong>、异步方法取消</strong></p>
<p>&nbsp; &nbsp; CancellationToken和CancellationTokenSource这两个类允许你终止执行异步方法。</p>
<p>　1）CancellationToken对象包含任务是否被取消的信息。如果该对象的属性IsCancellationRequested为true，任务需停止操作并返回。该对象操作是不可逆的，且只能</p>
<p>使用（修改）一次，即该对象内的IsCancellationRequested属性被设置后，就不能改动。</p>
<p>　2）CancellationTokenSource可创建CancellationToken对象，调用CancellationTokenSource对象的Cancel方法，会使该对象的CancellationToken属性</p>
<p>IsCancellationRequested设置为true。</p>
<p>&nbsp; &nbsp; 【注意】调用CancellationTokenSource对象的Cancel方法，并不会执行取消操作，而是会将该对象的CancellationToken属性IsCancellationRequested设置为true。</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('5d926925-4e80-4551-8840-120bd55d27a4')"><img id="code_img_closed_5d926925-4e80-4551-8840-120bd55d27a4" class="code_img_closed" src="./images/C#线程学习笔记九：async &amp; await入门二0.png" alt="" /><img id="code_img_opened_5d926925-4e80-4551-8840-120bd55d27a4" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('5d926925-4e80-4551-8840-120bd55d27a4',event)" src="./images/C#线程学习笔记九：async &amp; await入门二1.png" alt="" />
<div id="cnblogs_code_open_5d926925-4e80-4551-8840-120bd55d27a4" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> async &amp; await入门二之异步方法取消<span style="color: #000000;">
            CancellationTokenSource source </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> CancellationTokenSource();
            CancellationToken token </span>=<span style="color: #000000;"> source.Token;

            </span><span style="color: #0000ff;">var</span> task =<span style="color: #000000;"> ExecuteAsync(token);
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">{nameof(token.IsCancellationRequested)}: {token.IsCancellationRequested}</span><span style="color: #800000;">"</span><span style="color: #000000;">);

            Thread.Sleep(</span><span style="color: #800080;">6000</span>); <span style="color: #008000;">//</span><span style="color: #008000;">挂起6秒</span>
            source.Cancel();    <span style="color: #008000;">//</span><span style="color: #008000;">传达取消请求</span>
<span style="color: #000000;">
            task.Wait(token);   </span><span style="color: #008000;">//</span><span style="color: #008000;">等待任务执行完成</span>
            Console.WriteLine($<span style="color: #800000;">"</span><span style="color: #800000;">{nameof(token.IsCancellationRequested)}: {token.IsCancellationRequested}</span><span style="color: #800000;">"</span><span style="color: #000000;">);

            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 异步执行
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="token"&gt;&lt;/param&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">async</span><span style="color: #000000;"> Task ExecuteAsync(CancellationToken token)
        {
            </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (token.IsCancellationRequested)
            {
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;">;
            }

            </span><span style="color: #0000ff;">await</span> Task.Run(() =&gt;<span style="color: #000000;"> CircleOutput(token), token);
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 循环输出
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="token"&gt;&lt;/param&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> CircleOutput(CancellationToken token)
        {
            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">{nameof(CircleOutput)} 方法开始调用：</span><span style="color: #800000;">"</span><span style="color: #000000;">);

            </span><span style="color: #0000ff;">const</span> <span style="color: #0000ff;">int</span> num = <span style="color: #800080;">5</span><span style="color: #000000;">;
            </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">var</span> i = <span style="color: #800080;">0</span>; i &lt; num; i++<span style="color: #000000;">)
            {
                </span><span style="color: #0000ff;">if</span> (token.IsCancellationRequested)  <span style="color: #008000;">//</span><span style="color: #008000;">监控CancellationToken</span>
<span style="color: #000000;">                {
                    </span><span style="color: #0000ff;">return</span><span style="color: #000000;">;
                }

                Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">{i + 1}/{num} 完成</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                Thread.Sleep(</span><span style="color: #800080;">1000</span><span style="color: #000000;">);
            }
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp; &nbsp; 运行结果如下：</p>
<p><img src="./images/C#线程学习笔记九：async &amp; await入门二24.png" alt="" /></p>
<p><strong>&nbsp; &nbsp; 六：异步方法异常处理</strong></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('66e827e4-8259-420e-bec1-b23e68f00353')"><img id="code_img_closed_66e827e4-8259-420e-bec1-b23e68f00353" class="code_img_closed" src="./images/C#线程学习笔记九：async &amp; await入门二0.png" alt="" /><img id="code_img_opened_66e827e4-8259-420e-bec1-b23e68f00353" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('66e827e4-8259-420e-bec1-b23e68f00353',event)" src="./images/C#线程学习笔记九：async &amp; await入门二1.png" alt="" />
<div id="cnblogs_code_open_66e827e4-8259-420e-bec1-b23e68f00353" class="cnblogs_code_hide">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">#region</span> async &amp; await入门二之异步方法异常处理
            <span style="color: #0000ff;">var</span> task =<span style="color: #000000;"> ExceptionAsync();
            task.Wait();

            Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">{nameof(task.Status)}: {task.Status}</span><span style="color: #800000;">"</span>);             <span style="color: #008000;">//</span><span style="color: #008000;">任务状态</span>
            Console.WriteLine($<span style="color: #800000;">"</span><span style="color: #800000;">{nameof(task.IsCompleted)}: {task.IsCompleted}</span><span style="color: #800000;">"</span>);   <span style="color: #008000;">//</span><span style="color: #008000;">任务完成状态标识</span>
            Console.WriteLine($<span style="color: #800000;">"</span><span style="color: #800000;">{nameof(task.IsFaulted)}: {task.IsFaulted}</span><span style="color: #800000;">"</span>);       <span style="color: #008000;">//</span><span style="color: #008000;">任务是否有未处理的异常标识</span>
<span style="color: #000000;">
            Console.Read();
            </span><span style="color: #0000ff;">#endregion</span><span style="color: #000000;">
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 异常操作
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">async</span><span style="color: #000000;"> Task ExceptionAsync()
        {
            </span><span style="color: #0000ff;">try</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">await</span> Task.Run(() =&gt; { <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> Exception(); });
            }
            </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (Exception)
            {
                Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">{nameof(ExceptionAsync)} 出现异常。</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }
        }
    }</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p><strong><img src="./images/C#线程学习笔记九：async &amp; await入门二27.png" alt="" /></strong></p>
<p>&nbsp; &nbsp; 后记：一、四、五、六也算是<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/atomy/p/12033461.html">C#线程学习笔记七：Task详细用法</a>的一些补充，其它的用法与笔记七的用法差不多的，这里就不再赘述了。</p>
<p>&nbsp; &nbsp; 参考自：</p>
<p>&nbsp; &nbsp;&nbsp;<a href="https://www.cnblogs.com/liqingwen/p/5844095.html">https://www.cnblogs.com/liqingwen/p/5844095.html</a></p>
<p>&nbsp; &nbsp;&nbsp;<a href="https://www.cnblogs.com/TianFang/archive/2012/09/21/2696769.html">https://www.cnblogs.com/TianFang/archive/2012/09/21/2696769.html</a></p>
<p>&nbsp; &nbsp;&nbsp;<a href="https://www.cnblogs.com/liqingwen/p/5866241.html">https://www.cnblogs.com/liqingwen/p/5866241.html</a></p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>