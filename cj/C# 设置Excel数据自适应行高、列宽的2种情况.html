<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修C# 设置Excel数据自适应行高、列宽的2种情况' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>C# 设置Excel数据自适应行高、列宽的2种情况</center></div><div class='banquan'>原文出处:本文由博客园博主E-iceblue提供。<br/>
原文连接:https://www.cnblogs.com/Yesi/p/10716963.html</div><br>
    <p>Excel表格中，由于各种数据的复杂性，可能存在单元格中的数据字号大小、数据内容长度不一而出现，列宽过宽、过窄或者行高过大、过小的问题。常见的解决方法是调整行高、列宽。在Microsoft Excel中，在单元格格式设置中可手动设置自适应行高或自适应列宽，但通过代码，我们可以通过方法AutoFitColumns()或者AutoFitRows()来设置指定数据范围或整个工作表的自适应行高、列宽。这里设置自适应分以下2种情况来进行：</p>
<p>1. 固定数据，设置行高、列宽自适应数据</p>
<p>2. 固定行高、列宽，设置数据自适应行高、列宽（即缩小单元格数据字体大小适应单元格）</p>
<p><strong>使用工具</strong>：<a href="https://www.e-iceblue.cn/Introduce/Free-Spire-XLS-NET.html">Free Spire.XLS for .NET（免费版）</a></p>
<p><strong><em>注：</em></strong>注意在下载安装后，添加引用Spire.Xls.dll文件，如下图：</p>
<p><img src="./images/C# 设置Excel数据自适应行高、列宽的2种情况0.png" alt="" /></p>
<h2>&nbsp;</h2>
<h2>【示例1】固定数据，设置行高、列宽自适应数据</h2>
<p>&nbsp;Step 1: 加载工作簿</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">创建一个Workbook类的对象，并加载测试文档</span>
Workbook workbook = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Workbook();
workbook.LoadFromFile(</span><span style="color: #800000;">"</span><span style="color: #800000;">sample.xlsx</span><span style="color: #800000;">"</span>);</pre>
</div>
<p>Step 2: 获取指定工作表</p>
<div class="cnblogs_code">
<pre><code>Worksheet worksheet = workbook.Worksheets[<span style="color: #800080;">0</span>];</pre>
</div>
<p>Step 3:设置自适应</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">设置列宽、行高为自适应（应用于指定数据范围）</span>
worksheet.AllocatedRange[<span style="color: #800000;">"</span><span style="color: #800000;">A1:F15</span><span style="color: #800000;">"</span><span style="color: #000000;">].AutoFitColumns();
worksheet.AllocatedRange[</span><span style="color: #800000;">"</span><span style="color: #800000;">A1:F15</span><span style="color: #800000;">"</span><span style="color: #000000;">].AutoFitRows();

</span><span style="color: #808080;">///</span><span style="color: #008000;">/设置列宽、行高为自适应（应用于整个工作表）</span>
<span style="color: #008000;">//</span><span style="color: #008000;">worksheet.AllocatedRange.AutoFitColumns();
</span><span style="color: #008000;">//</span><span style="color: #008000;">worksheet.AllocatedRange.AutoFitRows();</span></pre>
</div>
<p>Step 4:保存文档</p>
<div class="cnblogs_code">
<pre><code>workbook.SaveToFile(<span style="color: #800000;">"</span><span style="color: #800000;">result.xlsx</span><span style="color: #800000;">"</span>, FileFormat.Version2010);</pre>
</div>
<p>设置效果：</p>
<p><img src="./images/C# 设置Excel数据自适应行高、列宽的2种情况1.png" alt="" /></p>
<p><span style="color: #339966; font-size: 16px;"><strong>全部代码：</strong></span></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('4f8af432-0b88-423a-bc57-9ab8f9cc0237')"><img id="code_img_closed_4f8af432-0b88-423a-bc57-9ab8f9cc0237" class="code_img_closed" src="./images/C# 设置Excel数据自适应行高、列宽的2种情况2.png" alt="" /><img id="code_img_opened_4f8af432-0b88-423a-bc57-9ab8f9cc0237" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('4f8af432-0b88-423a-bc57-9ab8f9cc0237',event)" src="./images/C# 设置Excel数据自适应行高、列宽的2种情况3.png" alt="" />
<div id="cnblogs_code_open_4f8af432-0b88-423a-bc57-9ab8f9cc0237" class="cnblogs_code_hide">
<pre><code><span style="color: #0000ff;">using</span><span style="color: #000000;"> Spire.Xls;

</span><span style="color: #0000ff;">namespace</span><span style="color: #000000;"> AutoFit_XLS
{
    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">创建一个Workbook类的对象，并加载测试文档</span>
            Workbook workbook = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Workbook();
            workbook.LoadFromFile(</span><span style="color: #800000;">"</span><span style="color: #800000;">sample.xlsx</span><span style="color: #800000;">"</span><span style="color: #000000;">);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">获取工作表</span>
            Worksheet worksheet = workbook.Worksheets[<span style="color: #800080;">0</span><span style="color: #000000;">];

            </span><span style="color: #008000;">//</span><span style="color: #008000;">设置列宽、行高为自适应（应用于指定数据范围）</span>
            worksheet.AllocatedRange[<span style="color: #800000;">"</span><span style="color: #800000;">A1:F15</span><span style="color: #800000;">"</span><span style="color: #000000;">].AutoFitColumns();
            worksheet.AllocatedRange[</span><span style="color: #800000;">"</span><span style="color: #800000;">A1:F15</span><span style="color: #800000;">"</span><span style="color: #000000;">].AutoFitRows();

            </span><span style="color: #808080;">///</span><span style="color: #008000;">/设置列宽、行高为自适应（应用于整个工作表）</span>
            <span style="color: #008000;">//</span><span style="color: #008000;">worksheet.AllocatedRange.AutoFitColumns();
            </span><span style="color: #008000;">//</span><span style="color: #008000;">worksheet.AllocatedRange.AutoFitRows();

            </span><span style="color: #008000;">//</span><span style="color: #008000;">保存文档</span>
            workbook.SaveToFile(<span style="color: #800000;">"</span><span style="color: #800000;">result.xlsx</span><span style="color: #800000;">"</span><span style="color: #000000;">, FileFormat.Version2010);
            System.Diagnostics.Process.Start(</span><span style="color: #800000;">"</span><span style="color: #800000;">result.xlsx</span><span style="color: #800000;">"</span><span style="color: #000000;">);
        }
    }
}</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp;</p>
<h2>【示例2】固定行高、列宽，设置数据自适应行高、列宽</h2>
<p>Step 1:加载工作簿</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">实例化Workbook类的对象，并加载测试文档</span>
Workbook workbook = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Workbook();
workbook.LoadFromFile(</span><span style="color: #800000;">"</span><span style="color: #800000;">test.xlsx</span><span style="color: #800000;">"</span>);</pre>
</div>
<p>Step 2:获取指定工作表</p>
<div class="cnblogs_code">
<pre><code>Worksheet sheet = workbook.Worksheets[<span style="color: #800080;">0</span>];</pre>
</div>
<p>Step 3: 获取指定数据范围</p>
<div class="cnblogs_code">
<pre><code>CellRange cell = sheet.Range[<span style="color: #800000;">"</span><span style="color: #800000;">A1:C1</span><span style="color: #800000;">"</span>];</pre>
</div>
<p>Step 4: 缩小单元格字体以适应列宽</p>
<div class="cnblogs_code">
<pre><code>CellStyle style =<span style="color: #000000;"> cell.Style;
style.ShrinkToFit </span>= <span style="color: #0000ff;">true</span>;</pre>
</div>
<p>Step 5: 保存文档</p>
<div class="cnblogs_code">
<pre><code>workbook.SaveToFile(<span style="color: #800000;">"</span><span style="color: #800000;">result.xlsx</span><span style="color: #800000;">"</span>, ExcelVersion.Version2013);</pre>
</div>
<p>&nbsp;</p>
<p><span style="font-size: 15px;"><strong>设置结果：</strong></span></p>
<p><img src="./images/C# 设置Excel数据自适应行高、列宽的2种情况4.png" alt="" /></p>
<p><span style="font-size: 16px; color: #339966;"><strong>全部代码：</strong></span></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('1ef443e4-94d7-4332-a43e-3869a8445d4f')"><img id="code_img_closed_1ef443e4-94d7-4332-a43e-3869a8445d4f" class="code_img_closed" src="./images/C# 设置Excel数据自适应行高、列宽的2种情况2.png" alt="" /><img id="code_img_opened_1ef443e4-94d7-4332-a43e-3869a8445d4f" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('1ef443e4-94d7-4332-a43e-3869a8445d4f',event)" src="./images/C# 设置Excel数据自适应行高、列宽的2种情况3.png" alt="" />
<div id="cnblogs_code_open_1ef443e4-94d7-4332-a43e-3869a8445d4f" class="cnblogs_code_hide">
<pre><code><span style="color: #0000ff;">using</span><span style="color: #000000;"> Spire.Xls;

</span><span style="color: #0000ff;">namespace</span><span style="color: #000000;"> ShrinkTextToFitCell_XLS
{
    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">实例化Workbook类的对象，并加载测试文档</span>
            Workbook workbook = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Workbook();
            workbook.LoadFromFile(</span><span style="color: #800000;">"</span><span style="color: #800000;">test.xlsx</span><span style="color: #800000;">"</span><span style="color: #000000;">);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">获取第一个工作表</span>
            Worksheet sheet = workbook.Worksheets[<span style="color: #800080;">0</span><span style="color: #000000;">];

            </span><span style="color: #008000;">//</span><span style="color: #008000;">获取指定数据范围</span>
            CellRange cell = sheet.Range[<span style="color: #800000;">"</span><span style="color: #800000;">A1:C1</span><span style="color: #800000;">"</span><span style="color: #000000;">];

            </span><span style="color: #008000;">//</span><span style="color: #008000;">设置单元格样式（数据缩小以适应单元格）</span>
            CellStyle style =<span style="color: #000000;"> cell.Style;
            style.ShrinkToFit </span>= <span style="color: #0000ff;">true</span><span style="color: #000000;">;

            </span><span style="color: #008000;">//</span><span style="color: #008000;">保存文档</span>
            workbook.SaveToFile(<span style="color: #800000;">"</span><span style="color: #800000;">result.xlsx</span><span style="color: #800000;">"</span><span style="color: #000000;">, ExcelVersion.Version2013);
            System.Diagnostics.Process.Start(</span><span style="color: #800000;">"</span><span style="color: #800000;">result.xlsx</span><span style="color: #800000;">"</span><span style="color: #000000;">);
        }
    }
}</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp;</p>
<p>（本文完）</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>