<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修C#工具类MySqlHelper，基于MySql.Data.MySqlClient封装' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>C#工具类MySqlHelper，基于MySql.Data.MySqlClient封装</center></div><div class='banquan'>原文出处:本文由博客园博主abcd123456789提供。<br/>
原文连接:https://www.cnblogs.com/Jun168/p/11395347.html</div><br>
    <p>源码：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008080;">  1</span> <span style="color: #0000ff;">using</span><span style="color: #000000;"> System;
</span><span style="color: #008080;">  2</span> <span style="color: #0000ff;">using</span><span style="color: #000000;"> System.Collections.Generic;
</span><span style="color: #008080;">  3</span> <span style="color: #0000ff;">using</span><span style="color: #000000;"> System.Linq;
</span><span style="color: #008080;">  4</span> <span style="color: #0000ff;">using</span><span style="color: #000000;"> System.Text;
</span><span style="color: #008080;">  5</span> <span style="color: #0000ff;">using</span><span style="color: #000000;"> System.Threading.Tasks;
</span><span style="color: #008080;">  6</span> <span style="color: #0000ff;">using</span><span style="color: #000000;"> System.Data;
</span><span style="color: #008080;">  7</span> <span style="color: #0000ff;">using</span><span style="color: #000000;"> MySql.Data.MySqlClient;
</span><span style="color: #008080;">  8</span> 
<span style="color: #008080;">  9</span> 
<span style="color: #008080;"> 10</span> <span style="color: #0000ff;">namespace</span><span style="color: #000000;"> Fly.Util.DataBase
</span><span style="color: #008080;"> 11</span> <span style="color: #000000;">{
</span><span style="color: #008080;"> 12</span>     <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
<span style="color: #008080;"> 13</span>     <span style="color: #808080;">///</span><span style="color: #008000;"> MySql数据库操作类
</span><span style="color: #008080;"> 14</span>     <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
<span style="color: #008080;"> 15</span>     <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> MySqlHelper
</span><span style="color: #008080;"> 16</span> <span style="color: #000000;">    {
</span><span style="color: #008080;"> 17</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>  
<span style="color: #008080;"> 18</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 执行数据库非查询操作,返回受影响的行数  
</span><span style="color: #008080;"> 19</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>  
<span style="color: #008080;"> 20</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="connectionString"&gt;</span><span style="color: #008000;">数据库连接字符串</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 21</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdType"&gt;</span><span style="color: #008000;">命令的类型</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 22</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdText"&gt;</span><span style="color: #008000;">MySql存储过程名称或PL/SQL命令</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;"> 23</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdParms"&gt;</span><span style="color: #008000;">命令参数集合</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;"> 24</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">当前操作影响的数据行数</span><span style="color: #808080;">&lt;/returns&gt;</span>  
<span style="color: #008080;"> 25</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">int</span> ExecuteNonQuery(<span style="color: #0000ff;">string</span> connectionString, CommandType cmdType, <span style="color: #0000ff;">string</span> cmdText, <span style="color: #0000ff;">params</span><span style="color: #000000;"> MySqlParameter[] cmdParms)
</span><span style="color: #008080;"> 26</span> <span style="color: #000000;">        {
</span><span style="color: #008080;"> 27</span>             MySqlCommand cmd = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MySqlCommand();
</span><span style="color: #008080;"> 28</span>             <span style="color: #0000ff;">using</span> (MySqlConnection conn = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MySqlConnection(connectionString))
</span><span style="color: #008080;"> 29</span> <span style="color: #000000;">            {
</span><span style="color: #008080;"> 30</span>                 PrepareCommand(cmd, conn, <span style="color: #0000ff;">null</span><span style="color: #000000;">, cmdType, cmdText, cmdParms);
</span><span style="color: #008080;"> 31</span>                 <span style="color: #0000ff;">int</span> val =<span style="color: #000000;"> cmd.ExecuteNonQuery();
</span><span style="color: #008080;"> 32</span> <span style="color: #000000;">                cmd.Parameters.Clear();
</span><span style="color: #008080;"> 33</span>                 <span style="color: #0000ff;">return</span><span style="color: #000000;"> val;
</span><span style="color: #008080;"> 34</span> <span style="color: #000000;">            }
</span><span style="color: #008080;"> 35</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 36</span> 
<span style="color: #008080;"> 37</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>  
<span style="color: #008080;"> 38</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 执行数据库事务非查询操作,返回受影响的行数  
</span><span style="color: #008080;"> 39</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>  
<span style="color: #008080;"> 40</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="transaction"&gt;</span><span style="color: #008000;">数据库事务对象</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;"> 41</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdType"&gt;</span><span style="color: #008000;">Command类型</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;"> 42</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdText"&gt;</span><span style="color: #008000;">MySql存储过程名称或PL/SQL命令</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;"> 43</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdParms"&gt;</span><span style="color: #008000;">命令参数集合</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;"> 44</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">当前事务操作影响的数据行数</span><span style="color: #808080;">&lt;/returns&gt;</span>  
<span style="color: #008080;"> 45</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">int</span> ExecuteNonQuery(MySqlTransaction trans, CommandType cmdType, <span style="color: #0000ff;">string</span> cmdText, <span style="color: #0000ff;">params</span><span style="color: #000000;"> MySqlParameter[] cmdParms)
</span><span style="color: #008080;"> 46</span> <span style="color: #000000;">        {
</span><span style="color: #008080;"> 47</span>             MySqlCommand cmd = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MySqlCommand();
</span><span style="color: #008080;"> 48</span> <span style="color: #000000;">            PrepareCommand(cmd, trans.Connection, trans, cmdType, cmdText, cmdParms);
</span><span style="color: #008080;"> 49</span>             <span style="color: #0000ff;">int</span> val =<span style="color: #000000;"> cmd.ExecuteNonQuery();
</span><span style="color: #008080;"> 50</span> <span style="color: #000000;">            cmd.Parameters.Clear();
</span><span style="color: #008080;"> 51</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> val;
</span><span style="color: #008080;"> 52</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 53</span> 
<span style="color: #008080;"> 54</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>  
<span style="color: #008080;"> 55</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 执行数据库非查询操作,返回受影响的行数  
</span><span style="color: #008080;"> 56</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>  
<span style="color: #008080;"> 57</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="connection"&gt;</span><span style="color: #008000;">MySql数据库连接对象</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;"> 58</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdType"&gt;</span><span style="color: #008000;">Command类型</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;"> 59</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdText"&gt;</span><span style="color: #008000;">MySql存储过程名称或PL/SQL命令</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;"> 60</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdParms"&gt;</span><span style="color: #008000;">命令参数集合</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;"> 61</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">当前操作影响的数据行数</span><span style="color: #808080;">&lt;/returns&gt;</span>  
<span style="color: #008080;"> 62</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">int</span> ExecuteNonQuery(MySqlConnection connection, CommandType cmdType, <span style="color: #0000ff;">string</span> cmdText, <span style="color: #0000ff;">params</span><span style="color: #000000;"> MySqlParameter[] cmdParms)
</span><span style="color: #008080;"> 63</span> <span style="color: #000000;">        {
</span><span style="color: #008080;"> 64</span>             <span style="color: #0000ff;">if</span> (connection == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;"> 65</span>                 <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> ArgumentNullException(<span style="color: #800000;">"</span><span style="color: #800000;">当前数据库连接不存在</span><span style="color: #800000;">"</span><span style="color: #000000;">);
</span><span style="color: #008080;"> 66</span>             MySqlCommand cmd = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MySqlCommand();
</span><span style="color: #008080;"> 67</span>             PrepareCommand(cmd, connection, <span style="color: #0000ff;">null</span><span style="color: #000000;">, cmdType, cmdText, cmdParms);
</span><span style="color: #008080;"> 68</span>             <span style="color: #0000ff;">int</span> val =<span style="color: #000000;"> cmd.ExecuteNonQuery();
</span><span style="color: #008080;"> 69</span> <span style="color: #000000;">            cmd.Parameters.Clear();
</span><span style="color: #008080;"> 70</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> val;
</span><span style="color: #008080;"> 71</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 72</span> 
<span style="color: #008080;"> 73</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>  
<span style="color: #008080;"> 74</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 执行数据库查询操作,返回MySqlDataReader类型的内存结果集  
</span><span style="color: #008080;"> 75</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>  
<span style="color: #008080;"> 76</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="connectionString"&gt;</span><span style="color: #008000;">数据库连接字符串</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 77</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdType"&gt;</span><span style="color: #008000;">命令的类型</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 78</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdText"&gt;</span><span style="color: #008000;">MySql存储过程名称或PL/SQL命令</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;"> 79</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdParms"&gt;</span><span style="color: #008000;">命令参数集合</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;"> 80</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">当前查询操作返回的MySqlDataReader类型的内存结果集</span><span style="color: #808080;">&lt;/returns&gt;</span>  
<span style="color: #008080;"> 81</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> MySqlDataReader ExecuteReader(<span style="color: #0000ff;">string</span> connectionString, CommandType cmdType, <span style="color: #0000ff;">string</span> cmdText, <span style="color: #0000ff;">params</span><span style="color: #000000;"> MySqlParameter[] cmdParms)
</span><span style="color: #008080;"> 82</span> <span style="color: #000000;">        {
</span><span style="color: #008080;"> 83</span>             MySqlCommand cmd = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MySqlCommand();
</span><span style="color: #008080;"> 84</span>             MySqlConnection conn = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MySqlConnection(connectionString);
</span><span style="color: #008080;"> 85</span>             <span style="color: #0000ff;">try</span>
<span style="color: #008080;"> 86</span> <span style="color: #000000;">            {
</span><span style="color: #008080;"> 87</span>                 PrepareCommand(cmd, conn, <span style="color: #0000ff;">null</span><span style="color: #000000;">, cmdType, cmdText, cmdParms);
</span><span style="color: #008080;"> 88</span>                 MySqlDataReader reader =<span style="color: #000000;"> cmd.ExecuteReader(CommandBehavior.CloseConnection);
</span><span style="color: #008080;"> 89</span> <span style="color: #000000;">                cmd.Parameters.Clear();
</span><span style="color: #008080;"> 90</span>                 <span style="color: #0000ff;">return</span><span style="color: #000000;"> reader;
</span><span style="color: #008080;"> 91</span> <span style="color: #000000;">            }
</span><span style="color: #008080;"> 92</span>             <span style="color: #0000ff;">catch</span>
<span style="color: #008080;"> 93</span> <span style="color: #000000;">            {
</span><span style="color: #008080;"> 94</span> <span style="color: #000000;">                cmd.Dispose();
</span><span style="color: #008080;"> 95</span> <span style="color: #000000;">                conn.Close();
</span><span style="color: #008080;"> 96</span>                 <span style="color: #0000ff;">throw</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 97</span> <span style="color: #000000;">            }
</span><span style="color: #008080;"> 98</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 99</span> 
<span style="color: #008080;">100</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>  
<span style="color: #008080;">101</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 执行数据库查询操作,返回DataSet类型的结果集  
</span><span style="color: #008080;">102</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>  
<span style="color: #008080;">103</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="connectionString"&gt;</span><span style="color: #008000;">数据库连接字符串</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">104</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdType"&gt;</span><span style="color: #008000;">命令的类型</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">105</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdText"&gt;</span><span style="color: #008000;">MySql存储过程名称或PL/SQL命令</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;">106</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdParms"&gt;</span><span style="color: #008000;">命令参数集合</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;">107</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">当前查询操作返回的DataSet类型的结果集</span><span style="color: #808080;">&lt;/returns&gt;</span>  
<span style="color: #008080;">108</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> DataSet ExecuteDataSet(<span style="color: #0000ff;">string</span> connectionString, CommandType cmdType, <span style="color: #0000ff;">string</span> cmdText, <span style="color: #0000ff;">params</span><span style="color: #000000;"> MySqlParameter[] cmdParms)
</span><span style="color: #008080;">109</span> <span style="color: #000000;">        {
</span><span style="color: #008080;">110</span>             MySqlCommand cmd = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MySqlCommand();
</span><span style="color: #008080;">111</span>             MySqlConnection conn = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MySqlConnection(connectionString);
</span><span style="color: #008080;">112</span>             DataSet ds = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">113</span>             <span style="color: #0000ff;">try</span>
<span style="color: #008080;">114</span> <span style="color: #000000;">            {
</span><span style="color: #008080;">115</span>                 PrepareCommand(cmd, conn, <span style="color: #0000ff;">null</span><span style="color: #000000;">, cmdType, cmdText, cmdParms);
</span><span style="color: #008080;">116</span>                 MySqlDataAdapter adapter = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MySqlDataAdapter();
</span><span style="color: #008080;">117</span>                 adapter.SelectCommand =<span style="color: #000000;"> cmd;
</span><span style="color: #008080;">118</span>                 ds = <span style="color: #0000ff;">new</span><span style="color: #000000;"> DataSet();
</span><span style="color: #008080;">119</span> <span style="color: #000000;">                adapter.Fill(ds);
</span><span style="color: #008080;">120</span> <span style="color: #000000;">                cmd.Parameters.Clear();
</span><span style="color: #008080;">121</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">122</span>             <span style="color: #0000ff;">catch</span>
<span style="color: #008080;">123</span> <span style="color: #000000;">            {
</span><span style="color: #008080;">124</span>                 <span style="color: #0000ff;">throw</span><span style="color: #000000;">;
</span><span style="color: #008080;">125</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">126</span>             <span style="color: #0000ff;">finally</span>
<span style="color: #008080;">127</span> <span style="color: #000000;">            {
</span><span style="color: #008080;">128</span> <span style="color: #000000;">                cmd.Dispose();
</span><span style="color: #008080;">129</span> <span style="color: #000000;">                conn.Close();
</span><span style="color: #008080;">130</span> <span style="color: #000000;">                conn.Dispose();
</span><span style="color: #008080;">131</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">132</span> 
<span style="color: #008080;">133</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> ds;
</span><span style="color: #008080;">134</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">135</span> 
<span style="color: #008080;">136</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>  
<span style="color: #008080;">137</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 执行数据库查询操作,返回DataTable类型的结果集  
</span><span style="color: #008080;">138</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>  
<span style="color: #008080;">139</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="connectionString"&gt;</span><span style="color: #008000;">数据库连接字符串</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">140</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdType"&gt;</span><span style="color: #008000;">命令的类型</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">141</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdText"&gt;</span><span style="color: #008000;">MySql存储过程名称或PL/SQL命令</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;">142</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdParms"&gt;</span><span style="color: #008000;">命令参数集合</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;">143</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">当前查询操作返回的DataTable类型的结果集</span><span style="color: #808080;">&lt;/returns&gt;</span>  
<span style="color: #008080;">144</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> DataTable ExecuteDataTable(<span style="color: #0000ff;">string</span> connectionString, CommandType cmdType, <span style="color: #0000ff;">string</span> cmdText, <span style="color: #0000ff;">params</span><span style="color: #000000;"> MySqlParameter[] cmdParms)
</span><span style="color: #008080;">145</span> <span style="color: #000000;">        {
</span><span style="color: #008080;">146</span>             MySqlCommand cmd = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MySqlCommand();
</span><span style="color: #008080;">147</span>             MySqlConnection conn = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MySqlConnection(connectionString);
</span><span style="color: #008080;">148</span>             DataTable dt = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">149</span> 
<span style="color: #008080;">150</span>             <span style="color: #0000ff;">try</span>
<span style="color: #008080;">151</span> <span style="color: #000000;">            {
</span><span style="color: #008080;">152</span>                 PrepareCommand(cmd, conn, <span style="color: #0000ff;">null</span><span style="color: #000000;">, cmdType, cmdText, cmdParms);
</span><span style="color: #008080;">153</span>                 MySqlDataAdapter adapter = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MySqlDataAdapter();
</span><span style="color: #008080;">154</span>                 adapter.SelectCommand =<span style="color: #000000;"> cmd;
</span><span style="color: #008080;">155</span>                 dt = <span style="color: #0000ff;">new</span><span style="color: #000000;"> DataTable();
</span><span style="color: #008080;">156</span> <span style="color: #000000;">                adapter.Fill(dt);
</span><span style="color: #008080;">157</span> <span style="color: #000000;">                cmd.Parameters.Clear();
</span><span style="color: #008080;">158</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">159</span>             <span style="color: #0000ff;">catch</span>
<span style="color: #008080;">160</span> <span style="color: #000000;">            {
</span><span style="color: #008080;">161</span>                 <span style="color: #0000ff;">throw</span><span style="color: #000000;">;
</span><span style="color: #008080;">162</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">163</span>             <span style="color: #0000ff;">finally</span>
<span style="color: #008080;">164</span> <span style="color: #000000;">            {
</span><span style="color: #008080;">165</span> <span style="color: #000000;">                cmd.Dispose();
</span><span style="color: #008080;">166</span> <span style="color: #000000;">                conn.Close();
</span><span style="color: #008080;">167</span> <span style="color: #000000;">                conn.Dispose();
</span><span style="color: #008080;">168</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">169</span> 
<span style="color: #008080;">170</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> dt;
</span><span style="color: #008080;">171</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">172</span> 
<span style="color: #008080;">173</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>  
<span style="color: #008080;">174</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 执行数据库查询操作,返回结果集中位于第一行第一列的Object类型的值  
</span><span style="color: #008080;">175</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>  
<span style="color: #008080;">176</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="connectionString"&gt;</span><span style="color: #008000;">数据库连接字符串</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">177</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdType"&gt;</span><span style="color: #008000;">命令的类型</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">178</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdText"&gt;</span><span style="color: #008000;">MySql存储过程名称或PL/SQL命令</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;">179</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdParms"&gt;</span><span style="color: #008000;">命令参数集合</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;">180</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">当前查询操作返回的结果集中位于第一行第一列的Object类型的值</span><span style="color: #808080;">&lt;/returns&gt;</span>  
<span style="color: #008080;">181</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">object</span> ExecuteScalar(<span style="color: #0000ff;">string</span> connectionString, CommandType cmdType, <span style="color: #0000ff;">string</span> cmdText, <span style="color: #0000ff;">params</span><span style="color: #000000;"> MySqlParameter[] cmdParms)
</span><span style="color: #008080;">182</span> <span style="color: #000000;">        {
</span><span style="color: #008080;">183</span>             MySqlCommand cmd = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MySqlCommand();
</span><span style="color: #008080;">184</span>             MySqlConnection conn = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MySqlConnection(connectionString);
</span><span style="color: #008080;">185</span>             <span style="color: #0000ff;">object</span> result = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">186</span>             <span style="color: #0000ff;">try</span>
<span style="color: #008080;">187</span> <span style="color: #000000;">            {
</span><span style="color: #008080;">188</span>                 PrepareCommand(cmd, conn, <span style="color: #0000ff;">null</span><span style="color: #000000;">, cmdType, cmdText, cmdParms);
</span><span style="color: #008080;">189</span>                 result =<span style="color: #000000;"> cmd.ExecuteScalar();
</span><span style="color: #008080;">190</span> <span style="color: #000000;">                cmd.Parameters.Clear();
</span><span style="color: #008080;">191</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">192</span>             <span style="color: #0000ff;">catch</span>
<span style="color: #008080;">193</span> <span style="color: #000000;">            {
</span><span style="color: #008080;">194</span>                 <span style="color: #0000ff;">throw</span><span style="color: #000000;">;
</span><span style="color: #008080;">195</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">196</span>             <span style="color: #0000ff;">finally</span>
<span style="color: #008080;">197</span> <span style="color: #000000;">            {
</span><span style="color: #008080;">198</span> <span style="color: #000000;">                cmd.Dispose();
</span><span style="color: #008080;">199</span> <span style="color: #000000;">                conn.Close();
</span><span style="color: #008080;">200</span> <span style="color: #000000;">                conn.Dispose();
</span><span style="color: #008080;">201</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">202</span> 
<span style="color: #008080;">203</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> result;
</span><span style="color: #008080;">204</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">205</span> 
<span style="color: #008080;">206</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>  
<span style="color: #008080;">207</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 执行数据库事务查询操作,返回结果集中位于第一行第一列的Object类型的值  
</span><span style="color: #008080;">208</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>  
<span style="color: #008080;">209</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="trans"&gt;</span><span style="color: #008000;">一个已存在的数据库事务对象</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;">210</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="commandType"&gt;</span><span style="color: #008000;">命令类型</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;">211</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="commandText"&gt;</span><span style="color: #008000;">MySql存储过程名称或PL/SQL命令</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;">212</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdParms"&gt;</span><span style="color: #008000;">命令参数集合</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;">213</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">当前事务查询操作返回的结果集中位于第一行第一列的Object类型的值</span><span style="color: #808080;">&lt;/returns&gt;</span>  
<span style="color: #008080;">214</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">object</span> ExecuteScalar(MySqlTransaction trans, CommandType cmdType, <span style="color: #0000ff;">string</span> cmdText, <span style="color: #0000ff;">params</span><span style="color: #000000;"> MySqlParameter[] cmdParms)
</span><span style="color: #008080;">215</span> <span style="color: #000000;">        {
</span><span style="color: #008080;">216</span>             <span style="color: #0000ff;">if</span> (trans == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;">217</span>                 <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> ArgumentNullException(<span style="color: #800000;">"</span><span style="color: #800000;">当前数据库事务不存在</span><span style="color: #800000;">"</span><span style="color: #000000;">);
</span><span style="color: #008080;">218</span>             MySqlConnection conn =<span style="color: #000000;"> trans.Connection;
</span><span style="color: #008080;">219</span>             <span style="color: #0000ff;">if</span> (conn == <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;">220</span>                 <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> ArgumentException(<span style="color: #800000;">"</span><span style="color: #800000;">当前事务所在的数据库连接不存在</span><span style="color: #800000;">"</span><span style="color: #000000;">);
</span><span style="color: #008080;">221</span> 
<span style="color: #008080;">222</span>             MySqlCommand cmd = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MySqlCommand();
</span><span style="color: #008080;">223</span>             <span style="color: #0000ff;">object</span> result = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">224</span> 
<span style="color: #008080;">225</span>             <span style="color: #0000ff;">try</span>
<span style="color: #008080;">226</span> <span style="color: #000000;">            {
</span><span style="color: #008080;">227</span> <span style="color: #000000;">                PrepareCommand(cmd, conn, trans, cmdType, cmdText, cmdParms);
</span><span style="color: #008080;">228</span>                 result =<span style="color: #000000;"> cmd.ExecuteScalar();
</span><span style="color: #008080;">229</span> <span style="color: #000000;">                cmd.Parameters.Clear();
</span><span style="color: #008080;">230</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">231</span>             <span style="color: #0000ff;">catch</span>
<span style="color: #008080;">232</span> <span style="color: #000000;">            {
</span><span style="color: #008080;">233</span>                 <span style="color: #0000ff;">throw</span><span style="color: #000000;">;
</span><span style="color: #008080;">234</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">235</span>             <span style="color: #0000ff;">finally</span>
<span style="color: #008080;">236</span> <span style="color: #000000;">            {
</span><span style="color: #008080;">237</span> <span style="color: #000000;">                trans.Dispose();
</span><span style="color: #008080;">238</span> <span style="color: #000000;">                cmd.Dispose();
</span><span style="color: #008080;">239</span> <span style="color: #000000;">                conn.Close();
</span><span style="color: #008080;">240</span> <span style="color: #000000;">                conn.Dispose();
</span><span style="color: #008080;">241</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">242</span> 
<span style="color: #008080;">243</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> result;
</span><span style="color: #008080;">244</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">245</span> 
<span style="color: #008080;">246</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>  
<span style="color: #008080;">247</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 执行数据库查询操作,返回结果集中位于第一行第一列的Object类型的值  
</span><span style="color: #008080;">248</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>  
<span style="color: #008080;">249</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="conn"&gt;</span><span style="color: #008000;">数据库连接对象</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;">250</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdType"&gt;</span><span style="color: #008000;">Command类型</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;">251</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdText"&gt;</span><span style="color: #008000;">MySql存储过程名称或PL/SQL命令</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;">252</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdParms"&gt;</span><span style="color: #008000;">命令参数集合</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;">253</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">当前查询操作返回的结果集中位于第一行第一列的Object类型的值</span><span style="color: #808080;">&lt;/returns&gt;</span>  
<span style="color: #008080;">254</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">object</span> ExecuteScalar(MySqlConnection conn, CommandType cmdType, <span style="color: #0000ff;">string</span> cmdText, <span style="color: #0000ff;">params</span><span style="color: #000000;"> MySqlParameter[] cmdParms)
</span><span style="color: #008080;">255</span> <span style="color: #000000;">        {
</span><span style="color: #008080;">256</span>             <span style="color: #0000ff;">if</span> (conn == <span style="color: #0000ff;">null</span>) <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> ArgumentException(<span style="color: #800000;">"</span><span style="color: #800000;">当前数据库连接不存在</span><span style="color: #800000;">"</span><span style="color: #000000;">);
</span><span style="color: #008080;">257</span>             MySqlCommand cmd = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MySqlCommand();
</span><span style="color: #008080;">258</span>             <span style="color: #0000ff;">object</span> result = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">259</span> 
<span style="color: #008080;">260</span>             <span style="color: #0000ff;">try</span>
<span style="color: #008080;">261</span> <span style="color: #000000;">            {
</span><span style="color: #008080;">262</span>                 PrepareCommand(cmd, conn, <span style="color: #0000ff;">null</span><span style="color: #000000;">, cmdType, cmdText, cmdParms);
</span><span style="color: #008080;">263</span>                 result =<span style="color: #000000;"> cmd.ExecuteScalar();
</span><span style="color: #008080;">264</span> <span style="color: #000000;">                cmd.Parameters.Clear();
</span><span style="color: #008080;">265</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">266</span>             <span style="color: #0000ff;">catch</span>
<span style="color: #008080;">267</span> <span style="color: #000000;">            {
</span><span style="color: #008080;">268</span>                 <span style="color: #0000ff;">throw</span><span style="color: #000000;">;
</span><span style="color: #008080;">269</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">270</span>             <span style="color: #0000ff;">finally</span>
<span style="color: #008080;">271</span> <span style="color: #000000;">            {
</span><span style="color: #008080;">272</span> <span style="color: #000000;">                cmd.Dispose();
</span><span style="color: #008080;">273</span> <span style="color: #000000;">                conn.Close();
</span><span style="color: #008080;">274</span> <span style="color: #000000;">                conn.Dispose();
</span><span style="color: #008080;">275</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">276</span> 
<span style="color: #008080;">277</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> result;
</span><span style="color: #008080;">278</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">279</span> 
<span style="color: #008080;">280</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
<span style="color: #008080;">281</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 执行存储过程
</span><span style="color: #008080;">282</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
<span style="color: #008080;">283</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="connection"&gt;</span><span style="color: #008000;">MySql数据库连接对象</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;">284</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="storedProcName"&gt;</span><span style="color: #008000;">存储过程名</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">285</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="parameters"&gt;</span><span style="color: #008000;">存储过程参数</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">286</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">SqlDataReader对象</span><span style="color: #808080;">&lt;/returns&gt;</span>
<span style="color: #008080;">287</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> MySqlDataReader RunStoredProcedure(MySqlConnection connection, <span style="color: #0000ff;">string</span><span style="color: #000000;"> storedProcName, IDataParameter[] parameters)
</span><span style="color: #008080;">288</span> <span style="color: #000000;">        {
</span><span style="color: #008080;">289</span>             MySqlDataReader returnReader = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">290</span> <span style="color: #000000;">            connection.Open();
</span><span style="color: #008080;">291</span>             MySqlCommand command =<span style="color: #000000;"> BuildSqlCommand(connection, storedProcName, parameters);
</span><span style="color: #008080;">292</span>             returnReader =<span style="color: #000000;"> command.ExecuteReader(CommandBehavior.CloseConnection);
</span><span style="color: #008080;">293</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> returnReader;
</span><span style="color: #008080;">294</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">295</span> 
<span style="color: #008080;">296</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>  
<span style="color: #008080;">297</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 执行数据库命令前的准备工作  
</span><span style="color: #008080;">298</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>  
<span style="color: #008080;">299</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmd"&gt;</span><span style="color: #008000;">Command对象</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;">300</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="conn"&gt;</span><span style="color: #008000;">数据库连接对象</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;">301</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="trans"&gt;</span><span style="color: #008000;">事务对象</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;">302</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdType"&gt;</span><span style="color: #008000;">Command类型</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;">303</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdText"&gt;</span><span style="color: #008000;">MySql存储过程名称或PL/SQL命令</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;">304</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cmdParms"&gt;</span><span style="color: #008000;">命令参数集合</span><span style="color: #808080;">&lt;/param&gt;</span>  
<span style="color: #008080;">305</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> PrepareCommand(MySqlCommand cmd, MySqlConnection conn, MySqlTransaction trans, CommandType cmdType, <span style="color: #0000ff;">string</span><span style="color: #000000;"> cmdText, MySqlParameter[] cmdParms)
</span><span style="color: #008080;">306</span> <span style="color: #000000;">        {
</span><span style="color: #008080;">307</span>             <span style="color: #0000ff;">if</span> (conn.State !=<span style="color: #000000;"> ConnectionState.Open)
</span><span style="color: #008080;">308</span> <span style="color: #000000;">                conn.Open();
</span><span style="color: #008080;">309</span> 
<span style="color: #008080;">310</span>             cmd.Connection =<span style="color: #000000;"> conn;
</span><span style="color: #008080;">311</span>             cmd.CommandText =<span style="color: #000000;"> cmdText;
</span><span style="color: #008080;">312</span> 
<span style="color: #008080;">313</span>             <span style="color: #0000ff;">if</span> (trans != <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;">314</span>                 cmd.Transaction =<span style="color: #000000;"> trans;
</span><span style="color: #008080;">315</span> 
<span style="color: #008080;">316</span>             cmd.CommandType =<span style="color: #000000;"> cmdType;
</span><span style="color: #008080;">317</span> 
<span style="color: #008080;">318</span>             <span style="color: #0000ff;">if</span> (cmdParms != <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;">319</span> <span style="color: #000000;">            {
</span><span style="color: #008080;">320</span>                 <span style="color: #0000ff;">foreach</span> (MySqlParameter parm <span style="color: #0000ff;">in</span><span style="color: #000000;"> cmdParms)
</span><span style="color: #008080;">321</span> <span style="color: #000000;">                    cmd.Parameters.Add(parm);
</span><span style="color: #008080;">322</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">323</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">324</span> 
<span style="color: #008080;">325</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
<span style="color: #008080;">326</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 构建SqlCommand对象
</span><span style="color: #008080;">327</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
<span style="color: #008080;">328</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="connection"&gt;</span><span style="color: #008000;">数据库连接</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">329</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="storedProcName"&gt;</span><span style="color: #008000;">存储过程名</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">330</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="parameters"&gt;</span><span style="color: #008000;">存储过程参数</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">331</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">SqlCommand</span><span style="color: #808080;">&lt;/returns&gt;</span>
<span style="color: #008080;">332</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> MySqlCommand BuildSqlCommand(MySqlConnection connection, <span style="color: #0000ff;">string</span><span style="color: #000000;"> storedProcName, IDataParameter[] parameters)
</span><span style="color: #008080;">333</span> <span style="color: #000000;">        {
</span><span style="color: #008080;">334</span>             MySqlCommand command = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MySqlCommand(storedProcName, connection);
</span><span style="color: #008080;">335</span>             command.CommandType =<span style="color: #000000;"> CommandType.StoredProcedure;
</span><span style="color: #008080;">336</span>             <span style="color: #0000ff;">foreach</span> (MySqlParameter parameter <span style="color: #0000ff;">in</span><span style="color: #000000;"> parameters)
</span><span style="color: #008080;">337</span> <span style="color: #000000;">            {
</span><span style="color: #008080;">338</span> <span style="color: #000000;">                command.Parameters.Add(parameter);
</span><span style="color: #008080;">339</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">340</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> command;
</span><span style="color: #008080;">341</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">342</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">343</span> }</pre>
</div>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>