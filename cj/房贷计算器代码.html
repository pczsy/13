<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修房贷计算器代码' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>房贷计算器代码</center></div><div class='banquan'>原文出处:本文由博客园博主钰娜提供。<br/>
原文连接:https://www.cnblogs.com/xiaochen0409/p/11727462.html</div><br>
    <p>&nbsp; &nbsp; 本人经过两天的修改，做了进一步完善。各个方法功能逐步完善。但是鉴于自己水平有限，代码中错误还是比较多，代码冗余度还是偏高。欢迎大家提出意见，已供代码进一步完善。希望大家多多帮助。谢谢大家。2019年10月25日21点。</p>
<p>using System;<br />using System.Collections.Generic;<br />using System.Linq;<br />using System.Text;<br />using System.Threading.Tasks;<br />using System.Drawing;<br />using System.Reflection;<br />using System.Net.NetworkInformation;</p>
<p>namespace play<br />{<br />    class Program<br />    {<br />        //短期利率与长期利率<br />        double lowRate = 0;<br />        double highRate = 0;</p>
<p>        //KeyValuePair&lt;DateTime, &gt;;<br />        DateTime dt1 = new DateTime(2015, 3, 1);<br />        DateTime dt2 = new DateTime(2015, 5, 11);<br />        DateTime dt3 = new DateTime(2015, 6, 28);<br />        DateTime dt4 = new DateTime(2015, 8, 26);<br />        //贷款金额<br />        static double totalMoney, balance;</p>
<p>        static string choice;<br />        static string newChoice;<br />        //期数<br />        int n;<br />        //月供<br />        double payMonth;<br />        double rate;<br />        double interest;<br />        /// &lt;summary&gt;<br />        /// 用来构建欢迎界面<br />        /// &lt;/summary&gt;<br />        void Paint()<br />        {<br />            Console.WriteLine("***************************");<br />            Console.WriteLine("***************************");<br />            Console.WriteLine("***************************");<br />            Console.WriteLine("欢迎使用房贷计算器");<br />            Console.WriteLine("***************************");<br />            Console.WriteLine("***************************");<br />            Console.WriteLine("***************************");</p>
<p>            Console.WriteLine("请按任意键继续");<br />            Console.ReadKey();<br />            Console.Clear();<br />        }<br />        /// &lt;summary&gt;<br />        /// 按日期选择利率<br />        /// &lt;/summary&gt;<br />        /// &lt;param name="dt"&gt;输入的日期&lt;/param&gt;<br />        void RateChoose(DateTime dt)<br />        {<br />            if (dt &gt;= dt4)<br />            {<br />                lowRate = 0.0275;<br />                highRate = 0.0325;<br />            }<br />            else if (dt &gt;= dt3)<br />            {<br />                lowRate = 0.03;<br />                highRate = 0.035;<br />            }<br />            else if (dt &gt;= dt2)<br />            {<br />                lowRate = 0.0325;<br />                highRate = 0.0375;<br />            }<br />            else if (dt &gt;= dt1)<br />            {<br />                lowRate = 0.035;<br />                highRate = 0.04;<br />            }<br />            else<br />            {<br />                Console.WriteLine("你输入的日期不在范围内");<br />                Console.ReadKey();<br />                Environment.Exit(0);<br />            }<br />        }<br />        /// &lt;summary&gt;<br />        /// 计算月供<br />        /// &lt;/summary&gt;<br />        void Payment(DateTime dt)<br />        {<br />            //设置缓冲区高度，即设置显示的最大行数<br />            Console.BufferHeight = 1000;<br />            RateChoose(dt);<br />            switch (choice)<br />            {<br />                case "1":<br />                    {<br />                        //等额本息，月供计算方法<br />                        for (n = 1; n &lt;= 360; n++)<br />                        {</p>
<p><br />                            if (n &lt;= 60)<br />                            {<br />                                rate = lowRate;<br />                            }<br />                            else<br />                            {<br />                                rate = highRate;<br />                            }<br />                            //计算月供<br />                            double p;<br />                            p = rate / 12;<br />                            payMonth = (p * totalMoney * Math.Pow((1 + p), n)) / ((Math.Pow(1 + p, n) - 1));<br />                            //利息<br />                            interest = n * payMonth;<br />                            if (n % 2 == 0)<br />                            {<br />                                Console.ForegroundColor = ConsoleColor.Blue;<br />                            }<br />                            else<br />                            {<br />                                Console.ForegroundColor = ConsoleColor.White;<br />                            }<br />                            Console.WriteLine("{0}期按揭贷款的月供是{1:0.00}元，总利息是{2:0.00}元", n, payMonth, interest);</p>
<p>                        }<br />                    }<br />                    break;<br />                case "2":<br />                    {<br />                        //等额本金，月供计算方法<br />                        for (n = 1; n &lt;= 360; n++)<br />                        {<br />                            if (n &lt;= 60)<br />                            {<br />                                rate = lowRate;<br />                            }<br />                            else<br />                            {<br />                                rate = highRate;<br />                            }<br />                            //计算月供<br />                            double p;<br />                            p = rate / 12;<br />                            payMonth = (totalMoney / n) + totalMoney * p;<br />                            interest = ((totalMoney / n + totalMoney * p) + totalMoney / n * (1 + p)) / 2 * n - totalMoney;<br />                            Console.WriteLine("{0}期按揭贷款的首月还款额是{1:0.00}元,总利息是{2:0.00}元", n, payMonth, interest);<br />                        }<br />                    }<br />                    break;<br />            }<br />        }</p>
<p>        /// &lt;summary&gt;<br />        /// 月贷计算方法<br />        /// &lt;/summary&gt;<br />        /// &lt;param name="n"&gt;还款期数&lt;/param&gt;<br />        void Compute(int n)<br />        {<br />            Console.WriteLine("期次\t\t偿还利息\t\t偿还本金\t\t还款额\t\t剩余本金");<br />            switch (choice)<br />            {</p>
<p>                case "1":<br />                    //等额本息法计算房贷<br />                    {<br />                        if (n &lt;= 60)<br />                        {<br />                            rate = lowRate;<br />                        }<br />                        else<br />                        {<br />                            rate = highRate;<br />                        }</p>
<p>                        double p;<br />                        p = rate / 12;<br />                        payMonth = (p * totalMoney * Math.Pow((1 + p), n)) / ((Math.Pow(1 + p, n) - 1));<br />                        for (int i = 1; i &lt;= n; i++)<br />                        {<br />                            //string s = i.ToString();<br />                            interest = totalMoney * p;<br />                            double capital = payMonth - interest;<br />                            totalMoney -= capital;<br />                            Console.WriteLine("{0}\t\t{1:0.00}\t\t{2:0.00}\t{3:0.00}\t{4:0.00}", i, interest, capital, payMonth, totalMoney);<br />                        }<br />                    }<br />                    break;<br />                case "2":<br />                    //等额本金法计算房贷<br />                    {<br />                        if (n &lt;= 60)<br />                        {<br />                            rate = lowRate;<br />                        }<br />                        else<br />                        {<br />                            rate = highRate;<br />                        }<br />                        double p;<br />                        p = rate / 12;<br />                        double capital = totalMoney / n;<br />                        for (int i = 1; i &lt;= n; i++)<br />                        {</p>
<p>                            interest = totalMoney * p;<br />                            payMonth = capital + interest;<br />                            totalMoney -= capital;</p>
<p>                            Console.WriteLine("{0}\t\t{1:0.00}\t\t\t{2:0.00}\t\t{3:0.00}\t{4:0.00}", i, interest, capital, payMonth, totalMoney);<br />                        }<br />                    }<br />                    break;</p>
<p>            }<br />        }<br />        /// &lt;summary&gt;<br />        /// 计算还款状况<br />        /// &lt;/summary&gt;<br />        /// &lt;param name="n0"&gt;还款期数&lt;/param&gt;<br />        /// &lt;param name="dt"&gt;首次还款时间&lt;/param&gt;<br />        void Repayment(int n0, DateTime dt)<br />        {<br />            balance = totalMoney;<br />            DateTime dt0 = dt;<br />            double rate0;<br />            double capital;<br />            double p;<br />            Console.WriteLine("还款时间\t\t偿还利息\t\t偿还本金\t\t还款额\t\t剩余本金");<br />            switch (choice)<br />            {<br />                case "1":<br />                    {<br />                        <br />                        RateChoose(dt0);<br />                        if (n0 &lt;= 60)<br />                        {<br />                            rate0 = lowRate;<br />                        }<br />                        else<br />                        {<br />                            rate0 = highRate;<br />                        }<br />                        n = n0;<br />                        for (int i = 1; i &lt;=n0; i++)<br />                        {<br />                            RateChoose(dt);<br />                            rate = (n0 &lt;= 60 ? lowRate : highRate);<br />                            <br />                            if (dt.Year != dt0.Year &amp;&amp; rate != rate0)//这里应该有问题？<br />                            {<br />                                double p0 = rate0 / 12;<br />                                double payMonth0= (p0 * totalMoney * Math.Pow((1 + p0), n)) / ((Math.Pow(1 + p0, n) - 1));<br />                                double interest0 = balance * p0;<br />                                double capital0 = payMonth0 - interest0;<br />                                <br />                                rate0 = rate;<br />                               <br />                                interest = balance * (rate0/12);<br />                                totalMoney = balance;<br />                                balance -= capital0;<br />                               <br />                                payMonth = capital0 + interest;<br />                                n =n0 - i+1;<br />                                Console.WriteLine("{0}\t{1:0.00}\t\t\t{2:0.00}\t\t\t{3:0.00}\t\t{4:0.00}", dt, interest, capital0, payMonth, balance);<br />                                dt = dt.AddMonths(1);<br />                                continue;<br />                            }</p>
<p><br />                           <br />                            p = rate0 / 12;<br />                            payMonth = (p * totalMoney * Math.Pow((1 + p), n)) / ((Math.Pow(1 + p, n) - 1));</p>
<p>                            interest = balance * p;<br />                             capital = payMonth - interest;<br />                            balance -= capital;<br />                            Console.WriteLine("{0}\t{1:0.00}\t\t\t{2:0.00}\t\t\t{3:0.00}\t\t{4:0.00}", dt, interest, capital, payMonth, balance);<br />                            dt = dt.AddMonths(1);</p>
<p>                        }</p>
<p>                    }<br />                    break;<br />                case "2":<br />                    {<br />                        RateChoose(dt0);<br />                        rate0 = (n0 &lt;= 60 ? lowRate : highRate);<br />                        n = n0;<br />                        for (int i = 0; i &lt; n0; i++)<br />                        {<br />                            RateChoose(dt);<br />                            rate = (n0 &lt;= 60 ? lowRate : highRate);<br />                            if (dt.Year!=dt0.Year&amp;&amp;rate!=rate0)<br />                            {<br />                                rate0 = rate;<br />                            }<br />                            p = rate0 / 12;<br />                            capital = totalMoney / n0;<br />                            interest = balance * p;<br />                            payMonth = capital + interest;<br />                            balance -= capital;<br />                            Console.WriteLine("{0}\t{1:0.00}\t\t\t{2:0.00}\t\t\t{3:0.00}\t\t{4:0.00}", dt, interest, capital, payMonth, balance);<br />                            dt = dt.AddMonths(1);<br />                        }<br />                    }<br />                    break;<br />            }<br />        }<br />        /// &lt;summary&gt;<br />        ///实现提前还款功能<br />        /// &lt;/summary&gt;<br />        /// &lt;param name="n"&gt;还款总期数&lt;/param&gt;<br />        /// &lt;param name="dt1"&gt;首次还款时间&lt;/param&gt;<br />        /// &lt;param name="dt2"&gt;提前还款时间&lt;/param&gt;<br />        void Prepayment(int n0,DateTime dt1,DateTime dt2,double money)<br />        {<br />            balance = totalMoney;<br />            DateTime dt0 = dt1;<br />            double rate0;<br />            double capital;<br />            double p;<br />            bool flag = false;<br />            Console.WriteLine("还款时间\t\t偿还利息\t\t偿还本金\t\t还款额\t\t剩余本金");<br />            switch (choice)<br />            {<br />                case "1":<br />                    {<br />                        RateChoose(dt0);<br />                        rate0 = (n0 &lt;= 60 ? lowRate : highRate);<br />                        n = n0;<br />                        for(int i=1;i&lt;=n0;i++)<br />                        {<br />                            RateChoose(dt1);<br />                            rate = (n0 &lt;= 60 ? lowRate : highRate);<br />                           </p>
<p>                            if (dt1.Year != dt0.Year &amp;&amp; rate != rate0)//这里应该有问题？<br />                            {<br />                                double p0 = rate0 / 12;<br />                                double payMonth0 = (p0 * totalMoney * Math.Pow((1 + p0), n)) / ((Math.Pow(1 + p0, n) - 1));<br />                                double interest0 = balance * p0;<br />                                double capital0 = payMonth0 - interest0;</p>
<p>                                rate0 = rate;</p>
<p>                                interest = balance * (rate0 / 12);<br />                                totalMoney = balance;<br />                                balance -= capital0;</p>
<p>                                payMonth = capital0 + interest;<br />                                n = n0 - i + 1;<br />                                Console.WriteLine("{0}\t{1:0.00}\t\t\t{2:0.00}\t\t\t{3:0.00}\t\t{4:0.00}", dt1, interest, capital0, payMonth, balance);<br />                                dt1 = dt1.AddMonths(1);<br />                                continue;<br />                            }</p>
<p>&nbsp;</p>
<p>                            p = rate0 / 12;<br />                            if (dt2.Year == dt1.Year &amp;&amp; dt2.Month == dt1.Month)<br />                            {<br />                                balance -= money;<br />                                totalMoney = balance;<br />                                switch (newChoice)<br />                                {<br />                                    case "1":<br />                                        {</p>
<p>                                            n = n0 - i + 1;<br />                                            flag = true;<br />                                        }<br />                                        break;<br />                                    case "2":<br />                                        {<br />                                            double temp = Math.Log((payMonth / (payMonth - totalMoney * p)), (1 + p));<br />                                            n= (int)Math.Ceiling(temp);<br />                                            n0 = n + i - 1;<br />                                        }<br />                                        break;<br />                                }</p>
<p>                            }<br />                            payMonth = (p * totalMoney * Math.Pow((1 + p), n)) / ((Math.Pow(1 + p, n) - 1));<br />                            </p>
<p>                            interest = balance * p;<br />                            capital = payMonth - interest;<br />                            balance -= capital;<br />                            if (flag)<br />                            {<br />                                payMonth += money;<br />                                capital += money;<br />                                flag = false;<br />                            }<br />                            Console.WriteLine("{0}\t{1:0.00}\t\t\t{2:0.00}\t\t\t{3:0.00}\t\t{4:0.00}", dt1, interest, capital, payMonth, balance);<br />                            dt1 = dt1.AddMonths(1);<br />                        }<br />                    }<br />                    break;<br />                case "2":<br />                    {</p>
<p>                    }<br />                    break;<br />            }<br />        }<br />        static void Main(string[] args)<br />        {</p>
<p>            {<br />                Program p = new Program();<br />                p.Paint();<br />                Console.WriteLine("请选择您的操作！1.房贷计算 2.月供速算 3.还款状况 4.提前还款");<br />                Console.WriteLine("请选择您的还款方式？1.等额本息 2.等额本金");<br />                choice = Console.ReadLine();<br />                Console.WriteLine("请输入你的贷款金额");<br />                totalMoney = Convert.ToDouble(Console.ReadLine());<br />                Console.WriteLine("请输入您贷款的期数");<br />                int number = Convert.ToInt32(Console.ReadLine());<br />                Console.WriteLine("请输入你的首次贷款时间");<br />                DateTime dT = Convert.ToDateTime(Console.ReadLine());<br />                Console.WriteLine("请输入你的提前还款时间");<br />                DateTime dTR = Convert.ToDateTime(Console.ReadLine());<br />                Console.WriteLine("请输入你的还款金额");<br />                double partMoney = Convert.ToDouble(Console.ReadLine());<br />                Console.WriteLine("请选择你要的后续操作！1.减少月供 2.缩短年限");<br />                 newChoice = Console.ReadLine();<br />                //Console.WriteLine("你输入的日期是{0}，短期利率是{1}，长期利率是{2}",dT,p.lowRate,p.highRate);<br />                //dT= dT.AddMonths(1);<br />                // Console.WriteLine(dT);<br />                // p.Repayment(number, dT);<br />                // p.Compute(number);<br />                // p.Payment(dTR);<br />                p.Prepayment(number, dT, dTR, partMoney);<br />                Console.ReadKey();<br />            }<br />        }<br />    }<br />}</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>