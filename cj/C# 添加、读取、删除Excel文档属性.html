<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修C# 添加、读取、删除Excel文档属性' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>C# 添加、读取、删除Excel文档属性</center></div><div class='banquan'>原文出处:本文由博客园博主E-iceblue提供。<br/>
原文连接:https://www.cnblogs.com/Yesi/p/11713788.html</div><br>
    <p>在文档属性中，可以设置诸多关于文档的信息，如创建时间、作者、单位、类别、关键词、备注等摘要信息以及一些自定义的文档属性。下面将通过C#程序来演示如何设置，同时对文档内的已有信息，也可以实现读取或删除等操作。</p>
<p><strong>示例大纲：</strong></p>
<p>1. 添加文档属性</p>
<p>&nbsp; 1.1 添加摘要信息</p>
<p>&nbsp; 1.2 添加自定义文档信息</p>
<p>2. 读取文档属性</p>
<p>3. 删除文档信息</p>
<p>&nbsp; 3.1 删除所有摘要信息、自定义文档属性</p>
<p>&nbsp; 3.2 删除指定摘要信息、自定义文档属性</p>
<p>&nbsp;</p>
<p><strong>使用工具：</strong>Spire.XLS for .NET pack</p>
<p><strong>获取方法</strong><strong>1</strong>：通过官网<span style="color: #3366ff;"><a href="https://www.e-iceblue.cn/Downloads/Spire-XLS-NET.html" target="_blank"><span style="color: #3366ff;">下载</span></a></span>包。下载后，解压文件，安装Bin文件夹下的程序。安装后，将安装路径下Bin文件夹下的Spire.Xls.dll文件添加引用至vs项目程序。如下所示：</p>
<p><img src="./images/C# 添加、读取、删除Excel文档属性0.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><strong>获取方法</strong><strong>2</strong><strong>：</strong>可通过<span style="color: #3366ff;"><a href="http://www.nuget.org/packages/Spire.XLS/" target="_blank"><span style="color: #3366ff;">Nuget</span></a></span>下载。</p>
<p>&nbsp;</p>
<h2><strong>C# </strong><strong>示例</strong></h2>
<h3><strong>【示例】添加文档属性</strong></h3>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">using</span><span style="color: #000000;"> Spire.Xls;
</span><span style="color: #0000ff;">using</span><span style="color: #000000;"> System;

</span><span style="color: #0000ff;">namespace</span><span style="color: #000000;"> AddProperties
{
    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">加载Excel文档</span>
            Workbook workbook = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Workbook();
            workbook.LoadFromFile(</span><span style="color: #800000;">"</span><span style="color: #800000;">test.xlsx</span><span style="color: #800000;">"</span><span style="color: #000000;">);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">设置摘要</span>
            workbook.DocumentProperties.Author = <span style="color: #800000;">"</span><span style="color: #800000;">Mara</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            workbook.DocumentProperties.Title </span>= <span style="color: #800000;">"</span><span style="color: #800000;">摘要</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            workbook.DocumentProperties.Keywords </span>= <span style="color: #800000;">"</span><span style="color: #800000;">摘要，属性</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            workbook.DocumentProperties.Category </span>= <span style="color: #800000;">"</span><span style="color: #800000;">展示文档</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            workbook.DocumentProperties.Company </span>= <span style="color: #800000;">"</span><span style="color: #800000;">冰蓝科技</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            workbook.DocumentProperties.Comments </span>= <span style="color: #800000;">"</span><span style="color: #800000;">请勿修改</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            workbook.DocumentProperties.Subject </span>= <span style="color: #800000;">"</span><span style="color: #800000;">测试</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            workbook.DocumentProperties.Manager </span>= <span style="color: #800000;">"</span><span style="color: #800000;">Tom</span><span style="color: #800000;">"</span><span style="color: #000000;">;


            </span><span style="color: #008000;">//</span><span style="color: #008000;">设置自定义属性</span>
            workbook.CustomDocumentProperties.Add(<span style="color: #800000;">"</span><span style="color: #800000;">_MarkAsFinal</span><span style="color: #800000;">"</span>, <span style="color: #0000ff;">true</span><span style="color: #000000;">);
            workbook.CustomDocumentProperties.Add(</span><span style="color: #800000;">"</span><span style="color: #800000;">联系电话</span><span style="color: #800000;">"</span>, <span style="color: #800080;">81705109</span><span style="color: #000000;">);
            workbook.CustomDocumentProperties.Add(</span><span style="color: #800000;">"</span><span style="color: #800000;">更新时间</span><span style="color: #800000;">"</span><span style="color: #000000;">, DateTime.Now);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">保存文档</span>
            workbook.SaveToFile(<span style="color: #800000;">"</span><span style="color: #800000;">AddProperties.xlsx</span><span style="color: #800000;">"</span><span style="color: #000000;">, FileFormat.Version2010);
        }
    }
}</span></pre>
</div>
<p>文档属性添加效果：</p>
<p><img src="./images/C# 添加、读取、删除Excel文档属性1.png" alt="" /></p>
<p>&nbsp;</p>
<h3><strong>【示例</strong><strong>2</strong><strong>】读取文档信息</strong></h3>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">using</span><span style="color: #000000;"> Spire.Xls;
</span><span style="color: #0000ff;">using</span><span style="color: #000000;"> Spire.Xls.Collections;
</span><span style="color: #0000ff;">using</span><span style="color: #000000;"> Spire.Xls.Core;
</span><span style="color: #0000ff;">using</span><span style="color: #000000;"> System;

</span><span style="color: #0000ff;">namespace</span><span style="color: #000000;"> ReadProperties
{
    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">加载Excel文档</span>
            Workbook wb = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Workbook();
            wb.LoadFromFile(</span><span style="color: #800000;">"</span><span style="color: #800000;">AddProperties.xlsx</span><span style="color: #800000;">"</span><span style="color: #000000;">);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">获取文档属性</span>
            Console.WriteLine(<span style="color: #800000;">"</span><span style="color: #800000;">摘要信息:</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">标题: </span><span style="color: #800000;">"</span> +<span style="color: #000000;"> wb.DocumentProperties.Title);
            Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">主题: </span><span style="color: #800000;">"</span> +<span style="color: #000000;"> wb.DocumentProperties.Subject);
            Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">作者: </span><span style="color: #800000;">"</span> +<span style="color: #000000;"> wb.DocumentProperties.Author);
            Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">管理者: </span><span style="color: #800000;">"</span> +<span style="color: #000000;"> wb.DocumentProperties.Manager);
            Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">公司: </span><span style="color: #800000;">"</span> +<span style="color: #000000;"> wb.DocumentProperties.Company);
            Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">类别: </span><span style="color: #800000;">"</span> +<span style="color: #000000;"> wb.DocumentProperties.Category);
            Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">关键字: </span><span style="color: #800000;">"</span> +<span style="color: #000000;"> wb.DocumentProperties.Keywords);
            Console.WriteLine(</span><span style="color: #800000;">"</span><span style="color: #800000;">备注: </span><span style="color: #800000;">"</span> +<span style="color: #000000;"> wb.DocumentProperties.Comments);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">获取自定义属性</span>
            Console.WriteLine(<span style="color: #800000;">"</span><span style="color: #800000;">\n自定义属性：</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">0</span>; i &lt; wb.CustomDocumentProperties.Count; i++<span style="color: #000000;">)
            {
                Console.WriteLine(wb.CustomDocumentProperties[i].Name </span>+ <span style="color: #800000;">"</span><span style="color: #800000;">: </span><span style="color: #800000;">"</span> +<span style="color: #000000;"> wb.CustomDocumentProperties[i].Value);
            }
            Console.Read();
        }
    }
}</span></pre>
</div>
<p>文档属性读取结果：</p>
<p>&nbsp;</p>
<p><img src="./images/C# 添加、读取、删除Excel文档属性2.png" alt="" /></p>
<p>&nbsp;</p>
<h3><strong>【示例</strong><strong>3</strong><strong>】删除文档属性</strong></h3>
<div class="cnblogs_code">
<pre><code><span style="color: #0000ff;">using</span><span style="color: #000000;"> Spire.Xls;

</span><span style="color: #0000ff;">namespace</span><span style="color: #000000;"> DeleteProperties
{
    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">加载工作簿</span>
            Workbook workbook = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Workbook();
            workbook.LoadFromFile(</span><span style="color: #800000;">"</span><span style="color: #800000;">AddProperties.xlsx</span><span style="color: #800000;">"</span><span style="color: #000000;">);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">删除摘要及自定义文档属性</span>
            workbook.DocumentProperties.Clear();<span style="color: #008000;">//</span><span style="color: #008000;">删除所有摘要信息</span>
            workbook.CustomDocumentProperties.Clear();<span style="color: #008000;">//</span><span style="color: #008000;">删除所有自定义文档属性
            
            </span><span style="color: #008000;">//</span><span style="color: #008000;">保存文档</span>
            workbook.SaveToFile(<span style="color: #800000;">"</span><span style="color: #800000;">DeleteProperties.xlsx</span><span style="color: #800000;">"</span><span style="color: #000000;">, FileFormat.Version2013);

            </span><span style="color: #008000;">/*</span><span style="color: #008000;">//删除指定摘要及自定义文档属性
            workbook.DocumentProperties.Author = "";//设置指定摘要信息为空，删除摘要内容
            workbook.CustomDocumentProperties.Remove("联系电话");//删除指定名称的自定义文档属性
            workbook.SaveToFile("DeleteCustomDocumentProperties.xlsx", FileFormat.Version2013);</span><span style="color: #008000;">*/</span><span style="color: #000000;">
        }
    }
}</span></pre>
</div>
<p>文档属性删除结果：</p>
<p><img src="./images/C# 添加、读取、删除Excel文档属性3.png" alt="" /></p>
<p>&nbsp;</p>
<p>（本文完）</p>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>