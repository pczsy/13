<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修C# 创建含多层分类标签的Excel图表' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>C# 创建含多层分类标签的Excel图表</center></div><div class='banquan'>原文出处:本文由博客园博主E-iceblue提供。<br/>
原文连接:https://www.cnblogs.com/Yesi/p/10670988.html</div><br>
    <p>相较于数据，图表更能直观的体现数据的变化趋势。在数据表格中，同一数据值，可能同时代表不同的数据分类，表现在图表中则是一个数据体现在多个数据分类标签下。通常生成的图表一般默认只有一种分类标签，下面的方法将通过编程的方式来介绍在Excel中如何来生成含多层分类标签的图表。&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-size: 18px;"><strong>使用工具</strong>：</span>Spire.XLS for .NET</p>
<p><strong>1.</strong>通过官网（<a href="https://www.e-iceblue.cn/Introduce/Spire-XLS-NET.html">https://www.e-iceblue.cn/Introduce/Spire-XLS-NET.html</a> ）下载安装包--解压-安装。在程序中添加引用Spire.XLS.dll，dll文件在安装路径下的bin文件夹中。</p>
<p><strong>2.</strong>通过 Nuget 官网。（<a href="http://www.nuget.org/packages/Spire.XLS/">http://www.nuget.org/packages/Spire.XLS/</a> ）</p>
<p>添加引用完成后，如下图：</p>
<p><img src="./images/C# 创建含多层分类标签的Excel图表0.png" alt="" /></p>
<p><strong><span style="font-size: 18px;">C#示例代码</span></strong></p>
<p>&nbsp;Step1:创建工作表</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">创建Workbook实例，获取工作表</span>
Workbook wb = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Workbook();
Worksheet sheet </span>= wb.Worksheets[<span style="color: #800080;">0</span>];</pre>
</div>
<p>Step2:写入数据到表格</p>
<div class="cnblogs_code">
<pre><code> sheet.Range[<span style="color: #800000;">"</span><span style="color: #800000;">A2</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">出口前</span><span style="color: #800000;">"</span><span style="color: #000000;">;
 sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">A5</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">出口后</span><span style="color: #800000;">"</span><span style="color: #000000;">;
 sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">B1</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">年份</span><span style="color: #800000;">"</span><span style="color: #000000;">;
 sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">B2</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">2017年</span><span style="color: #800000;">"</span><span style="color: #000000;">;
 sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">B6</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">2018年</span><span style="color: #800000;">"</span><span style="color: #000000;">;
 sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">C1</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">季度</span><span style="color: #800000;">"</span><span style="color: #000000;">;
 sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">C2</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">1季度</span><span style="color: #800000;">"</span><span style="color: #000000;">;
 sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">C3</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">2季度</span><span style="color: #800000;">"</span><span style="color: #000000;">;
 sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">C4</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">3季度</span><span style="color: #800000;">"</span><span style="color: #000000;">;
 sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">C5</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">4季度</span><span style="color: #800000;">"</span><span style="color: #000000;">;
 sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">C6</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">1季度</span><span style="color: #800000;">"</span><span style="color: #000000;">;
 sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">C7</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">2季度</span><span style="color: #800000;">"</span><span style="color: #000000;">;
 sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">C8</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">3季度</span><span style="color: #800000;">"</span><span style="color: #000000;">;
 sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">C9</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">4季度</span><span style="color: #800000;">"</span><span style="color: #000000;">;
 sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">D1</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">季度产量\n（万吨）</span><span style="color: #800000;">"</span><span style="color: #000000;">;
 sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">D2</span><span style="color: #800000;">"</span>].Value = <span style="color: #800000;">"</span><span style="color: #800000;">1.56</span><span style="color: #800000;">"</span><span style="color: #000000;">;
 sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">D3</span><span style="color: #800000;">"</span>].Value = <span style="color: #800000;">"</span><span style="color: #800000;">2.3</span><span style="color: #800000;">"</span><span style="color: #000000;">;
 sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">D4</span><span style="color: #800000;">"</span>].Value = <span style="color: #800000;">"</span><span style="color: #800000;">3.21</span><span style="color: #800000;">"</span><span style="color: #000000;">;
 sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">D5</span><span style="color: #800000;">"</span>].Value = <span style="color: #800000;">"</span><span style="color: #800000;">3.5</span><span style="color: #800000;">"</span><span style="color: #000000;">;
 sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">D6</span><span style="color: #800000;">"</span>].Value = <span style="color: #800000;">"</span><span style="color: #800000;">4.8</span><span style="color: #800000;">"</span><span style="color: #000000;">;
 sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">D7</span><span style="color: #800000;">"</span>].Value = <span style="color: #800000;">"</span><span style="color: #800000;">5.2</span><span style="color: #800000;">"</span><span style="color: #000000;">;
 sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">D8</span><span style="color: #800000;">"</span>].Value = <span style="color: #800000;">"</span><span style="color: #800000;">5.79</span><span style="color: #800000;">"</span><span style="color: #000000;">;
 sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">D9</span><span style="color: #800000;">"</span>].Value = <span style="color: #800000;">"</span><span style="color: #800000;">5.58</span><span style="color: #800000;">"</span>;</pre>
</div>
<p>Step3:合并单元格并设置单元格对齐方式</p>
<div class="cnblogs_code">
<pre><code>sheet.Range[<span style="color: #800000;">"</span><span style="color: #800000;">A2:A4</span><span style="color: #800000;">"</span><span style="color: #000000;">].Merge();
sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">A5:A9</span><span style="color: #800000;">"</span><span style="color: #000000;">].Merge();
sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">B2:B5</span><span style="color: #800000;">"</span><span style="color: #000000;">].Merge();
sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">B6:B9</span><span style="color: #800000;">"</span><span style="color: #000000;">].Merge();
sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">A1:D9</span><span style="color: #800000;">"</span>].Style.HorizontalAlignment =<span style="color: #000000;"> HorizontalAlignType.Center;
sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">A1:D9</span><span style="color: #800000;">"</span>].Style.VerticalAlignment = VerticalAlignType.Center;</pre>
</div>
<p>Step4:添加图表到Excel</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">添加柱状图表</span>
Chart chart =<span style="color: #000000;"> sheet.Charts.Add(ExcelChartType.LineMarkers);
chart.ChartTitle </span>= <span style="color: #800000;">"</span><span style="color: #800000;">季度产量（万吨）</span><span style="color: #800000;">"</span>;<span style="color: #008000;">//</span><span style="color: #008000;">设置图表标题     </span>
chart.PlotArea.Fill.FillType = ShapeFillType.NoFill; <span style="color: #008000;">//</span><span style="color: #008000;">不填充绘图区域（默认填充灰色）</span>
chart.Legend.Delete();<span style="color: #008000;">//</span><span style="color: #008000;">删除图例

</span><span style="color: #008000;">//</span><span style="color: #008000;">指定柱状图表在工作表中的位置及宽度</span>
chart.LeftColumn = <span style="color: #800080;">5</span><span style="color: #000000;">;
chart.TopRow </span>= <span style="color: #800080;">1</span><span style="color: #000000;">;
chart.RightColumn </span>= <span style="color: #800080;">14</span><span style="color: #000000;">;

</span><span style="color: #008000;">//</span><span style="color: #008000;">设置图表系列数据来源</span>
chart.DataRange = sheet.Range[<span style="color: #800000;">"</span><span style="color: #800000;">D2:D9</span><span style="color: #800000;">"</span><span style="color: #000000;">];
chart.SeriesDataFromRange </span>= <span style="color: #0000ff;">false</span><span style="color: #000000;">;
chart.Series[</span><span style="color: #800080;">0</span>].DataPoints.DefaultDataPoint.DataLabels.HasValue = <span style="color: #0000ff;">true</span><span style="color: #000000;">;
chart.Series[</span><span style="color: #800080;">0</span>].Format.LineProperties.Color =<span style="color: #000000;"> Color.BlueViolet;

</span><span style="color: #008000;">//</span><span style="color: #008000;">设置系列分类标签数据来源</span>
ChartSerie serie = chart.Series[<span style="color: #800080;">0</span><span style="color: #000000;">];
serie.CategoryLabels </span>= sheet.Range[<span style="color: #800000;">"</span><span style="color: #800000;">A2:C9</span><span style="color: #800000;">"</span>];</pre>
</div>
<p>Step5:设置是否显示多层分类标签</p>
<div class="cnblogs_code">
<pre><code>chart.PrimaryCategoryAxis.MultiLevelLable = <span style="color: #0000ff;">true</span>;</pre>
</div>
<p>Step6: 保存文档</p>
<div class="cnblogs_code">
<pre><code>wb.SaveToFile(<span style="color: #800000;">"</span><span style="color: #800000;">output.xlsx</span><span style="color: #800000;">"</span>, ExcelVersion.Version2013);</pre>
</div>
<p>&nbsp;</p>
<p><span style="font-size: 16px;">图表创建结果：</span></p>
<p><img src="./images/C# 创建含多层分类标签的Excel图表1.png" alt="" /></p>
<p>&nbsp;</p>
<p><span style="color: #339966;"><strong><span style="font-size: 18px;">全部代码:</span></strong></span></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('ecfe6c29-4a8d-45fa-94dc-ad9f4b7e0aa9')"><img id="code_img_closed_ecfe6c29-4a8d-45fa-94dc-ad9f4b7e0aa9" class="code_img_closed" src="./images/C# 创建含多层分类标签的Excel图表2.png" alt="" /><img id="code_img_opened_ecfe6c29-4a8d-45fa-94dc-ad9f4b7e0aa9" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('ecfe6c29-4a8d-45fa-94dc-ad9f4b7e0aa9',event)" src="./images/C# 创建含多层分类标签的Excel图表3.png" alt="" />
<div id="cnblogs_code_open_ecfe6c29-4a8d-45fa-94dc-ad9f4b7e0aa9" class="cnblogs_code_hide">
<pre><code><span style="color: #0000ff;">using</span><span style="color: #000000;"> Spire.Xls;
</span><span style="color: #0000ff;">using</span><span style="color: #000000;"> Spire.Xls.Charts;
</span><span style="color: #0000ff;">using</span><span style="color: #000000;"> System.Drawing;

</span><span style="color: #0000ff;">namespace</span><span style="color: #000000;"> ChartWithMultiLevelCategoryLabels_XLS
{
    </span><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">创建Workbook实例，获取工作表</span>
            Workbook wb = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Workbook();
            Worksheet sheet </span>= wb.Worksheets[<span style="color: #800080;">0</span><span style="color: #000000;">];

            </span><span style="color: #008000;">//</span><span style="color: #008000;">写入数据到工作表</span>
            sheet.Range[<span style="color: #800000;">"</span><span style="color: #800000;">A2</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">出口前</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">A5</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">出口后</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">B1</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">年份</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">B2</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">2017年</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">B6</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">2018年</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">C1</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">季度</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">C2</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">1季度</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">C3</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">2季度</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">C4</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">3季度</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">C5</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">4季度</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">C6</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">1季度</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">C7</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">2季度</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">C8</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">3季度</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">C9</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">4季度</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">D1</span><span style="color: #800000;">"</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">季度产量\n（万吨）</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">D2</span><span style="color: #800000;">"</span>].Value = <span style="color: #800000;">"</span><span style="color: #800000;">1.56</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">D3</span><span style="color: #800000;">"</span>].Value = <span style="color: #800000;">"</span><span style="color: #800000;">2.3</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">D4</span><span style="color: #800000;">"</span>].Value = <span style="color: #800000;">"</span><span style="color: #800000;">3.21</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">D5</span><span style="color: #800000;">"</span>].Value = <span style="color: #800000;">"</span><span style="color: #800000;">3.5</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">D6</span><span style="color: #800000;">"</span>].Value = <span style="color: #800000;">"</span><span style="color: #800000;">4.8</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">D7</span><span style="color: #800000;">"</span>].Value = <span style="color: #800000;">"</span><span style="color: #800000;">5.2</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">D8</span><span style="color: #800000;">"</span>].Value = <span style="color: #800000;">"</span><span style="color: #800000;">5.79</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">D9</span><span style="color: #800000;">"</span>].Value = <span style="color: #800000;">"</span><span style="color: #800000;">5.58</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            

            </span><span style="color: #008000;">//</span><span style="color: #008000;">合并单元格，设置单元格对齐方式</span>
            sheet.Range[<span style="color: #800000;">"</span><span style="color: #800000;">A2:A4</span><span style="color: #800000;">"</span><span style="color: #000000;">].Merge();
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">A5:A9</span><span style="color: #800000;">"</span><span style="color: #000000;">].Merge();
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">B2:B5</span><span style="color: #800000;">"</span><span style="color: #000000;">].Merge();
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">B6:B9</span><span style="color: #800000;">"</span><span style="color: #000000;">].Merge();
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">A1:D9</span><span style="color: #800000;">"</span>].Style.HorizontalAlignment =<span style="color: #000000;"> HorizontalAlignType.Center;
            sheet.Range[</span><span style="color: #800000;">"</span><span style="color: #800000;">A1:D9</span><span style="color: #800000;">"</span>].Style.VerticalAlignment =<span style="color: #000000;"> VerticalAlignType.Center;


            </span><span style="color: #008000;">//</span><span style="color: #008000;">添加柱状图表</span>
            Chart chart =<span style="color: #000000;"> sheet.Charts.Add(ExcelChartType.LineMarkers);
            chart.ChartTitle </span>= <span style="color: #800000;">"</span><span style="color: #800000;">季度产量（万吨）</span><span style="color: #800000;">"</span>;<span style="color: #008000;">//</span><span style="color: #008000;">设置图表标题     </span>
            chart.PlotArea.Fill.FillType = ShapeFillType.NoFill; <span style="color: #008000;">//</span><span style="color: #008000;">不填充绘图区域（默认填充灰色）</span>
            chart.Legend.Delete();<span style="color: #008000;">//</span><span style="color: #008000;">删除图例

            </span><span style="color: #008000;">//</span><span style="color: #008000;">指定柱状图表在工作表中的位置及宽度</span>
            chart.LeftColumn = <span style="color: #800080;">5</span><span style="color: #000000;">;
            chart.TopRow </span>= <span style="color: #800080;">1</span><span style="color: #000000;">;
            chart.RightColumn </span>= <span style="color: #800080;">14</span><span style="color: #000000;">;

            </span><span style="color: #008000;">//</span><span style="color: #008000;">设置图表系列数据来源</span>
            chart.DataRange = sheet.Range[<span style="color: #800000;">"</span><span style="color: #800000;">D2:D9</span><span style="color: #800000;">"</span><span style="color: #000000;">];
            chart.SeriesDataFromRange </span>= <span style="color: #0000ff;">false</span><span style="color: #000000;">;
            chart.Series[</span><span style="color: #800080;">0</span>].DataPoints.DefaultDataPoint.DataLabels.HasValue = <span style="color: #0000ff;">true</span><span style="color: #000000;">;
            chart.Series[</span><span style="color: #800080;">0</span>].Format.LineProperties.Color =<span style="color: #000000;"> Color.BlueViolet;

            </span><span style="color: #008000;">//</span><span style="color: #008000;">设置系列分类标签数据来源</span>
            ChartSerie serie = chart.Series[<span style="color: #800080;">0</span><span style="color: #000000;">];
            serie.CategoryLabels </span>= sheet.Range[<span style="color: #800000;">"</span><span style="color: #800000;">A2:C9</span><span style="color: #800000;">"</span><span style="color: #000000;">];


            </span><span style="color: #008000;">//</span><span style="color: #008000;">显示多层分类标签</span>
            chart.PrimaryCategoryAxis.MultiLevelLable = <span style="color: #0000ff;">true</span><span style="color: #000000;">;

            </span><span style="color: #008000;">//</span><span style="color: #008000;">保存文档</span>
            wb.SaveToFile(<span style="color: #800000;">"</span><span style="color: #800000;">output.xlsx</span><span style="color: #800000;">"</span><span style="color: #000000;">, ExcelVersion.Version2013);
            System.Diagnostics.Process.Start(</span><span style="color: #800000;">"</span><span style="color: #800000;">output.xlsx</span><span style="color: #800000;">"</span><span style="color: #000000;">);
        }
    }
}</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp;</p>
<p>（本文完）</p>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>