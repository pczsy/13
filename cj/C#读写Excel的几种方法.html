<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修C#读写Excel的几种方法' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>C#读写Excel的几种方法</center></div><div class='banquan'>原文出处:本文由博客园博主jqw2009提供。<br/>
原文连接:https://www.cnblogs.com/kenjiang/p/10790652.html</div><br>
    <p><strong>1 使用Office自带的库</strong></p>
<p>前提是本机须安装office才能运行，且不同的office版本之间可能会有兼容问题，从Nuget下载 <strong>Microsoft.Office.Interop.Excel</strong></p>
<p><img src="./images/C#读写Excel的几种方法0.png" alt="" /></p>
<p>读写代码如下：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">using</span><span style="color: #000000;"> Microsoft.Office.Interop.Excel;
</span><span style="color: #008080;"> 2</span> <span style="color: #0000ff;">using</span> Excel =<span style="color: #000000;"> Microsoft.Office.Interop.Excel;
</span><span style="color: #008080;"> 3</span> 
<span style="color: #008080;"> 4</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> btn_Office_Click(<span style="color: #0000ff;">object</span><span style="color: #000000;"> sender, EventArgs e)
</span><span style="color: #008080;"> 5</span> <span style="color: #000000;">        {
</span><span style="color: #008080;"> 6</span>             <span style="color: #0000ff;">string</span> importExcelPath = <span style="color: #800000;">"</span><span style="color: #800000;">E:\\import.xlsx</span><span style="color: #800000;">"</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 7</span>             <span style="color: #0000ff;">string</span> exportExcelPath = <span style="color: #800000;">"</span><span style="color: #800000;">E:\\export.xlsx</span><span style="color: #800000;">"</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 8</span>             <span style="color: #008000;">//</span><span style="color: #008000;">创建</span>
<span style="color: #008080;"> 9</span>             Excel.Application xlApp = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Excel.Application();
</span><span style="color: #008080;">10</span>             xlApp.DisplayAlerts = <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;">11</span>             xlApp.Visible = <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;">12</span>             xlApp.ScreenUpdating = <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;">13</span>             <span style="color: #008000;">//</span><span style="color: #008000;">打开Excel</span>
<span style="color: #008080;">14</span>             Excel.Workbook xlsWorkBook =<span style="color: #000000;"> xlApp.Workbooks.Open(importExcelPath, System.Type.Missing, System.Type.Missing, System.Type.Missing,
</span><span style="color: #008080;">15</span> <span style="color: #000000;">            System.Type.Missing, System.Type.Missing, System.Type.Missing, System.Type.Missing, System.Type.Missing, System.Type.Missing, System.Type.Missing,
</span><span style="color: #008080;">16</span> <span style="color: #000000;">            System.Type.Missing, System.Type.Missing, System.Type.Missing, System.Type.Missing);
</span><span style="color: #008080;">17</span> 
<span style="color: #008080;">18</span>             <span style="color: #008000;">//</span><span style="color: #008000;">处理数据过程，更多操作方法自行百度</span>
<span style="color: #008080;">19</span>             Excel.Worksheet sheet = xlsWorkBook.Worksheets[<span style="color: #800080;">1</span>];<span style="color: #008000;">//</span><span style="color: #008000;">工作薄从1开始，不是0</span>
<span style="color: #008080;">20</span>             sheet.Cells[<span style="color: #800080;">1</span>, <span style="color: #800080;">1</span>] = <span style="color: #800000;">"</span><span style="color: #800000;">test</span><span style="color: #800000;">"</span><span style="color: #000000;">;
</span><span style="color: #008080;">21</span> 
<span style="color: #008080;">22</span>             <span style="color: #008000;">//</span><span style="color: #008000;">另存</span>
<span style="color: #008080;">23</span> <span style="color: #000000;">            xlsWorkBook.SaveAs(exportExcelPath, Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing, XlSaveAsAccessMode.xlNoChange,
</span><span style="color: #008080;">24</span> <span style="color: #000000;">                Type.Missing, Type.Missing, Type.Missing, Type.Missing, Type.Missing);
</span><span style="color: #008080;">25</span>             <span style="color: #008000;">//</span><span style="color: #008000;">关闭Excel进程</span>
<span style="color: #008080;">26</span> <span style="color: #000000;">            ClosePro(xlApp, xlsWorkBook);
</span><span style="color: #008080;">27</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">28</span> 
<span style="color: #008080;">29</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> ClosePro(Excel.Application xlApp, Excel.Workbook xlsWorkBook)
</span><span style="color: #008080;">30</span> <span style="color: #000000;">        {
</span><span style="color: #008080;">31</span>             <span style="color: #0000ff;">if</span> (xlsWorkBook != <span style="color: #0000ff;">null</span><span style="color: #000000;">)
</span><span style="color: #008080;">32</span>                 xlsWorkBook.Close(<span style="color: #0000ff;">true</span><span style="color: #000000;">, Type.Missing, Type.Missing);
</span><span style="color: #008080;">33</span> <span style="color: #000000;">            xlApp.Quit();
</span><span style="color: #008080;">34</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> 安全回收进程</span>
<span style="color: #008080;">35</span> <span style="color: #000000;">            System.GC.GetGeneration(xlApp);
</span><span style="color: #008080;">36</span>             IntPtr t = <span style="color: #0000ff;">new</span> IntPtr(xlApp.Hwnd);   <span style="color: #008000;">//</span><span style="color: #008000;">获取句柄</span>
<span style="color: #008080;">37</span>             <span style="color: #0000ff;">int</span> k = <span style="color: #800080;">0</span><span style="color: #000000;">;
</span><span style="color: #008080;">38</span>             GetWindowThreadProcessId(t, <span style="color: #0000ff;">out</span> k);   <span style="color: #008000;">//</span><span style="color: #008000;">获取进程唯一标志</span>
<span style="color: #008080;">39</span>             System.Diagnostics.Process p =<span style="color: #000000;"> System.Diagnostics.Process.GetProcessById(k);
</span><span style="color: #008080;">40</span>             p.Kill();     <span style="color: #008000;">//</span><span style="color: #008000;">关闭进程</span>
<span style="color: #008080;">41</span>         }</pre>
</div>
<p><strong>2. 使用NPOI　　</strong></p>
<p><strong>地址：https://github.com/tonyqus/npoi</strong></p>
<p>在不安装office的时候也是可以读写的，速度很快，从Nuget下载 <strong>NPOI</strong></p>
<p><strong><img src="./images/C#读写Excel的几种方法1.png" alt="" /></strong></p>
<p>&nbsp;</p>
<p>读写代码如下：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">using</span><span style="color: #000000;"> System.IO;
</span><span style="color: #008080;"> 2</span> <span style="color: #0000ff;">using</span><span style="color: #000000;"> NPOI;
</span><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">using</span><span style="color: #000000;"> NPOI.SS.UserModel;
</span><span style="color: #008080;"> 4</span> 
<span style="color: #008080;"> 5</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> btn_NPOI_Click(<span style="color: #0000ff;">object</span><span style="color: #000000;"> sender, EventArgs e)
</span><span style="color: #008080;"> 6</span> <span style="color: #000000;">        {
</span><span style="color: #008080;"> 7</span>             <span style="color: #0000ff;">string</span> importExcelPath = <span style="color: #800000;">"</span><span style="color: #800000;">E:\\import.xlsx</span><span style="color: #800000;">"</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 8</span>             <span style="color: #0000ff;">string</span> exportExcelPath = <span style="color: #800000;">"</span><span style="color: #800000;">E:\\export.xlsx</span><span style="color: #800000;">"</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 9</span>             IWorkbook workbook =<span style="color: #000000;"> WorkbookFactory.Create(importExcelPath);
</span><span style="color: #008080;">10</span>             ISheet sheet = workbook.GetSheetAt(<span style="color: #800080;">0</span>);<span style="color: #008000;">//</span><span style="color: #008000;">获取第一个工作薄</span>
<span style="color: #008080;">11</span>             IRow row = (IRow)sheet.GetRow(<span style="color: #800080;">0</span>);<span style="color: #008000;">//</span><span style="color: #008000;">获取第一行
</span><span style="color: #008080;">12</span> 
<span style="color: #008080;">13</span>             <span style="color: #008000;">//</span><span style="color: #008000;">设置第一行第一列值,更多方法请参考源官方Demo</span>
<span style="color: #008080;">14</span>             row.CreateCell(<span style="color: #800080;">0</span>).SetCellValue(<span style="color: #800000;">"</span><span style="color: #800000;">test</span><span style="color: #800000;">"</span>);<span style="color: #008000;">//</span><span style="color: #008000;">设置第一行第一列值
</span><span style="color: #008080;">15</span> 
<span style="color: #008080;">16</span>             <span style="color: #008000;">//</span><span style="color: #008000;">导出excel</span>
<span style="color: #008080;">17</span>             FileStream fs = <span style="color: #0000ff;">new</span><span style="color: #000000;"> FileStream(exportExcelPath, FileMode.Create, FileAccess.ReadWrite);
</span><span style="color: #008080;">18</span> <span style="color: #000000;">            workbook.Write(fs);
</span><span style="color: #008080;">19</span> <span style="color: #000000;">            fs.Close();
</span><span style="color: #008080;">20</span>         }</pre>
</div>
<p><strong>3. 使用ClosedXml　　</strong></p>
<p><strong>地址：https://github.com/ClosedXML/ClosedXML</strong></p>
<p>从Nuget下载<strong>&nbsp;ClosedXml</strong></p>
<p><strong><img src="./images/C#读写Excel的几种方法2.png" alt="" /></strong></p>
<p>&nbsp;</p>
<p>读写代码如下：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">using</span><span style="color: #000000;"> ClosedXML;
</span><span style="color: #008080;"> 2</span> <span style="color: #0000ff;">using</span><span style="color: #000000;"> ClosedXML.Excel;
</span><span style="color: #008080;"> 3</span> 
<span style="color: #008080;"> 4</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> btn_ClosedXML_Click(<span style="color: #0000ff;">object</span><span style="color: #000000;"> sender, EventArgs e)
</span><span style="color: #008080;"> 5</span> <span style="color: #000000;">        {
</span><span style="color: #008080;"> 6</span>             <span style="color: #0000ff;">string</span> importExcelPath = <span style="color: #800000;">"</span><span style="color: #800000;">E:\\import.xlsx</span><span style="color: #800000;">"</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 7</span>             <span style="color: #0000ff;">string</span> exportExcelPath = <span style="color: #800000;">"</span><span style="color: #800000;">E:\\export.xlsx</span><span style="color: #800000;">"</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 8</span>             <span style="color: #0000ff;">var</span> workbook = <span style="color: #0000ff;">new</span><span style="color: #000000;"> XLWorkbook(importExcelPath);
</span><span style="color: #008080;"> 9</span> 
<span style="color: #008080;">10</span>             IXLWorksheet sheet = workbook.Worksheet(<span style="color: #800080;">1</span>);<span style="color: #008000;">//</span><span style="color: #008000;">这个库也是从1开始
</span><span style="color: #008080;">11</span>             <span style="color: #008000;">//</span><span style="color: #008000;">设置第一行第一列值,更多方法请参考官方Demo</span>
<span style="color: #008080;">12</span>             sheet.Cell(<span style="color: #800080;">1</span>, <span style="color: #800080;">1</span>).Value = <span style="color: #800000;">"</span><span style="color: #800000;">test</span><span style="color: #800000;">"</span>;<span style="color: #008000;">//</span><span style="color: #008000;">该方法也是从1开始，非0</span>
<span style="color: #008080;">13</span> 
<span style="color: #008080;">14</span> <span style="color: #000000;">            workbook.SaveAs(exportExcelPath);
</span><span style="color: #008080;">15</span>         }</pre>
</div>
<p><strong>4. 使用 spire.xls　　</strong></p>
<p><strong>地址：https://www.e-iceblue.com/Introduce/free-xls-component.html</strong></p>
<p>spire分免费和收费，无特殊需求用免费即可</p>
<p>从Nuget下载<strong>&nbsp;Free Spire.xls For .NET</strong></p>
<p><strong><img src="./images/C#读写Excel的几种方法3.png" alt="" /></strong></p>
<p>&nbsp;</p>
<p>读写代码如下：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008080;"> 1</span> <span style="color: #0000ff;">using</span><span style="color: #000000;"> Spire.Xls;
</span><span style="color: #008080;"> 2</span> 
<span style="color: #008080;"> 3</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> btnSpire_Click(<span style="color: #0000ff;">object</span><span style="color: #000000;"> sender, EventArgs e)
</span><span style="color: #008080;"> 4</span> <span style="color: #000000;">        {
</span><span style="color: #008080;"> 5</span>             <span style="color: #0000ff;">string</span> importExcelPath = <span style="color: #800000;">"</span><span style="color: #800000;">E:\\import.xlsx</span><span style="color: #800000;">"</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 6</span>             <span style="color: #0000ff;">string</span> exportExcelPath = <span style="color: #800000;">"</span><span style="color: #800000;">E:\\export.xlsx</span><span style="color: #800000;">"</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 7</span> 
<span style="color: #008080;"> 8</span>             Spire.Xls.Workbook workbook = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Spire.Xls.Workbook();
</span><span style="color: #008080;"> 9</span> <span style="color: #000000;">            workbook.LoadFromFile(importExcelPath);
</span><span style="color: #008080;">10</span>             <span style="color: #008000;">//</span><span style="color: #008000;">处理Excel数据，更多请参考官方Demo</span>
<span style="color: #008080;">11</span>             Spire.Xls.Worksheet sheet = workbook.Worksheets[<span style="color: #800080;">0</span><span style="color: #000000;">];
</span><span style="color: #008080;">12</span>             sheet.Range[<span style="color: #800080;">1</span>,<span style="color: #800080;">1</span>].Text = <span style="color: #800000;">"</span><span style="color: #800000;">test</span><span style="color: #800000;">"</span>;<span style="color: #008000;">//</span><span style="color: #008000;">该方法也是从1开始，非0</span>
<span style="color: #008080;">13</span> 
<span style="color: #008080;">14</span> <span style="color: #000000;">            workbook.SaveToFile(exportExcelPath);
</span><span style="color: #008080;">15</span>         }</pre>
</div>
<p><strong>5. EPPLUS</strong>　　</p>
<p>地址：https://github.com/pruiz/EPPlus/tree/master/EPPlus</p>
<p>没用过这个，暂时就不做介绍了</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>