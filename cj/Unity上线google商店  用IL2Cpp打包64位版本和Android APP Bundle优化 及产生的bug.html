<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修Unity上线google商店  用IL2Cpp打包64位版本和Android APP Bundle优化 及产生的bug' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>Unity上线google商店  用IL2Cpp打包64位版本和Android APP Bundle优化 及产生的bug</center></div><div class='banquan'>原文出处:本文由博客园博主INSIST_JY提供。<br/>
原文连接:https://www.cnblogs.com/INSIST-NLJY/p/11044558.html</div><br>
    <p>ios刚上线，这边着手改成android版本，我开始使用的是unity2017.4.1版本</p>
<p>上传谷歌商店是出现这两个警告：</p>
<p><img src="./images/Unity上线google商店  用IL2Cpp打包64位版本和Android APP Bundle优化 及产生的bug0.png" alt="" /></p>
<p>&nbsp;</p>
<p>要支持64位，但是在2017版本上没有找到64位的打包选项，猜测应该是版本的问题，上网查询果然是</p>
<p>以下是我查询的：</p>
<p>https://www.cnblogs.com/cnxkey/articles/9760391.html</p>
<p>http://tieba.baidu.com/p/5496282855</p>
<p>http://dy.163.com/v2/article/detail/E9LQND6M0526E124.html</p>
<p>怎样打包64位和Androi APP Bundle上面他们讲解的都很详细，而且还讲解了为什么google要支持64位，非常感谢他们分享。</p>
<p><span style="text-decoration: underline;"><strong><span style="color: #000000; text-decoration: underline;">一：我下载了新的unity2018.4.1，开始先键一个demo，里面就随便建了个ui，然后开始打包</span></strong></span></p>
<p><span style="color: #808000;"><strong>1:在PlaySettings-&gt;other settings-&gt;Scriptiing Backend 选择IL2CPP（默认是Mono）,</strong></span></p>
<p><span style="color: #808000;"><strong>c++ Compiler Configuration 选择Release</strong></span></p>
<p><span style="color: #808000;"><strong>Target Architectures 里面的Arm64就是可以说勾选的了，勾选打包即可</strong></span></p>
<p><span style="color: #808000;"><strong>2:Androi APP Bundley优化在Build Sttings 勾选Build App Bundle（Google Play）即可，打出的是aab包</strong></span></p>
<p><span style="color: #808000;"><strong>&nbsp;打包运行成功。</strong></span></p>
<p><span style="color: #808000;"><strong>注：要死测试的话就用Mono打包吧，毕竟IL2CPP打包要慢上几倍</strong></span></p>
<p><span style="text-decoration: underline; background-color: #ffffff;"><strong><span style="color: #333333; text-decoration: underline;">二：2017.4.1转成2018.4.1时产生的部分bug</span></strong></span></p>
<p><span style="background-color: #ffffff; color: #0000ff;"><strong>1:google admob 产生广告bug</strong></span></p>
<p><span style="background-color: #ffffff; color: #0000ff;"><strong>在2017.4.1广告是没问题的，移植到2018版本出现此问题</strong></span></p>
<p>E/Unity: AndroidJavaException: java.lang.ClassNotFoundException: com.google.android.gms.ads.AdRequest$Builder<br />    java.lang.ClassNotFoundException: com.google.android.gms.ads.AdRequest$Builder<br />        at java.lang.Class.classForName(Native Method)<br />        at java.lang.Class.forName(Class.java:308)<br />        at java.lang.Class.forName(Class.java:272)<br />        at com.unity3d.player.UnityPlayer.nativeRender(Native Method)<br />        at com.unity3d.player.UnityPlayer.c(Unknown Source)<br />        at com.unity3d.player.UnityPlayer$e$2.queueIdle(Unknown Source)<br />        at android.os.MessageQueue.next(MessageQueue.java:211)<br />        at android.os.Looper.loop(Looper.java:122)<br />        at com.unity3d.player.UnityPlayer$e.run(Unknown Source)<br />     Caused by: java.lang.ClassNotFoundException: Didn't find class "com.google.android.gms.ads.AdRequest$Builder" on path: DexPathList[[zip file "/data/app/com.newqwx.crushminer-1/base.apk"],nativeLibraryDirectories=[/data/app/com.newqwx.crushminer-1/lib/arm, /vendor/lib, /system/lib]]<br />        at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:56)<br />    	at java.la</p>
<p> beginning of crash</p>
<p>&nbsp;E/AndroidRuntime: FATAL EXCEPTION: main<br />    Process: com.newqwx.crushminer, PID: 13331<br />    java.lang.Error: FATAL EXCEPTION [main]<br />    Unity version     : 2018.4.1f1<br />    Device model      : motorola Nexus 6<br />    Device fingerprint: google/shamu/shamu:5.0/LRX21O/1570415:user/release-keys<br />    <br />    Caused by: java.lang.NoClassDefFoundError: Failed resolution of: Lcom/google/android/gms/ads/MobileAds;<br />        at com.google.unity.ads.RewardBasedVideo$1.run(RewardBasedVideo.java:65)<br />        at android.os.Handler.handleCallback(Handler.java:739)<br />        at android.os.Handler.dispatchMessage(Handler.java:95)<br />        at android.os.Looper.loop(Looper.java:135)<br />        at android.app.ActivityThread.main(ActivityThread.java:5221)<br />        at java.lang.reflect.Method.invoke(Native Method)<br />        at java.lang.reflect.Method.invoke(Method.java:372)<br />        at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:899)<br />        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:694)<br />     Caused by: java.lang.ClassNotFoundException: Didn't find class "com.google.android.gms.ads.MobileAds" on path: DexPathList[[zip file "/data/app/com.newqwx.crushminer-1/base.apk"],nativeLibraryDirectories=[/data/app/com.newqwx.crushminer-1/lib/arm, /vendor/lib, /system/lib]]<br />        at dalvik.system.BaseDexClassLoader.findClass(BaseDexClassLoader.java:56)<br />        at java.lang.ClassLoader.loadClass(ClassLoader.java:511)<br />        at java.lang.ClassLoader.loadClass(ClassLoader.java:469)<br />        at com.google.unity.ads.RewardBasedVideo$1.run(RewardBasedVideo.java:65)?<br />        at android.os.Handler.handleCallback(Handler.java:739)?<br />        at android.os.Handler.dispatchMessage(Handler.java:95)?<br />        at android.os.Looper.loop(Looper.java:135)?<br />        at android.app.ActivityThread.main(ActivityThread.java:5221)?<br />        at java.lang.reflect.Method.invoke(Native Method)?<br />        at java.lang.reflect.Method.invoke(Method.java:372)?<br />        at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:899)?<br />        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:694)?<br />    	Suppressed: java.lang.ClassNotFoundException: com.google.android.gms.ads.MobileAds<br />        at java.lang.Class.classForName(Native Method)<br />        at java.lang.BootClassLoader.findClass(ClassLoader.java:781)<br />        at java.lang.BootClassLoader.loadClass(ClassLoader.java:841)<br />        at java.lang.ClassLoader.loadClass(ClassLoader.java:504)<br />        		... 10 more<br />     Caused by: java.lang.NoClassDefFoundError: Class not found using the boot class loader; no stack available</p>
<p><span style="color: #808000; background-color: #ffffff;"><strong>解决方法：Assets-&gt;Play services Resolver -&gt;Android Resolver-&gt;Resolve 解决</strong></span></p>
<p><span style="color: #808000; background-color: #ffffff;"><strong>但由此可能产生下面打包的bug</strong></span></p>
<p><span style="color: #0000ff;"><strong>2：产生的打包的Gradle错误</strong></span></p>
<p>CommandInvokationFailure: Gradle build failed. <br />D:/java/jdk1.8.0_181\bin\java.exe -classpath "D:\Unity2018.4\Editor\Data\PlaybackEngines\AndroidPlayer\Tools\gradle\lib\gradle-launcher-4.6.jar" org.gradle.launcher.GradleMain "-Dorg.gradle.jvmargs=-Xmx4086m" "assembleRelease"</p>
<p>stderr[<br />D8: Program type already present: android.support.v4.accessibilityservice.AccessibilityServiceInfoCompat</p>
<p>FAILURE: Build failed with an exception.</p>
<p>* What went wrong:<br />Execution failed for task ':transformDexArchiveWithExternalLibsDexMergerForRelease'.<br />&gt; com.android.builder.dexing.DexArchiveMergerException: Error while merging dex archives: F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\27.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\35.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\73.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\31.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\74.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\57.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\29.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\34.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\58.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\36.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\26.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\32.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\37.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\30.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\65.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\22.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\48.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\0.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\14.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\1.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\23.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\9.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\49.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\41.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\15.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\59.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\7.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\46.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\33.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\63.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\16.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\40.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\6.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\8.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\47.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\64.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\21.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\17.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\52.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\60.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\51.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\44.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\18.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\4.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\45.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\28.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\53.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\10.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\19.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\50.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\5.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\54.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\11.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\2.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\24.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\38.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\12.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\25.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\62.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\55.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\42.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\39.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\61.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\43.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\13.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\56.jar, F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\3.jar<br />  Learn how to resolve the issue at https://developer.android.com/studio/build/dependencies#duplicate_classes.<br />  Program type already present: android.support.v4.accessibilityservice.AccessibilityServiceInfoCompat</p>
<p>* Try:<br />Run with --stacktrace option to get the stack trace. Run with --info or --debug option to get more log output. Run with --scan to get full insights.</p>
<p>* Get more help at https://help.gradle.org</p>
<p>BUILD FAILED in 1m 7s<br />]<br />stdout[<br />Observed package id 'tools' in inconsistent location 'F:\Environment\SDK\Android_SDK_Tools\android-sdk-windows\tempToolsDir' (Expected 'F:\Environment\SDK\Android_SDK_Tools\android-sdk-windows\tools')<br />:checkReleaseClasspath<br />:preBuild UP-TO-DATE<br />:GoogleMobileAdsPlugin:preBuild UP-TO-DATE<br />:GoogleMobileAdsPlugin:preReleaseBuild UP-TO-DATE<br />:GoogleMobileAdsPlugin:checkReleaseManifest<br />:GoogleMobileAdsPlugin:processReleaseManifest<br />:IronSource:preBuild UP-TO-DATE<br />:IronSource:preReleaseBuild UP-TO-DATE<br />:IronSource:checkReleaseManifest<br />:IronSource:processReleaseManifest<br />:unity-android-resources:preBuild UP-TO-DATE<br />:unity-android-resources:preReleaseBuild UP-TO-DATE<br />:unity-android-resources:checkReleaseManifest<br />:unity-android-resources:processReleaseManifest<br />:preReleaseBuild<br />:GoogleMobileAdsPlugin:compileReleaseAidl NO-SOURCE<br />:IronSource:compileReleaseAidl NO-SOURCE<br />:unity-android-resources:compileReleaseAidl NO-SOURCE<br />:compileReleaseAidl NO-SOURCE<br />:GoogleMobileAdsPlugin:packageReleaseRenderscript NO-SOURCE<br />:IronSource:packageReleaseRenderscript NO-SOURCE<br />:unity-android-resources:packageReleaseRenderscript NO-SOURCE<br />:compileReleaseRenderscript UP-TO-DATE<br />:checkReleaseManifest UP-TO-DATE<br />:generateReleaseBuildConfig<br />:prepareLintJar UP-TO-DATE<br />:mainApkListPersistenceRelease<br />:generateReleaseResValues UP-TO-DATE<br />:generateReleaseResources UP-TO-DATE<br />:GoogleMobileAdsPlugin:compileReleaseRenderscript<br />:GoogleMobileAdsPlugin:generateReleaseResValues<br />:GoogleMobileAdsPlugin:generateReleaseResources<br />:GoogleMobileAdsPlugin:packageReleaseResources<br />:IronSource:compileReleaseRenderscript<br />:IronSource:generateReleaseResValues<br />:IronSource:generateReleaseResources<br />:IronSource:packageReleaseResources<br />:unity-android-resources:compileReleaseRenderscript<br />:unity-android-resources:generateReleaseResValues<br />:unity-android-resources:generateReleaseResources<br />:unity-android-resources:packageReleaseResources<br />:mergeReleaseResources UP-TO-DATE<br />:createReleaseCompatibleScreenManifests<br />:processReleaseManifest<br />:splitsDiscoveryTaskRelease UP-TO-DATE<br />:GoogleMobileAdsPlugin:generateReleaseRFile<br />:IronSource:generateReleaseRFile<br />:unity-android-resources:generateReleaseRFile<br />:processReleaseResources<br />:generateReleaseSources<br />:GoogleMobileAdsPlugin:generateReleaseBuildConfig<br />:GoogleMobileAdsPlugin:prepareLintJar UP-TO-DATE<br />:GoogleMobileAdsPlugin:generateReleaseSources<br />:GoogleMobileAdsPlugin:javaPreCompileRelease<br />:GoogleMobileAdsPlugin:compileReleaseJavaWithJavac<br />:GoogleMobileAdsPlugin:processReleaseJavaRes NO-SOURCE<br />:GoogleMobileAdsPlugin:transformClassesAndResourcesWithPrepareIntermediateJarsForRelease<br />:IronSource:generateReleaseBuildConfig<br />:IronSource:prepareLintJar UP-TO-DATE<br />:IronSource:generateReleaseSources<br />:IronSource:javaPreCompileRelease<br />:IronSource:compileReleaseJavaWithJavac<br />:IronSource:processReleaseJavaRes NO-SOURCE<br />:IronSource:transformClassesAndResourcesWithPrepareIntermediateJarsForRelease<br />:unity-android-resources:generateReleaseBuildConfig<br />:unity-android-resources:prepareLintJar UP-TO-DATE<br />:unity-android-resources:generateReleaseSources<br />:unity-android-resources:javaPreCompileRelease<br />:unity-android-resources:compileReleaseJavaWithJavac<br />:unity-android-resources:processReleaseJavaRes NO-SOURCE<br />:unity-android-resources:transformClassesAndResourcesWithPrepareIntermediateJarsForRelease<br />:javaPreCompileRelease<br />:compileReleaseJavaWithJavac<br />:compileReleaseNdk NO-SOURCE<br />:compileReleaseSources<br />:lintVitalRelease<br />:mergeReleaseShaders UP-TO-DATE<br />:compileReleaseShaders UP-TO-DATE<br />:generateReleaseAssets UP-TO-DATE<br />:GoogleMobileAdsPlugin:mergeReleaseShaders<br />:GoogleMobileAdsPlugin:compileReleaseShaders<br />:GoogleMobileAdsPlugin:generateReleaseAssets<br />:GoogleMobileAdsPlugin:packageReleaseAssets<br />:IronSource:mergeReleaseShaders<br />:IronSource:compileReleaseShaders<br />:IronSource:generateReleaseAssets<br />:IronSource:packageReleaseAssets<br />:unity-android-resources:mergeReleaseShaders<br />:unity-android-resources:compileReleaseShaders<br />:unity-android-resources:generateReleaseAssets<br />:unity-android-resources:packageReleaseAssets<br />:mergeReleaseAssets<br />:transformClassesWithDexBuilderForRelease<br />C:\Users\Administrator\.gradle\caches\transforms-1\files-1.1\recyclerview-v7.aar\abd41c74047d7be064a61e8696b02349\jars\classes.jar: D8: Type `android.support.v4.animation.AnimatorCompatHelper` was not found, it is required for default or static interface methods desugaring of `void android.support.v7.widget.DefaultItemAnimator.resetAnimation(android.support.v7.widget.RecyclerView$ViewHolder)`<br />C:\Users\Administrator\.gradle\caches\transforms-1\files-1.1\recyclerview-v7.aar\abd41c74047d7be064a61e8696b02349\jars\classes.jar: D8: Interface `android.support.v4.animation.AnimatorListenerCompat` not found. It's needed to make sure desugaring of `android.support.v7.widget.helper.ItemTouchHelper$RecoverAnimation` is correct. Desugaring will assume that this interface has no default method.<br />C:\Users\Administrator\.gradle\caches\transforms-1\files-1.1\recyclerview-v7.aar\abd41c74047d7be064a61e8696b02349\jars\classes.jar: D8: Interface `android.support.v4.animation.AnimatorUpdateListenerCompat` not found. It's needed to make sure desugaring of `android.support.v7.widget.helper.ItemTouchHelper$RecoverAnimation$1` is correct. Desugaring will assume that this interface has no default method.<br />:transformDexArchiveWithExternalLibsDexMergerForRelease FAILED<br />63 actionable tasks: 52 executed, 11 up-to-date<br />]<br />exit code: 1<br />UnityEditor.Android.Command.WaitForProgramToRun (UnityEditor.Utils.Program p, UnityEditor.Android.WaitingForProcessToExit waitingForProcessToExit, System.String errorMsg)<br />UnityEditor.Android.Command.Run (System.Diagnostics.ProcessStartInfo psi, UnityEditor.Android.WaitingForProcessToExit waitingForProcessToExit, System.String errorMsg)<br />UnityEditor.Android.Command.Run (System.String command, System.String args, System.String workingdir, UnityEditor.Android.WaitingForProcessToExit waitingForProcessToExit, System.String errorMsg)<br />UnityEditor.Android.AndroidJavaTools.RunJava (System.String args, System.String workingdir, System.Action`1 progress, System.String error)<br />UnityEditor.Android.GradleWrapper.Run (UnityEditor.Android.AndroidJavaTools javaTools, System.String workingdir, System.String task, System.Action`1 progress)<br />Rethrow as GradleInvokationException: Gradle build failed<br />UnityEditor.Android.GradleWrapper.Run (UnityEditor.Android.AndroidJavaTools javaTools, System.String workingdir, System.String task, System.Action`1 progress)<br />UnityEditor.Android.PostProcessor.Tasks.BuildGradleProject.Execute (UnityEditor.Android.PostProcessor.PostProcessorContext context)</p>
<p>&nbsp;</p>
<p><strong><span style="color: #808000;">解决方法:出现这种问题是jar包重复。</span></strong></p>
<p><strong><span style="color: #808000;">Temp\gradleOut\build\intermediates\transforms\dexBuilder\release\3.jar（我的最后一个是3.jar，可能不一样）中可以看到：Program type already present: android.support.v4.accessibilityservice.AccessibilityServiceInfoCompat</span></strong><br /><strong><span style="color: #808000;">说明android.support.v4已经存在，就是说有两个，一个新的一个旧的，找到删掉就可以</span></strong></p>
<p><strong><span style="color: #808000;">我的是 support-v4-compat.jar和刚刚导入的 com.android.support.support-v4-26.1.0重复，我删掉了support-v4-compat.jar，就可以打包了</span></strong></p>
<p>&nbsp;</p>
<p><span style="color: #0000ff;"><strong>3：IL2CPP打包时中断，停止运行</strong></span></p>
<p>&nbsp;</p>
<p>Failed running D:\Unity2018.4\Editor\Data\il2cpp/build/il2cpp.exe --convert-to-cpp --emit-null-checks --enable-array-bounds-check --dotnetprofile="net20" --compile-cpp --libil2cpp-static --platform="Android" --architecture="ARMv7" --configuration="Release" --outputpath="F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp/StagingArea\assets\bin\Data\Native\armeabi-v7a\libil2cpp.so" --cachedirectory="F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Assets\..\Library\il2cpp_android_armeabi-v7a/il2cpp_cache" --additional-include-directories="D:\Unity2018.4\Editor\Data\PlaybackEngines\AndroidPlayer/Tools\bdwgc/include" --additional-include-directories="D:\Unity2018.4\Editor\Data\PlaybackEngines\AndroidPlayer/Tools\libil2cpp/include" --tool-chain-path="F:/Environment/NDK/android-ndk-r16b-windows-x86_64/android-ndk-r16b" --map-file-parser="D:\Unity2018.4\Editor\Data\Tools\MapFileParser\MapFileParser.exe" --directory="F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\StagingArea\assets\bin\Data\Managed" --generatedcppdir="F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\StagingArea\Il2Cpp\il2cppOutput"</p>
<p>stdout:<br />Building libil2cpp.so with AndroidToolChain<br />	Output directory: F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\StagingArea\assets\bin\Data\Native\armeabi-v7a<br />	Cache directory: F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Library\il2cpp_android_armeabi-v7a\il2cpp_cache<br />ObjectFiles: 644 of which compiled: 0<br />Total compilation time: 995 milliseconds.<br />il2cpp.exe didn't catch exception: Unity.IL2CPP.Building.BuilderFailedException: F:\Environment\NDK\android-ndk-r16b-windows-x86_64\android-ndk-r16b\toolchains\llvm\prebuilt\windows-x86_64\bin\clang++ @"C:\Users\Administrator\AppData\Local\Temp\tmp4146.tmp" -o "F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Library\il2cpp_android_armeabi-v7a\il2cpp_cache\linkresult_37EBD535B6A775512618C151CBF4CE6A\libil2cpp.so" -shared -Wl,-soname,libil2cpp.so -Wl,--no-undefined -Wl,-z,noexecstack -Wl,--gc-sections -Wl,--build-id --sysroot "F:\Environment\NDK\android-ndk-r16b-windows-x86_64\android-ndk-r16b\platforms\android-16\arch-arm" -gcc-toolchain "F:\Environment\NDK\android-ndk-r16b-windows-x86_64\android-ndk-r16b\toolchains\arm-linux-androideabi-4.9\prebuilt\windows-x86_64" -target armv7-none-linux-androideabi -Wl,--wrap,sigaction -L "F:\Environment\NDK\android-ndk-r16b-windows-x86_64\android-ndk-r16b\sources\cxx-stl\gnu-libstdc++\4.9\libs\armeabi-v7a" -lgnustl_static -llog -rdynamic -fuse-ld=gold.exe</p>
<p>F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\StagingArea\Il2Cpp\il2cppOutput/Bulk_Assembly-CSharp_9.cpp:34995: error: undefined reference to '_copyToPasteboardWithText'<br />F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\StagingArea\Il2Cpp\il2cppOutput/Bulk_Assembly-CSharp_9.cpp:35099: error: undefined reference to '_shareWithText'<br />clang++.exe: error: linker command failed with exit code 1 (use -v to see invocation)</p>
<p><br />   在 Unity.IL2CPP.Building.CppProgramBuilder.PostprocessObjectFiles(HashSet`1 objectFiles, CppToolChainContext toolChainContext)<br />   在 Unity.IL2CPP.Building.CppProgramBuilder.Build(IBuildStatistics&amp; statistics)<br />   在 il2cpp.Program.DoRun(String[] args)<br />   在 il2cpp.Program.Run(String[] args)<br />   在 il2cpp.Program.Main(String[] args)<br />stderr:</p>
<p>未经处理的异常:  Unity.IL2CPP.Building.BuilderFailedException: F:\Environment\NDK\android-ndk-r16b-windows-x86_64\android-ndk-r16b\toolchains\llvm\prebuilt\windows-x86_64\bin\clang++ @"C:\Users\Administrator\AppData\Local\Temp\tmp4146.tmp" -o "F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Library\il2cpp_android_armeabi-v7a\il2cpp_cache\linkresult_37EBD535B6A775512618C151CBF4CE6A\libil2cpp.so" -shared -Wl,-soname,libil2cpp.so -Wl,--no-undefined -Wl,-z,noexecstack -Wl,--gc-sections -Wl,--build-id --sysroot "F:\Environment\NDK\android-ndk-r16b-windows-x86_64\android-ndk-r16b\platforms\android-16\arch-arm" -gcc-toolchain "F:\Environment\NDK\android-ndk-r16b-windows-x86_64\android-ndk-r16b\toolchains\arm-linux-androideabi-4.9\prebuilt\windows-x86_64" -target armv7-none-linux-androideabi -Wl,--wrap,sigaction -L "F:\Environment\NDK\android-ndk-r16b-windows-x86_64\android-ndk-r16b\sources\cxx-stl\gnu-libstdc++\4.9\libs\armeabi-v7a" -lgnustl_static -llog -rdynamic -fuse-ld=gold.exe</p>
<p>F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\StagingArea\Il2Cpp\il2cppOutput/Bulk_Assembly-CSharp_9.cpp:34995: error: undefined reference to '_copyToPasteboardWithText'<br />F:\Unity\CrushMiner\CrushMiner9.11Optimize2018.4.1\Temp\StagingArea\Il2Cpp\il2cppOutput/Bulk_Assembly-CSharp_9.cpp:35099: error: undefined reference to '_shareWithText'<br />clang++.exe: error: linker command failed with exit code 1 (use -v to see invocation)</p>
<p><br />   在 Unity.IL2CPP.Building.CppProgramBuilder.PostprocessObjectFiles(HashSet`1 objectFiles, CppToolChainContext toolChainContext)<br />   在 Unity.IL2CPP.Building.CppProgramBuilder.Build(IBuildStatistics&amp; statistics)<br />   在 il2cpp.Program.DoRun(String[] args)<br />   在 il2cpp.Program.Run(String[] args)<br />   在 il2cpp.Program.Main(String[] args)</p>
<p>UnityEngine.Debug:LogError(Object)<br />UnityEditorInternal.Runner:RunProgram(Program, String, String, String, CompilerOutputParserBase) (at C:/buildslave/unity/build/Editor/Mono/BuildPipeline/BuildUtils.cs:128)<br />UnityEditorInternal.Runner:RunManagedProgram(String, String, String, CompilerOutputParserBase, Action`1) (at C:/buildslave/unity/build/Editor/Mono/BuildPipeline/BuildUtils.cs:73)<br />UnityEditorInternal.IL2CPPBuilder:RunIl2CppWithArguments(List`1, Action`1, String) (at C:/buildslave/unity/build/Editor/Mono/BuildPipeline/Il2Cpp/IL2CPPUtils.cs:368)<br />UnityEditorInternal.IL2CPPBuilder:ConvertPlayerDlltoCpp(String, String, String, Boolean) (at C:/buildslave/unity/build/Editor/Mono/BuildPipeline/Il2Cpp/IL2CPPUtils.cs:349)<br />UnityEditorInternal.IL2CPPBuilder:Run() (at C:/buildslave/unity/build/Editor/Mono/BuildPipeline/Il2Cpp/IL2CPPUtils.cs:211)<br />UnityEditorInternal.IL2CPPUtils:RunIl2Cpp(String, String, IIl2CppPlatformProvider, Action`1, RuntimeClassRegistry) (at C:/buildslave/unity/build/Editor/Mono/BuildPipeline/Il2Cpp/IL2CPPUtils.cs:35)<br />UnityEngine.GUIUtility:ProcessEvent(Int32, IntPtr)</p>
<p>&nbsp;</p>
<p><strong><span style="color: #808000;">解决方法：查看中断信息：</span></strong></p>
<p><strong><span style="color: #808000;">在未经处理的异常:下面一段找到error，error: undefined reference to '_copyToPasteboardWithText'</span></strong></p>
<p><strong><span style="color: #808000;">error：undefined reference to '_shareWithText'，说未定义的引用。</span></strong><br /><strong><span style="color: #808000;">&nbsp;这个可能是你ios的调用方法（我的是ios的方法），然后在代码中找到用条件编译命令#if改掉就ok了</span></strong></p>
<p><strong><span style="color: #808000;">我的方法</span></strong></p>
<p><strong><span style="color: #808000;"> [DllImport("__Internal")]</span></strong><br /><strong><span style="color: #808000;">        private static extern void _copyToPasteboardWithText(string text);</span></strong></p>
<p><strong><span style="color: #808000;">改成</span></strong><br /><strong><span style="color: #808000;">#if UNITY_IOS</span></strong><br /><strong><span style="color: #808000;">        [DllImport("__Internal")]</span></strong><br /><strong><span style="color: #808000;">        private static extern void _copyToPasteboardWithText(string text);</span></strong><br /><strong><span style="color: #808000;">#endif</span></strong></p>
<p>&nbsp;</p>
<p><span style="color: #993300;">所有问题解决，完美打包运行！！！</span></p>
<p>&nbsp;</p>
<p><span style="color: #cc99ff;">有什么问题或错误的地方欢迎讨论指正，谢谢。</span></p>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>