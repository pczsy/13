<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修.NET进阶篇06-async异步、thread多线程1' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>.NET进阶篇06-async异步、thread多线程1</center></div><div class='banquan'>原文出处:本文由博客园博主那是山提供。<br/>
原文连接:https://www.cnblogs.com/xibei/p/11826498.html</div><br>
    <div id="output_wrapper_id" class="output_wrapper" style="font-size: 16px; color: #3e3e3e; line-height: 1.6; word-spacing: 0px; letter-spacing: 0px; font-family: 'Helvetica Neue', Helvetica, 'Hiragino Sans GB', 'Microsoft YaHei', Arial, sans-serif;">
<blockquote style="line-height: inherit; display: block; padding: 15px 15px 15px 1rem; font-size: 0.9em; margin: 1em 0px; color: #819198; border-left: 6px solid #dce6f0; background: #f2f7fb; overflow: auto; word-wrap: normal; word-break: normal;">
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;">知识需要不断积累、总结和沉淀，思考和写作是成长的催化剂</p>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;">异步多线程挺大一块内容，既想拆开慢慢学，又想一股脑全倒出。纠结再三，还是拆开吃透，也不至于篇幅过长，劝退许多人</p>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 0px;">本篇先做一个概述，列明一些基本概念</p>
</blockquote>
<h3 id="h" style="line-height: inherit; margin: 5px 0px; font-weight: bold; font-size: 1.3em; margin-bottom: 15px; margin-right: 5px; padding: 4px 8px; letter-spacing: 2px; background-color: #bbb180; color: #ffffff; border-radius: 5px; text-shadow: #666666 1px 1px 1px; box-shadow: #666666 1px 1px 2px;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">内容目录</span></h3>
<p id="tocid_0" class="toc" style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px; margin-left: 25px;"><span class="toc_item" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><a style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: #1e6bb8; word-wrap: break-word;" href="#h-1">一、进程和线程</a></span></span><span class="toc_item" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><a style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: #1e6bb8; word-wrap: break-word;" href="#h1">1、进程</a></span></span></span><span class="toc_item" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><a style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: #1e6bb8; word-wrap: break-word;" href="#h2">2、线程</a></span></span></span><span class="toc_item" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><a style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: #1e6bb8; word-wrap: break-word;" href="#h-2">多线程</a></span></span></span></span><span class="toc_item" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><a style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: #1e6bb8; word-wrap: break-word;" href="#h-3">后台线程</a></span></span></span></span><span class="toc_item" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><a style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: #1e6bb8; word-wrap: break-word;" href="#h3">3、简言之</a></span></span></span><span class="toc_item" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><a style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: #1e6bb8; word-wrap: break-word;" href="#h4">4、适用场景</a></span></span></span><span class="toc_item" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><a style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: #1e6bb8; word-wrap: break-word;" href="#h-4">二、同步和异步</a></span></span><span class="toc_item" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><a style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: #1e6bb8; word-wrap: break-word;" href="#h1-1">1、同步</a></span></span></span><span class="toc_item" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><a style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: #1e6bb8; word-wrap: break-word;" href="#h2-1">2、异步</a></span></span></span><span class="toc_item" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><a style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: #1e6bb8; word-wrap: break-word;" href="#h3-1">3、异步编程</a></span></span></span><span class="toc_item" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><a style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: #1e6bb8; word-wrap: break-word;" href="#h4asyncawait">4、Async、Await</a></span></span></span><span class="toc_item" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><a style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: #1e6bb8; word-wrap: break-word;" href="#h5">5、异步操作优缺点</a></span></span></span><span class="toc_item" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; display: block;"><span class="toc_left" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; margin-left: 25px;"><a style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; text-decoration: none; color: #1e6bb8; word-wrap: break-word;" href="#h-5">三、小结</a></span></span></p>
<h3 id="h-1" style="line-height: inherit; margin: 5px 0px; font-weight: bold; font-size: 1.3em; margin-bottom: 15px; margin-right: 5px; padding: 4px 8px; letter-spacing: 2px; background-color: #bbb180; color: #ffffff; border-radius: 5px; text-shadow: #666666 1px 1px 1px; box-shadow: #666666 1px 1px 2px;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">一、进程和线程</span></h3>
<h4 id="h1" style="color: inherit; line-height: inherit; padding: 0px; margin: 5px 0px; font-weight: bold; font-size: 1.2em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">1、进程</span></h4>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px;">我们打开计算机的任务管理器，会发现系统的很多个进程，每个进程独占CPU、内存、磁盘、网络等资源，是资源分配的最小单元。<strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><code>多个进程之间是资源隔离</code></strong>的，数据之间不能直接传递。一个exe运行一次就会产生一个进程，运行多次就多个，但他们之间数据互相隔离</p>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px;"><img src="./images/.NET进阶篇06-async异步、thread多线程10.png" alt="" /></p>
<h4 id="h2" style="color: inherit; line-height: inherit; padding: 0px; margin: 5px 0px; font-weight: bold; font-size: 1.2em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">2、线程</span></h4>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px;">同样在任务管理器中我们也能看到线程，<strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><code>一个进程是由多个线程组成的，且至少是由一个线程</code></strong>，那就是主线程。图中就可以看到线程的数量要比进程大的多</p>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px;"><img src="./images/.NET进阶篇06-async异步、thread多线程11.png" alt="" /></p>
<h5 id="h-2" style="color: inherit; line-height: inherit; padding: 0px; margin: 5px 0px; font-weight: bold; font-size: 1em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">多线程</span></h5>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px;">衡量一个人干活快，要么是一件事干的很快，要么是他能同时干很多事。计算机就是如此，以单核CPU类比单个人，理论上单位时间上只能运行一个进程里一个线程，只能干一件事。但线程有可能在某些操作比如读写磁盘时会等待，这时候磁盘在疯狂的运转，CPU却是闲置状态，直到磁盘读写完成才CPU才继续工作，所以空闲的这个时候它可以先去干别的事情，看起开就像单核它也可以同时干很多事</p>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px;">一个人可以把水壶烧上水的同时去拖地，同一时刻一个人是只能干一件事的，只是在快速的频繁切换，拖地时一直想着水开了没开了没，但如果处理不当，多线程效率还低，就像你没来及去倒已经烧开的水导致干锅，还有些任务同时起来更费时，就像你一边拖地一遍广播体操一样，伸展运动123然后拖一下地，然后接着，唉？到哪里了&hellip;</p>
<h5 id="h-3" style="color: inherit; line-height: inherit; padding: 0px; margin: 5px 0px; font-weight: bold; font-size: 1em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">后台线程</span></h5>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px;"><strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><code>后台线程不会阻止进程的关闭</code></strong>。当某个程序的所有前台线程完成后，进程就终止程序退出了，当然后台线程也会随即停止。在.NET中用<strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><code>Thread</code></strong>创建的线程默认都是前台线程，用<strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><code>线程池、BeginXXX</code></strong>等启用的线程都是后台线程</p>
<h4 id="h3" style="color: inherit; line-height: inherit; padding: 0px; margin: 5px 0px; font-weight: bold; font-size: 1.2em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">3、简言之</span></h4>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px;"><strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><code>线程是独立执行单元</code></strong>，同一段代码（参数不同，任务不同）可以交给多个线程去执行，从宏观上看就是并行的执行，微观上时间片上还是串行执行的。但多核CPU就另说了，像多个人一样，一个人负责做饭，一个负责拖地</p>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px;">多线可以提高CPU的利用率，一个线程等待时，可以先去执行其他的任务，当然，线程之间的切换也是需要消耗资源的，开发复杂度也是会变大的，资源争夺也需要做合理的控制，也并不是所有的任务都适合多线程</p>
<h4 id="h4" style="color: inherit; line-height: inherit; padding: 0px; margin: 5px 0px; font-weight: bold; font-size: 1.2em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">4、适用场景</span></h4>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px;"><strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><code>后台执行耗时任务</code></strong>，前台界面仍需要友好的展示。在WinForm中，如果单线程（也就是主线程）如果执行耗时的操作，那么界面就会失去响应，它忙于后台的任务，无法更新用户界面的交互。这个时候可以另开一个工作线程来处理耗时的任务，主线程可以响应用户操作，也可以随时改变任务的状态</p>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px;">在没有界面的程序里，当一个任务有<strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><code>潜在的耗时</code></strong>时，比如等待远程服务器的响应返回，用工作线程来完成任务可以让主线程去做其他事情</p>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px;"><strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><code>复杂的计算</code></strong>，多线程在多核CPU上可以更快的完成任务。总之一切都是为了<strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><code>效率</code></strong>，.NET中很多暗中的多线程，比如timer，backgroudworker，webservices等，我们使用中自然而然就在利用其多线程带来的好处，在了解了基本原理后，我们需要手动创建管理明面上的多线程任务</p>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px;">多线程纵然可以提高你的程序流畅度，但开发调试中确实增大了难度，一方面除了要对业务划分适应多线程的处理模式，另一个方面多线程最终还是交于操作系统的调度，我们虽可以执行一些优化调度，但最终结果并不是总尽人意，线程之间的切换也会消耗资源，所以多线程的设计应该尽量简单</p>
<h3 id="h-4" style="line-height: inherit; margin: 5px 0px; font-weight: bold; font-size: 1.3em; margin-bottom: 15px; margin-right: 5px; padding: 4px 8px; letter-spacing: 2px; background-color: #bbb180; color: #ffffff; border-radius: 5px; text-shadow: #666666 1px 1px 1px; box-shadow: #666666 1px 1px 2px;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">二、同步和异步</span></h3>
<h4 id="h1-1" style="color: inherit; line-height: inherit; padding: 0px; margin: 5px 0px; font-weight: bold; font-size: 1.2em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">1、同步</span></h4>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px;">同步方法调用在程序继续执行之前需要等待同步方法执行完毕返回结果，程序自上而下顺序执行，没完成一个指令，在进行下一个指令。在代码调试的表现为，光标一步一步完成上一步计算后，才会进入下一行。<strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><code>阻塞</code></strong>调用线程的运行</p>
<h4 id="h2-1" style="color: inherit; line-height: inherit; padding: 0px; margin: 5px 0px; font-weight: bold; font-size: 1.2em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">2、异步</span></h4>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px;">异步方法则在被调用之后，调用线程不会等待方法的完成，会直接进入下一行，执行下一个指令，所以是<strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><code>非阻塞</code></strong>的</p>
<h4 id="h3-1" style="color: inherit; line-height: inherit; padding: 0px; margin: 5px 0px; font-weight: bold; font-size: 1.2em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">3、异步编程</span></h4>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px;">.NET通过委托可以实现异步调用任何方法。像上面介绍委托方法调用时，除了Invoke同步方法，还有BegInvoke异步方法，它会启用一个异步调用线程，你只需要传入委托方法的参数（可能还需要线程额外参数，如果有必要的话）就可以以后台线程的方式执行方法。在代码上执行到BeginInvoke时，会立即返回，不等待异步调用的完成，它返回一个IAsyncResult类型，你可以用它来监视调用的进度。和BegInvoke成对的EndInvoke方法可以用于获取异步调用的结果，这是会阻塞的。具体将在下一篇代码实例中讲解BeginInvoke的常用套路</p>
<h4 id="h4asyncawait" style="color: inherit; line-height: inherit; padding: 0px; margin: 5px 0px; font-weight: bold; font-size: 1.2em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">4、Async、Await</span></h4>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px;"><strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><code>Async、Await是.NET4.5</code></strong>新增的异步编程方式，为了简化异步程序的编写。上面的说的异步调用方式就是经典的<strong style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; font-weight: bold;"><code>APM异步编程模型</code></strong>，基于IAsyncResult接口实现BeginXXX和EndXXX类似的方法。在.NET4.5中可以使用Async方式，通过Async关键字标记方法为异步方法，然后在方法内部通过await标记后面的方法耗时，调用线程到这里就回去吧。我们就可以不用APM方式，用async方式可以轻松将一个方法编程异步方法</p>
<pre><code><code class="csharp language-csharp hljs" style="margin: 0px 2px; line-height: 18px; font-size: 14px; font-weight: normal; word-spacing: 0px; letter-spacing: 0px; font-family: Consolas, Inconsolata, Courier, monospace; border-radius: 0px; overflow-x: auto; background: #efecf4; color: #585260; padding: 0.5em; white-space: pre !important; word-wrap: normal !important; word-break: normal !important; overflow: auto !important; display: -webkit-box !important;"><span class="hljs-function" style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px; word-wrap: inherit !important; word-break: inherit !important;"><span class="hljs-keyword" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #955ae7; word-wrap: inherit !important; word-break: inherit !important;">public</span>&nbsp;<span class="hljs-keyword" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #955ae7; word-wrap: inherit !important; word-break: inherit !important;">async</span>&nbsp;<span class="hljs-keyword" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #955ae7; word-wrap: inherit !important; word-break: inherit !important;">void</span>&nbsp;<span class="hljs-title" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #576ddb; word-wrap: inherit !important; word-break: inherit !important;">Async1</span>()<br /></span>{<br />&nbsp;&nbsp;&nbsp;&nbsp;HttpWebRequest&nbsp;myReq&nbsp;=&nbsp;(HttpWebRequest)WebRequest.Create(<span class="hljs-string" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #2a9292; word-wrap: inherit !important; word-break: inherit !important;">"http://cnblogs.com/"</span>);<br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #955ae7; word-wrap: inherit !important; word-break: inherit !important;">await</span>&nbsp;myReq.GetRequestStreamAsync();<br />&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-comment" style="font-size: inherit; line-height: inherit; margin: 0px; padding: 0px; color: #655f6d; word-wrap: inherit !important; word-break: inherit !important;">//to&nbsp;do</span><br />}&nbsp;<br /></code></pre>
<h4 id="h5" style="color: inherit; line-height: inherit; padding: 0px; margin: 5px 0px; font-weight: bold; font-size: 1.2em;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">5、异步操作优缺点</span></h4>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px;">异步操作相比较于多线程，减少了死锁的可能，在设计良好的情况下，异步函数可以不必使用共享变量，可以减少出错的几率。但起步也是难以调试的，只有尽量减少其复杂度</p>
<h3 id="h-5" style="line-height: inherit; margin: 5px 0px; font-weight: bold; font-size: 1.3em; margin-bottom: 15px; margin-right: 5px; padding: 4px 8px; letter-spacing: 2px; background-color: #bbb180; color: #ffffff; border-radius: 5px; text-shadow: #666666 1px 1px 1px; box-shadow: #666666 1px 1px 2px;"><span style="font-size: inherit; color: inherit; line-height: inherit; margin: 0px; padding: 0px;">三、小结</span></h3>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px;">这篇主要介绍一些概念，接下来硬核编码部分就不会再啰嗦这些，上面有遗漏的，在编码中会捎带一些。基本就这些吧，TaskFactory、ThreadPool、Task、Parallel等都是对Thread的封装，过一遍代码，了解常用方法套路就可以。不会面面俱到每个接口都试一下，微软官网文档更全面（吹一波，.NET微软大佬的技术支持还是杠杠的）。后面主要搞一些成熟的套路，比如线程的同步，线程取消，异常处理，线程安全、锁机制等可用的编码方式。</p>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px;">OK，那下期见，去给FPX打气去，拜了个拜~</p>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px;"><span style="color: #ff9900; font-size: 15px;"><strong>可关注主页公号获取更多</strong></span></p>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px;"><span style="color: #ff9900; font-size: 14pt;"><strong>兽人永不为奴</strong></span></p>
<p style="font-size: inherit; color: inherit; line-height: inherit; padding: 0px; margin: 1em 0px;"><img src="./images/.NET进阶篇06-async异步、thread多线程12.png" alt="" /></p>
</div>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>