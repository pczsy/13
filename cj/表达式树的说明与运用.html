<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修表达式树的说明与运用' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>表达式树的说明与运用</center></div><div class='banquan'>原文出处:本文由博客园博主just0ne提供。<br/>
原文连接:https://www.cnblogs.com/just0ne/p/11553064.html</div><br>
    <p>说明: 在日常代码开发中很多的地方都用到了Lambda表达式进行过滤操作，很多优秀的ORM也是使用表达式来进行数据的查询。但是对于一些复杂的过 滤单纯的使用Lambda已经不能够解决问题了那么就需要表达式树来进行条件的一个拼接。&nbsp;</p>
<p>下面介绍一个本人写的一个工具类有助于项目中更好的使用:</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008080;">  1</span>   <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> ExpressionTreeTools
</span><span style="color: #008080;">  2</span> <span style="color: #000000;">    {
</span><span style="color: #008080;">  3</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
<span style="color: #008080;">  4</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 相当于&amp;&amp;操作
</span><span style="color: #008080;">  5</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> &mdash;&mdash;just0ne
</span><span style="color: #008080;">  6</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
<span style="color: #008080;">  7</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="thisFilter"&gt;</span><span style="color: #008000;">已生成的过滤条件</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">  8</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="otherFilter"&gt;</span><span style="color: #008000;">未生成的过滤条件</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">  9</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">新的过滤</span><span style="color: #808080;">&lt;/returns&gt;</span>
<span style="color: #008080;"> 10</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> Expression And(<span style="color: #0000ff;">this</span><span style="color: #000000;"> Expression thisFilter, Expression otherFilter)
</span><span style="color: #008080;"> 11</span> <span style="color: #000000;">        {
</span><span style="color: #008080;"> 12</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> Expression.AndAlso(thisFilter, otherFilter);
</span><span style="color: #008080;"> 13</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 14</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
<span style="color: #008080;"> 15</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 相当于||操作
</span><span style="color: #008080;"> 16</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> &mdash;&mdash;just0ne
</span><span style="color: #008080;"> 17</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
<span style="color: #008080;"> 18</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="thisFilter"&gt;</span><span style="color: #008000;">已生成的过滤条件</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 19</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="otherFilter"&gt;</span><span style="color: #008000;">未生成的过滤条件</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 20</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">新的过滤</span><span style="color: #808080;">&lt;/returns&gt;</span>
<span style="color: #008080;"> 21</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> Expression Or(<span style="color: #0000ff;">this</span><span style="color: #000000;"> Expression thisFilter, Expression otherFilter)
</span><span style="color: #008080;"> 22</span> <span style="color: #000000;">        {
</span><span style="color: #008080;"> 23</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> Expression.OrElse(thisFilter, otherFilter);
</span><span style="color: #008080;"> 24</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 25</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
<span style="color: #008080;"> 26</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 相当于==操作
</span><span style="color: #008080;"> 27</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> &mdash;&mdash;just0ne
</span><span style="color: #008080;"> 28</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
<span style="color: #008080;"> 29</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="thisParameterExpression"&gt;</span><span style="color: #008000;">查询对象</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 30</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="propertieName"&gt;</span><span style="color: #008000;">属性名称</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 31</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="propertieValue"&gt;</span><span style="color: #008000;">属性值</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 32</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">新的过滤</span><span style="color: #808080;">&lt;/returns&gt;</span>
<span style="color: #008080;"> 33</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> Expression GotoEqual(<span style="color: #0000ff;">this</span> ParameterExpression thisParameterExpression, <span style="color: #0000ff;">string</span> propertieName, <span style="color: #0000ff;">object</span><span style="color: #000000;"> propertieValue)
</span><span style="color: #008080;"> 34</span> <span style="color: #000000;">        {
</span><span style="color: #008080;"> 35</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> Expression.Equal(Expression.Property(thisParameterExpression, propertieName), Expression.Constant(propertieValue));
</span><span style="color: #008080;"> 36</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 37</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
<span style="color: #008080;"> 38</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 相当于&gt;=操作
</span><span style="color: #008080;"> 39</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> &mdash;&mdash;just0ne
</span><span style="color: #008080;"> 40</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
<span style="color: #008080;"> 41</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="thisParameterExpression"&gt;</span><span style="color: #008000;">查询对象</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 42</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="propertieName"&gt;</span><span style="color: #008000;">属性名称</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 43</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="propertieValue"&gt;</span><span style="color: #008000;">属性值</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 44</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">新的过滤</span><span style="color: #808080;">&lt;/returns&gt;</span>
<span style="color: #008080;"> 45</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> Expression GotoGreaterThanOrEqual&lt;T&gt;(<span style="color: #0000ff;">this</span> ParameterExpression thisParameterExpression, <span style="color: #0000ff;">string</span> propertieName, <span style="color: #0000ff;">object</span><span style="color: #000000;"> propertieValue)
</span><span style="color: #008080;"> 46</span> <span style="color: #000000;">        {
</span><span style="color: #008080;"> 47</span>             <span style="color: #008000;">//</span><span style="color: #008000;">大于或等于</span>
<span style="color: #008080;"> 48</span>             <span style="color: #0000ff;">return</span> Expression.GreaterThanOrEqual(Expression.Property(thisParameterExpression, propertieName), Expression.Constant(propertieValue, <span style="color: #0000ff;">typeof</span><span style="color: #000000;">(T)));
</span><span style="color: #008080;"> 49</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 50</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
<span style="color: #008080;"> 51</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 相当于小于等于操作
</span><span style="color: #008080;"> 52</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> &mdash;&mdash;just0ne
</span><span style="color: #008080;"> 53</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
<span style="color: #008080;"> 54</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="thisParameterExpression"&gt;</span><span style="color: #008000;">查询对象</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 55</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="propertieName"&gt;</span><span style="color: #008000;">属性名称</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 56</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="propertieValue"&gt;</span><span style="color: #008000;">属性值</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 57</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">新的过滤</span><span style="color: #808080;">&lt;/returns&gt;</span>
<span style="color: #008080;"> 58</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> Expression GotoLessThanOrEqual&lt;T&gt;(<span style="color: #0000ff;">this</span> ParameterExpression thisParameterExpression, <span style="color: #0000ff;">string</span> propertieName, <span style="color: #0000ff;">object</span><span style="color: #000000;"> propertieValue)
</span><span style="color: #008080;"> 59</span> <span style="color: #000000;">        {
</span><span style="color: #008080;"> 60</span>             <span style="color: #008000;">//</span><span style="color: #008000;">小于或等于</span>
<span style="color: #008080;"> 61</span>             <span style="color: #0000ff;">return</span> Expression.LessThanOrEqual(Expression.Property(thisParameterExpression, propertieName), Expression.Constant(propertieValue, <span style="color: #0000ff;">typeof</span><span style="color: #000000;">(T)));
</span><span style="color: #008080;"> 62</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 63</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
<span style="color: #008080;"> 64</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 相当于&gt;操作
</span><span style="color: #008080;"> 65</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> &mdash;&mdash;just0ne
</span><span style="color: #008080;"> 66</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
<span style="color: #008080;"> 67</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="thisParameterExpression"&gt;</span><span style="color: #008000;">查询对象</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 68</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="propertieName"&gt;</span><span style="color: #008000;">属性名称</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 69</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="propertieValue"&gt;</span><span style="color: #008000;">属性值</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 70</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">新的过滤</span><span style="color: #808080;">&lt;/returns&gt;</span>
<span style="color: #008080;"> 71</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> Expression GotoGreaterThan&lt;T&gt;(<span style="color: #0000ff;">this</span> ParameterExpression thisParameterExpression, <span style="color: #0000ff;">string</span> propertieName, <span style="color: #0000ff;">object</span><span style="color: #000000;"> propertieValue)
</span><span style="color: #008080;"> 72</span> <span style="color: #000000;">        {
</span><span style="color: #008080;"> 73</span>             <span style="color: #008000;">//</span><span style="color: #008000;">大于</span>
<span style="color: #008080;"> 74</span>             <span style="color: #0000ff;">return</span> Expression.GreaterThan(Expression.Property(thisParameterExpression, propertieName), Expression.Constant(propertieValue, <span style="color: #0000ff;">typeof</span><span style="color: #000000;">(T)));
</span><span style="color: #008080;"> 75</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 76</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
<span style="color: #008080;"> 77</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 相当于小于操作
</span><span style="color: #008080;"> 78</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> &mdash;&mdash;just0ne
</span><span style="color: #008080;"> 79</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
<span style="color: #008080;"> 80</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="thisParameterExpression"&gt;</span><span style="color: #008000;">查询对象</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 81</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="propertieName"&gt;</span><span style="color: #008000;">属性名称</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 82</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="propertieValue"&gt;</span><span style="color: #008000;">属性值</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 83</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">新的过滤</span><span style="color: #808080;">&lt;/returns&gt;</span>
<span style="color: #008080;"> 84</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> Expression GotoLessThan&lt;T&gt;(<span style="color: #0000ff;">this</span> ParameterExpression thisParameterExpression, <span style="color: #0000ff;">string</span> propertieName, <span style="color: #0000ff;">object</span><span style="color: #000000;"> propertieValue)
</span><span style="color: #008080;"> 85</span> <span style="color: #000000;">        {
</span><span style="color: #008080;"> 86</span>             <span style="color: #008000;">//</span><span style="color: #008000;">小于</span>
<span style="color: #008080;"> 87</span>             <span style="color: #0000ff;">return</span> Expression.LessThan(Expression.Property(thisParameterExpression, propertieName), Expression.Constant(propertieValue, <span style="color: #0000ff;">typeof</span><span style="color: #000000;">(T)));
</span><span style="color: #008080;"> 88</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 89</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
<span style="color: #008080;"> 90</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 相当于&gt;=操作
</span><span style="color: #008080;"> 91</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> &mdash;&mdash;just0ne
</span><span style="color: #008080;"> 92</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
<span style="color: #008080;"> 93</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="thisParameterExpression"&gt;</span><span style="color: #008000;">查询对象</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 94</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="propertieName"&gt;</span><span style="color: #008000;">属性名称</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 95</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="propertieValue"&gt;</span><span style="color: #008000;">属性值</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;"> 96</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">新的过滤</span><span style="color: #808080;">&lt;/returns&gt;</span>
<span style="color: #008080;"> 97</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> Expression GotoGreaterThanOrEqualByDateTime(<span style="color: #0000ff;">this</span> ParameterExpression thisParameterExpression, <span style="color: #0000ff;">string</span> propertieName, <span style="color: #0000ff;">object</span><span style="color: #000000;"> propertieValue)
</span><span style="color: #008080;"> 98</span> <span style="color: #000000;">        {
</span><span style="color: #008080;"> 99</span>             <span style="color: #008000;">//</span><span style="color: #008000;">大于或等于</span>
<span style="color: #008080;">100</span>             <span style="color: #0000ff;">return</span> Expression.GreaterThanOrEqual(Expression.Property(thisParameterExpression, propertieName), Expression.Constant(propertieValue, <span style="color: #0000ff;">typeof</span>(DateTime?<span style="color: #000000;">)));
</span><span style="color: #008080;">101</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">102</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
<span style="color: #008080;">103</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 相当于小于或等于操作
</span><span style="color: #008080;">104</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> &mdash;&mdash;just0ne
</span><span style="color: #008080;">105</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
<span style="color: #008080;">106</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="thisParameterExpression"&gt;</span><span style="color: #008000;">查询对象</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">107</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="propertieName"&gt;</span><span style="color: #008000;">属性名称</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">108</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="propertieValue"&gt;</span><span style="color: #008000;">属性值</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">109</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">新的过滤</span><span style="color: #808080;">&lt;/returns&gt;</span>
<span style="color: #008080;">110</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> Expression GotoLessThanOrEqualByDateTime(<span style="color: #0000ff;">this</span> ParameterExpression thisParameterExpression, <span style="color: #0000ff;">string</span> propertieName, <span style="color: #0000ff;">object</span><span style="color: #000000;"> propertieValue)
</span><span style="color: #008080;">111</span> <span style="color: #000000;">        {
</span><span style="color: #008080;">112</span>             <span style="color: #008000;">//</span><span style="color: #008000;">小于或等于</span>
<span style="color: #008080;">113</span>             <span style="color: #0000ff;">return</span> Expression.LessThanOrEqual(Expression.Property(thisParameterExpression, propertieName), Expression.Constant(propertieValue, <span style="color: #0000ff;">typeof</span>(DateTime?<span style="color: #000000;">)));
</span><span style="color: #008080;">114</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">115</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
<span style="color: #008080;">116</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 相当于&gt;操作
</span><span style="color: #008080;">117</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> &mdash;&mdash;just0ne
</span><span style="color: #008080;">118</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
<span style="color: #008080;">119</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="thisParameterExpression"&gt;</span><span style="color: #008000;">查询对象</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">120</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="propertieName"&gt;</span><span style="color: #008000;">属性名称</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">121</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="propertieValue"&gt;</span><span style="color: #008000;">属性值</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">122</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">新的过滤</span><span style="color: #808080;">&lt;/returns&gt;</span>
<span style="color: #008080;">123</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> Expression GotoGreaterThanByDateTime(<span style="color: #0000ff;">this</span> ParameterExpression thisParameterExpression, <span style="color: #0000ff;">string</span> propertieName, <span style="color: #0000ff;">object</span><span style="color: #000000;"> propertieValue)
</span><span style="color: #008080;">124</span> <span style="color: #000000;">        {
</span><span style="color: #008080;">125</span>             <span style="color: #008000;">//</span><span style="color: #008000;">大于</span>
<span style="color: #008080;">126</span>             <span style="color: #0000ff;">return</span> Expression.GreaterThan(Expression.Property(thisParameterExpression, propertieName), Expression.Constant(propertieValue, <span style="color: #0000ff;">typeof</span>(DateTime?<span style="color: #000000;">)));
</span><span style="color: #008080;">127</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">128</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
<span style="color: #008080;">129</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 相当于小于操作
</span><span style="color: #008080;">130</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> &mdash;一just0ne
</span><span style="color: #008080;">131</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
<span style="color: #008080;">132</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="thisParameterExpression"&gt;</span><span style="color: #008000;">查询对象</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">133</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="propertieName"&gt;</span><span style="color: #008000;">属性名称</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">134</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="propertieValue"&gt;</span><span style="color: #008000;">属性值</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">135</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">新的过滤</span><span style="color: #808080;">&lt;/returns&gt;</span>
<span style="color: #008080;">136</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> Expression GotoLessThanByDateTime(<span style="color: #0000ff;">this</span> ParameterExpression thisParameterExpression, <span style="color: #0000ff;">string</span> propertieName, <span style="color: #0000ff;">object</span><span style="color: #000000;"> propertieValue)
</span><span style="color: #008080;">137</span> <span style="color: #000000;">        {
</span><span style="color: #008080;">138</span>             <span style="color: #008000;">//</span><span style="color: #008000;">小于</span>
<span style="color: #008080;">139</span>             <span style="color: #0000ff;">return</span> Expression.LessThan(Expression.Property(thisParameterExpression, propertieName), Expression.Constant(propertieValue, <span style="color: #0000ff;">typeof</span>(DateTime?<span style="color: #000000;">)));
</span><span style="color: #008080;">140</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">141</span> 
<span style="color: #008080;">142</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
<span style="color: #008080;">143</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 一一just0ne
</span><span style="color: #008080;">144</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 包含操作 相当余 a=&gt; arr.Contains(a.ID)
</span><span style="color: #008080;">145</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 如果arr中数据量过大则不适用linq
</span><span style="color: #008080;">146</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
<span style="color: #008080;">147</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="thisParameterExpression"&gt;</span><span style="color: #008000;">查询对象</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">148</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="propertieName"&gt;</span><span style="color: #008000;">属性名称</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">149</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="propertieValue"&gt;</span><span style="color: #008000;">属性值</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">150</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">新的过滤</span><span style="color: #808080;">&lt;/returns&gt;</span>
<span style="color: #008080;">151</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> Expression ContainsOperations(<span style="color: #0000ff;">this</span> ParameterExpression thisParameterExpression, <span style="color: #0000ff;">string</span> propertieName, <span style="color: #0000ff;">object</span><span style="color: #000000;"> propertieValue)
</span><span style="color: #008080;">152</span> <span style="color: #000000;">        {
</span><span style="color: #008080;">153</span>             MethodInfo method = <span style="color: #0000ff;">null</span><span style="color: #000000;">;
</span><span style="color: #008080;">154</span>             MemberExpression member =<span style="color: #000000;"> Expression.Property(thisParameterExpression, propertieName);
</span><span style="color: #008080;">155</span>             <span style="color: #0000ff;">var</span> containsMethods = <span style="color: #0000ff;">typeof</span>(Enumerable).GetMethods(BindingFlags.Static | BindingFlags.Public).Where(m =&gt; m.Name == <span style="color: #800000;">"</span><span style="color: #800000;">Contains</span><span style="color: #800000;">"</span><span style="color: #000000;">);
</span><span style="color: #008080;">156</span>             <span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> m <span style="color: #0000ff;">in</span><span style="color: #000000;"> containsMethods)
</span><span style="color: #008080;">157</span> <span style="color: #000000;">            {
</span><span style="color: #008080;">158</span>                 <span style="color: #0000ff;">if</span> (m.GetParameters().Count() == <span style="color: #800080;">2</span><span style="color: #000000;">)
</span><span style="color: #008080;">159</span> <span style="color: #000000;">                {
</span><span style="color: #008080;">160</span>                     method =<span style="color: #000000;"> m;
</span><span style="color: #008080;">161</span>                     <span style="color: #0000ff;">break</span><span style="color: #000000;">;
</span><span style="color: #008080;">162</span> <span style="color: #000000;">                }
</span><span style="color: #008080;">163</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">164</span>             method =<span style="color: #000000;"> method.MakeGenericMethod(member.Type);
</span><span style="color: #008080;">165</span>             <span style="color: #0000ff;">var</span> exprContains = Expression.Call(method, <span style="color: #0000ff;">new</span><span style="color: #000000;"> Expression[] { Expression.Constant(propertieValue), member });
</span><span style="color: #008080;">166</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> exprContains;
</span><span style="color: #008080;">167</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">168</span> 
<span style="color: #008080;">169</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
<span style="color: #008080;">170</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 一一just0ne
</span><span style="color: #008080;">171</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 包含操作 相当于  a=&gt;a.ID.Contains(key)
</span><span style="color: #008080;">172</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
<span style="color: #008080;">173</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="thisParameterExpression"&gt;</span><span style="color: #008000;">查询对象</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">174</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="propertieName"&gt;</span><span style="color: #008000;">属性名称</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">175</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="propertieValue"&gt;</span><span style="color: #008000;">属性值</span><span style="color: #808080;">&lt;/param&gt;</span>
<span style="color: #008080;">176</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;</span><span style="color: #008000;">新的过滤</span><span style="color: #808080;">&lt;/returns&gt;</span>
<span style="color: #008080;">177</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> Expression Contains(<span style="color: #0000ff;">this</span> ParameterExpression thisParameterExpression, <span style="color: #0000ff;">string</span> propertieName, <span style="color: #0000ff;">object</span><span style="color: #000000;"> propertieValue)
</span><span style="color: #008080;">178</span> <span style="color: #000000;">        {
</span><span style="color: #008080;">179</span>             <span style="color: #0000ff;">var</span> propertyExp =<span style="color: #000000;"> Expression.Property(thisParameterExpression, propertieName);
</span><span style="color: #008080;">180</span>             MethodInfo method = <span style="color: #0000ff;">typeof</span>(<span style="color: #0000ff;">string</span>).GetMethod(<span style="color: #800000;">"</span><span style="color: #800000;">Contains</span><span style="color: #800000;">"</span>, <span style="color: #0000ff;">new</span>[] { <span style="color: #0000ff;">typeof</span>(<span style="color: #0000ff;">string</span><span style="color: #000000;">) });
</span><span style="color: #008080;">181</span>             <span style="color: #0000ff;">var</span> someValue = Expression.Constant(propertieValue, <span style="color: #0000ff;">typeof</span>(<span style="color: #0000ff;">string</span><span style="color: #000000;">));
</span><span style="color: #008080;">182</span>             <span style="color: #0000ff;">var</span> containsMethodExp =<span style="color: #000000;"> Expression.Call(propertyExp, method, someValue);
</span><span style="color: #008080;">183</span>             <span style="color: #0000ff;">return</span><span style="color: #000000;"> containsMethodExp;
</span><span style="color: #008080;">184</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">185</span> 
<span style="color: #008080;">186</span>     }</pre>
</div>
<p>以上就是一些基本的拼接都有了接下来是如何进行使用 还是贴上代码进行说明</p>
<div class="cnblogs_code">
<pre><code>  <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">string</span>[] nameArr = <span style="color: #0000ff;">new</span> <span style="color: #0000ff;">string</span>[] { <span style="color: #800000;">"</span><span style="color: #800000;">just0ne</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">kphui</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">point</span><span style="color: #800000;">"</span><span style="color: #000000;"> };
            </span><span style="color: #0000ff;">var</span> userDataList =<span style="color: #000000;"> GetUserDataList().AsQueryable();
            </span><span style="color: #008000;">//</span><span style="color: #008000;">初始化</span>
            <span style="color: #0000ff;">var</span> parameterExpression = Expression.Parameter(<span style="color: #0000ff;">typeof</span><span style="color: #000000;">(UserData));
            </span><span style="color: #0000ff;">var</span> filter = (Expression)Expression.Constant(<span style="color: #0000ff;">true</span><span style="color: #000000;">);
            </span><span style="color: #008000;">//</span><span style="color: #008000;">寻找年岁大于10</span>
            filter = filter.And(parameterExpression.GotoGreaterThan&lt;<span style="color: #0000ff;">int</span>&gt;(<span style="color: #800000;">"</span><span style="color: #800000;">Age</span><span style="color: #800000;">"</span>, <span style="color: #800080;">10</span><span style="color: #000000;">));
            </span><span style="color: #0000ff;">string</span> key =<span style="color: #000000;"> Console.ReadLine();
            </span><span style="color: #0000ff;">if</span> (!<span style="color: #000000;">String.IsNullOrEmpty(key))
            {
                </span><span style="color: #0000ff;">var</span> keyFilter = (Expression)Expression.Constant(<span style="color: #0000ff;">false</span><span style="color: #000000;">);
                keyFilter </span>= keyFilter.Or(parameterExpression.Contains(<span style="color: #800000;">"</span><span style="color: #800000;">Name</span><span style="color: #800000;">"</span><span style="color: #000000;">, key));
                keyFilter </span>= keyFilter.Or(parameterExpression.Contains(<span style="color: #800000;">"</span><span style="color: #800000;">Phone</span><span style="color: #800000;">"</span><span style="color: #000000;">, key));
                filter </span>=<span style="color: #000000;"> filter.And(keyFilter);
            }
            filter </span>= filter.And(parameterExpression.ContainsOperations(<span style="color: #800000;">"</span><span style="color: #800000;">Name</span><span style="color: #800000;">"</span><span style="color: #000000;">, nameArr));
            </span><span style="color: #0000ff;">var</span> lamadaFilter = Expression.Lambda&lt;Func&lt;UserData, <span style="color: #0000ff;">bool</span>&gt;&gt;<span style="color: #000000;">(filter, parameterExpression);
            </span><span style="color: #0000ff;">var</span> userDatas =<span style="color: #000000;"> userDataList.Where(lamadaFilter).ToList();
            Console.WriteLine(Newtonsoft.Json.JsonConvert.SerializeObject(userDatas));
        }

        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> List&lt;UserData&gt;<span style="color: #000000;"> GetUserDataList()
        {
            </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span> List&lt;UserData&gt;<span style="color: #000000;">()
            {
                </span><span style="color: #0000ff;">new</span> UserData(){ Age=<span style="color: #800080;">18</span>, Id=<span style="color: #800080;">1</span>, Name=<span style="color: #800000;">"</span><span style="color: #800000;">just0ne</span><span style="color: #800000;">"</span>, Phone=<span style="color: #800000;">"</span><span style="color: #800000;">13856****26</span><span style="color: #800000;">"</span><span style="color: #000000;"> },
                </span><span style="color: #0000ff;">new</span> UserData(){ Age=<span style="color: #800080;">22</span>, Id=<span style="color: #800080;">2</span>, Name=<span style="color: #800000;">"</span><span style="color: #800000;">point</span><span style="color: #800000;">"</span>, Phone=<span style="color: #800000;">"</span><span style="color: #800000;">17521****52</span><span style="color: #800000;">"</span><span style="color: #000000;"> },
                </span><span style="color: #0000ff;">new</span> UserData(){ Age=<span style="color: #800080;">21</span>, Id=<span style="color: #800080;">3</span>, Name=<span style="color: #800000;">"</span><span style="color: #800000;">geekdog</span><span style="color: #800000;">"</span>, Phone=<span style="color: #800000;">"</span><span style="color: #800000;">15562****36</span><span style="color: #800000;">"</span><span style="color: #000000;"> },
                </span><span style="color: #0000ff;">new</span> UserData(){ Age=<span style="color: #800080;">14</span>, Id=<span style="color: #800080;">4</span>, Name=<span style="color: #800000;">"</span><span style="color: #800000;">kphui</span><span style="color: #800000;">"</span> , Phone=<span style="color: #800000;">"</span><span style="color: #800000;">13577****26</span><span style="color: #800000;">"</span><span style="color: #000000;">},
                </span><span style="color: #0000ff;">new</span> UserData(){ Age=<span style="color: #800080;">13</span>, Id=<span style="color: #800080;">5</span>, Name=<span style="color: #800000;">"</span><span style="color: #800000;">lg</span><span style="color: #800000;">"</span> , Phone=<span style="color: #800000;">"</span><span style="color: #800000;">13456****26</span><span style="color: #800000;">"</span><span style="color: #000000;">},
                </span><span style="color: #0000ff;">new</span> UserData(){ Age=<span style="color: #800080;">16</span>, Id=<span style="color: #800080;">6</span>, Name=<span style="color: #800000;">"</span><span style="color: #800000;">ming</span><span style="color: #800000;">"</span>, Phone=<span style="color: #800000;">"</span><span style="color: #800000;">13356****26</span><span style="color: #800000;">"</span><span style="color: #000000;"> },
                </span><span style="color: #0000ff;">new</span> UserData(){ Age=<span style="color: #800080;">18</span>, Id=<span style="color: #800080;">7</span>, Name=<span style="color: #800000;">"</span><span style="color: #800000;">tencent</span><span style="color: #800000;">"</span>, Phone=<span style="color: #800000;">"</span><span style="color: #800000;">13256****26</span><span style="color: #800000;">"</span><span style="color: #000000;"> },
                </span><span style="color: #0000ff;">new</span> UserData(){ Age=<span style="color: #800080;">10</span>, Id=<span style="color: #800080;">8</span>, Name=<span style="color: #800000;">"</span><span style="color: #800000;">justin</span><span style="color: #800000;">"</span> , Phone=<span style="color: #800000;">"</span><span style="color: #800000;">13156****26</span><span style="color: #800000;">"</span><span style="color: #000000;">},
                </span><span style="color: #0000ff;">new</span> UserData(){ Age=<span style="color: #800080;">31</span>, Id=<span style="color: #800080;">9</span>, Name=<span style="color: #800000;">"</span><span style="color: #800000;">hujw</span><span style="color: #800000;">"</span>, Phone=<span style="color: #800000;">"</span><span style="color: #800000;">13823****26</span><span style="color: #800000;">"</span><span style="color: #000000;"> },
                </span><span style="color: #0000ff;">new</span> UserData(){ Age=<span style="color: #800080;">27</span>, Id=<span style="color: #800080;">10</span>, Name=<span style="color: #800000;">"</span><span style="color: #800000;">lqm</span><span style="color: #800000;">"</span> , Phone=<span style="color: #800000;">"</span><span style="color: #800000;">13876****26</span><span style="color: #800000;">"</span><span style="color: #000000;">},
                </span><span style="color: #0000ff;">new</span> UserData(){ Age=<span style="color: #800080;">26</span>, Id=<span style="color: #800080;">11</span>, Name=<span style="color: #800000;">"</span><span style="color: #800000;">jiujiu</span><span style="color: #800000;">"</span> , Phone=<span style="color: #800000;">"</span><span style="color: #800000;">13846****26</span><span style="color: #800000;">"</span><span style="color: #000000;">},
            };
        }
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> UserData
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> Id { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }

        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> Name { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }

        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> Phone { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }

        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> Email { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }

        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> Age { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
    }</span></pre>
</div>
<p>&nbsp;</p>
<p>运行程序会输出如下的内容:</p>
<p><img src="./images/表达式树的说明与运用0.png" alt="" /></p>
<p>以上只是针对如何使用表达式树做个例子 如有不同的可以留言哦！</p>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>