<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修asp.net core系列 65 正反案例介绍SOLID原则' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>asp.net core系列 65 正反案例介绍SOLID原则</center></div><div class='banquan'>原文出处:本文由博客园博主花阴偷移提供。<br/>
原文连接:https://www.cnblogs.com/MrHSR/p/10912615.html</div><br>
    <h3>一.概述</h3>
<p>　　<span lang="EN-US">SOLID五大原则使我们能够管理解决大多数软件设计问题。由<span lang="EN-US">Robert C. Martin在<span lang="EN-US">20世纪<span lang="EN-US">90年代编写了这些原则。这些原则为我们提供了从紧耦合的代码和少量封装转变为适当松耦合和封装业务实际需求的结果方法。使用这些原则，我们可以构建一个具有整洁，可读且易于维护的代码应用程序。</span></span></span></span></p>
<p><span lang="EN-US"><span lang="EN-US"><span lang="EN-US"><span lang="EN-US">　　</span></span></span></span>SOLID缩写如下：　　</p>
<p>　　　　<a href="#SRP">SRP&nbsp; 单一责任原则</a></p>
<p>　　　　<a href="#OCP">OCP 开放/封闭原则</a></p>
<p>　　　　<a href="#LSP">LSP&nbsp; 里氏替换原则</a></p>
<p>　　　　<a href="#ISP">ISP&nbsp; &nbsp;接口分离原则</a></p>
<p>　　　　<a href="#DIP">DIP&nbsp; &nbsp;依赖反转原则</a></p>
<p>&nbsp;</p>
<h5>　<a name="SRP"></a>　1.单一责任原则SRP&nbsp;</h5>
<p>　　　&nbsp; &nbsp;一个类承担的责任在理想情况下应该是多少个呢？答案是一个。这个责任是围绕一个核心任务构建，不是简化的意思。通过暴露非常有限的责任使这个类与系统的交集更小。</p>
<p>　　　<span style="color: #ff0000;"><strong>　(1) 演示：违反了单一责任原则，原因是：顾客类中承担了太多无关的责任。</strong>　</span><span lang="EN-US">&nbsp;</span></p>
<div class="cnblogs_code" style="padding-left: 40px;">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 顾客类所有实现
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Cliente
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> ClienteId { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> Nome { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> Email { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> CPF { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
        </span><span style="color: #0000ff;">public</span> DateTime DataCadastro { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }

        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> AdicionarCliente()
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">顾客信息验证</span>
            <span style="color: #0000ff;">if</span> (!Email.Contains(<span style="color: #800000;">"</span><span style="color: #800000;">@</span><span style="color: #800000;">"</span><span style="color: #000000;">))
                </span><span style="color: #0000ff;">return</span> <span style="color: #800000;">"</span><span style="color: #800000;">Cliente com e-mail inv&aacute;lido</span><span style="color: #800000;">"</span><span style="color: #000000;">;

            </span><span style="color: #0000ff;">if</span> (CPF.Length != <span style="color: #800080;">11</span><span style="color: #000000;">)
                </span><span style="color: #0000ff;">return</span> <span style="color: #800000;">"</span><span style="color: #800000;">Cliente com CPF inv&aacute;lido</span><span style="color: #800000;">"</span><span style="color: #000000;">;

            </span><span style="color: #008000;">//</span><span style="color: #008000;">保存顾客信息</span>
            <span style="color: #0000ff;">using</span> (<span style="color: #0000ff;">var</span> cn = <span style="color: #0000ff;">new</span><span style="color: #000000;"> SqlConnection())
            {
                </span><span style="color: #0000ff;">var</span> cmd = <span style="color: #0000ff;">new</span><span style="color: #000000;"> SqlCommand();

                cn.ConnectionString </span>= <span style="color: #800000;">"</span><span style="color: #800000;">MinhaConnectionString</span><span style="color: #800000;">"</span><span style="color: #000000;">;
                cmd.Connection </span>=<span style="color: #000000;"> cn;
                cmd.CommandType </span>=<span style="color: #000000;"> CommandType.Text;
                cmd.CommandText </span>= <span style="color: #800000;">"</span><span style="color: #800000;">INSERT INTO CLIENTE (NOME, EMAIL CPF, DATACADASTRO) VALUES (@nome, @email, @cpf, @dataCad))</span><span style="color: #800000;">"</span><span style="color: #000000;">;

                cmd.Parameters.AddWithValue(</span><span style="color: #800000;">"</span><span style="color: #800000;">nome</span><span style="color: #800000;">"</span><span style="color: #000000;">, Nome);
                cmd.Parameters.AddWithValue(</span><span style="color: #800000;">"</span><span style="color: #800000;">email</span><span style="color: #800000;">"</span><span style="color: #000000;">, Email);
                cmd.Parameters.AddWithValue(</span><span style="color: #800000;">"</span><span style="color: #800000;">cpf</span><span style="color: #800000;">"</span><span style="color: #000000;">, CPF);
                cmd.Parameters.AddWithValue(</span><span style="color: #800000;">"</span><span style="color: #800000;">dataCad</span><span style="color: #800000;">"</span><span style="color: #000000;">, DataCadastro);

                cn.Open();
                cmd.ExecuteNonQuery();
            }

            </span><span style="color: #008000;">//</span><span style="color: #008000;">发布邮件</span>
            <span style="color: #0000ff;">var</span> mail = <span style="color: #0000ff;">new</span> MailMessage(<span style="color: #800000;">"</span><span style="color: #800000;">empresa@empresa.com</span><span style="color: #800000;">"</span><span style="color: #000000;">, Email);
            </span><span style="color: #0000ff;">var</span> client = <span style="color: #0000ff;">new</span><span style="color: #000000;"> SmtpClient
            {
                Port </span>= <span style="color: #800080;">25</span><span style="color: #000000;">,
                DeliveryMethod </span>=<span style="color: #000000;"> SmtpDeliveryMethod.Network,
                UseDefaultCredentials </span>= <span style="color: #0000ff;">false</span><span style="color: #000000;">,
                Host </span>= <span style="color: #800000;">"</span><span style="color: #800000;">smtp.google.com</span><span style="color: #800000;">"</span><span style="color: #000000;">
            };

            mail.Subject </span>= <span style="color: #800000;">"</span><span style="color: #800000;">Bem Vindo.</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            mail.Body </span>= <span style="color: #800000;">"</span><span style="color: #800000;">Parab&eacute;ns! Voc&ecirc; est&aacute; cadastrado.</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            client.Send(mail);

            </span><span style="color: #0000ff;">return</span> <span style="color: #800000;">"</span><span style="color: #800000;">Cliente cadastrado com sucesso!</span><span style="color: #800000;">"</span><span style="color: #000000;">;
        }
    }</span></pre>
</div>
<p>&nbsp;　<strong>　　　<span style="color: #339966;">(2) 解决方案，使用单一责任原则，每个类只负责自己的业务。</span></strong></p>
<div class="cnblogs_code" style="padding-left: 40px;">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 顾客实体
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Cliente
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span> ClienteId { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> Nome { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> Email { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> CPF { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
        </span><span style="color: #0000ff;">public</span> DateTime DataCadastro { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 顾客信息验证
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">bool</span><span style="color: #000000;"> IsValid()
        {
            </span><span style="color: #0000ff;">return</span> EmailServices.IsValid(Email) &amp;&amp;<span style="color: #000000;"> CPFServices.IsValid(CPF);
        }
    }

    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 保存顾客信息
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> ClienteRepository
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 保存
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="cliente"&gt;</span><span style="color: #008000;">要保存的顾客实体</span><span style="color: #808080;">&lt;/param&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> AdicionarCliente(Cliente cliente)
        {
            </span><span style="color: #0000ff;">using</span> (<span style="color: #0000ff;">var</span> cn = <span style="color: #0000ff;">new</span><span style="color: #000000;"> SqlConnection())
            {
                </span><span style="color: #0000ff;">var</span> cmd = <span style="color: #0000ff;">new</span><span style="color: #000000;"> SqlCommand();

                cn.ConnectionString </span>= <span style="color: #800000;">"</span><span style="color: #800000;">MinhaConnectionString</span><span style="color: #800000;">"</span><span style="color: #000000;">;
                cmd.Connection </span>=<span style="color: #000000;"> cn;
                cmd.CommandType </span>=<span style="color: #000000;"> CommandType.Text;
                cmd.CommandText </span>= <span style="color: #800000;">"</span><span style="color: #800000;">INSERT INTO CLIENTE (NOME, EMAIL CPF, DATACADASTRO) VALUES (@nome, @email, @cpf, @dataCad))</span><span style="color: #800000;">"</span><span style="color: #000000;">;

                cmd.Parameters.AddWithValue(</span><span style="color: #800000;">"</span><span style="color: #800000;">nome</span><span style="color: #800000;">"</span><span style="color: #000000;">, cliente.Nome);
                cmd.Parameters.AddWithValue(</span><span style="color: #800000;">"</span><span style="color: #800000;">email</span><span style="color: #800000;">"</span><span style="color: #000000;">, cliente.Email);
                cmd.Parameters.AddWithValue(</span><span style="color: #800000;">"</span><span style="color: #800000;">cpf</span><span style="color: #800000;">"</span><span style="color: #000000;">, cliente.CPF);
                cmd.Parameters.AddWithValue(</span><span style="color: #800000;">"</span><span style="color: #800000;">dataCad</span><span style="color: #800000;">"</span><span style="color: #000000;">, cliente.DataCadastro);

                cn.Open();
                cmd.ExecuteNonQuery();
            }
        }
    }

   </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> CPF服务
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> CPFServices
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">bool</span> IsValid(<span style="color: #0000ff;">string</span><span style="color: #000000;"> cpf)
        {
            </span><span style="color: #0000ff;">return</span> cpf.Length == <span style="color: #800080;">11</span><span style="color: #000000;">;
        }
    }

    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 邮件服务
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> EmailServices
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">bool</span> IsValid(<span style="color: #0000ff;">string</span><span style="color: #000000;"> email)
        {
            </span><span style="color: #0000ff;">return</span> email.Contains(<span style="color: #800000;">"</span><span style="color: #800000;">@</span><span style="color: #800000;">"</span><span style="color: #000000;">);
        }

        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Enviar(<span style="color: #0000ff;">string</span> de, <span style="color: #0000ff;">string</span> para, <span style="color: #0000ff;">string</span> assunto, <span style="color: #0000ff;">string</span><span style="color: #000000;"> mensagem)
        {
            </span><span style="color: #0000ff;">var</span> mail = <span style="color: #0000ff;">new</span><span style="color: #000000;"> MailMessage(de, para);
            </span><span style="color: #0000ff;">var</span> client = <span style="color: #0000ff;">new</span><span style="color: #000000;"> SmtpClient
            {
                Port </span>= <span style="color: #800080;">25</span><span style="color: #000000;">,
                DeliveryMethod </span>=<span style="color: #000000;"> SmtpDeliveryMethod.Network,
                UseDefaultCredentials </span>= <span style="color: #0000ff;">false</span><span style="color: #000000;">,
                Host </span>= <span style="color: #800000;">"</span><span style="color: #800000;">smtp.google.com</span><span style="color: #800000;">"</span><span style="color: #000000;">
            };

            mail.Subject </span>=<span style="color: #000000;"> assunto;
            mail.Body </span>=<span style="color: #000000;"> mensagem;
            client.Send(mail);
        }
    }

    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 客户服务，程序调用入口
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> ClienteService
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> AdicionarCliente(Cliente cliente)
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">先验证</span>
            <span style="color: #0000ff;">if</span> (!<span style="color: #000000;">cliente.IsValid())
                </span><span style="color: #0000ff;">return</span> <span style="color: #800000;">"</span><span style="color: #800000;">Dados inv&aacute;lidos</span><span style="color: #800000;">"</span><span style="color: #000000;">;

            </span><span style="color: #008000;">//</span><span style="color: #008000;">保存顾客</span>
            <span style="color: #0000ff;">var</span> repo = <span style="color: #0000ff;">new</span><span style="color: #000000;"> ClienteRepository();
            repo.AdicionarCliente(cliente);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">邮件发送</span>
            EmailServices.Enviar(<span style="color: #800000;">"</span><span style="color: #800000;">empresa@empresa.com</span><span style="color: #800000;">"</span>, cliente.Email, <span style="color: #800000;">"</span><span style="color: #800000;">Bem Vindo</span><span style="color: #800000;">"</span>, <span style="color: #800000;">"</span><span style="color: #800000;">Parab&eacute;ns est&aacute; Cadastrado</span><span style="color: #800000;">"</span><span style="color: #000000;">);

            </span><span style="color: #0000ff;">return</span> <span style="color: #800000;">"</span><span style="color: #800000;">Cliente cadastrado com sucesso</span><span style="color: #800000;">"</span><span style="color: #000000;">;
        }
    }</span></pre>
</div>
<p>&nbsp;</p>
<h5>　<a name="OCP"></a>　2. 开放/封闭原则OCP</h5>
<p>　　　　类应该是可以可扩展的，可以用作构建其他相关新功能，这叫开放。但在实现相关功能时，不应该修改现有代码（因为已经过单元测试运行正常）这叫封闭。</p>
<p>　　　<strong><span style="color: #ff0000;">　(1) 演示：违反了开放/封闭原则，原因是每次增加新形状时，需要改变AreaCalculator 类的TotalArea方法，例如开发后期又增加了圆形形状。</span></strong></p>
<div class="cnblogs_code" style="padding-left: 40px;">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 长方形实体
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Rectangle
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">double</span> Height { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">double</span> Width { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
    }

    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 圆形
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Circle
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 半径
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">double</span> Radius { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
    }

    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 面积计算 
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> AreaCalculator
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">double</span> TotalArea(<span style="color: #0000ff;">object</span><span style="color: #000000;">[] arrObjects)
        {
            </span><span style="color: #0000ff;">double</span> area = <span style="color: #800080;">0</span><span style="color: #000000;">;
            Rectangle objRectangle;
            Circle objCircle;
            </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> obj <span style="color: #0000ff;">in</span><span style="color: #000000;"> arrObjects)
            {
                </span><span style="color: #0000ff;">if</span> (obj <span style="color: #0000ff;">is</span><span style="color: #000000;"> Rectangle)
                {
                    objRectangle </span>=<span style="color: #000000;"> (Rectangle)obj;
                    area </span>+= objRectangle.Height *<span style="color: #000000;"> objRectangle.Width;
                }
                </span><span style="color: #0000ff;">else</span><span style="color: #000000;">
                {
                    objCircle </span>=<span style="color: #000000;"> (Circle)obj;
                    area </span>+= objCircle.Radius * objCircle.Radius *<span style="color: #000000;"> Math.PI;
                }
            }
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> area;
        }
    }</span></pre>
</div>
<p>&nbsp;　　　<strong><span style="color: #339966;">　(2) 解决方案，使用开放/封闭原则，每次增加新形状时(开放)，不需要修改TotalArea方法(封闭)</span></strong></p>
<div class="cnblogs_code" style="padding-left: 40px;">
<pre><code> 　　<span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 形状抽象类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">abstract</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Shape
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 面积计算
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">abstract</span> <span style="color: #0000ff;">double</span><span style="color: #000000;"> Area();
    }

    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 长方形
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Rectangle : Shape
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">double</span> Height { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">double</span> Width { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">override</span> <span style="color: #0000ff;">double</span><span style="color: #000000;"> Area()
        {
            </span><span style="color: #0000ff;">return</span> Height *<span style="color: #000000;"> Width;
        }
    }

    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 圆形
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Circle : Shape
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">double</span> Radius { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">override</span> <span style="color: #0000ff;">double</span><span style="color: #000000;"> Area()
        {
            </span><span style="color: #0000ff;">return</span> Radius * Radius *<span style="color: #000000;"> Math.PI;
        }
    }

    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 面积计算
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> AreaCalculator
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">double</span><span style="color: #000000;"> TotalArea(Shape[] arrShapes)
        {
            </span><span style="color: #0000ff;">double</span> area = <span style="color: #800080;">0</span><span style="color: #000000;">;
            </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> objShape <span style="color: #0000ff;">in</span><span style="color: #000000;"> arrShapes)
            {
                area </span>+=<span style="color: #000000;"> objShape.Area();
            }
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> area;
        }
    }</span></pre>
</div>
<p><span lang="EN-US">　　</span></p>
<h5>　<a name="LSP"></a>　3.里氏替换原则LSP</h5>
<p>　　　　这里也涉及到了类的继承，也适用于接口。子类可以替换它们的父类。里氏替换原则常见的代码问题是使用虚方法，在父类定义虚方法时，要确保该方法里没有任何私有成员。</p>
<p>　　　　<strong><span style="color: #ff0000;">(1) 演示：违反了里氏替换原则, 原因是不能使用ReadOnlySqlFile子类<strong>替代SqlFile</strong>父类。</span></strong></p>
<div class="cnblogs_code" style="padding-left: 40px;">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> sql文件类 读取、保存 
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> SqlFile
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> FilePath { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> FileText { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">virtual</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> LoadText()
        {
            </span><span style="color: #008000;">/*</span><span style="color: #008000;"> Code to read text from sql file </span><span style="color: #008000;">*/</span>
            <span style="color: #0000ff;">return</span> <span style="color: #800000;">"</span><span style="color: #800000;">..</span><span style="color: #800000;">"</span><span style="color: #000000;">;
        }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">virtual</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> SaveText()
        {
            </span><span style="color: #008000;">/*</span><span style="color: #008000;"> Code to save text into sql file </span><span style="color: #008000;">*/</span><span style="color: #000000;">
        }
    }

    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 开发途中增加了sql文件只读类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> ReadOnlySqlFile : SqlFile
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">override</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> LoadText()
        {
            </span><span style="color: #008000;">/*</span><span style="color: #008000;"> Code to read text from sql file </span><span style="color: #008000;">*/</span>
            <span style="color: #0000ff;">return</span> <span style="color: #800000;">"</span><span style="color: #800000;">..</span><span style="color: #800000;">"</span><span style="color: #000000;">;
        }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">override</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> SaveText()
        {
            </span><span style="color: #008000;">/*</span><span style="color: #008000;"> Throw an exception when app flow tries to do save. </span><span style="color: #008000;">*/</span>
           <span style="color: #ff0000;"> <strong>throw new IOException("Can't Save"</strong></span><span style="color: #000000;"><span style="color: #ff0000;"><strong>);</strong></span>
        }
    }


    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> SqlFileManager
    {
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 集合中存在两种类：SqlFile和ReadOnlySqlFile
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> List&lt;SqlFile&gt; lstSqlFiles { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 读取
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> GetTextFromFiles()
        {
            StringBuilder objStrBuilder </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> StringBuilder();
            </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> objFile <span style="color: #0000ff;">in</span><span style="color: #000000;"> lstSqlFiles)
            {
                objStrBuilder.Append(objFile.LoadText());
            }
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> objStrBuilder.ToString();
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> 保存
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> SaveTextIntoFiles()
        {
            </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> objFile <span style="color: #0000ff;">in</span><span style="color: #000000;"> lstSqlFiles)
            {
                </span><span style="color: #008000;">//</span><span style="color: #008000;">检查当前对象是ReadOnlySqlFile类,跳过调用SaveText()方法  </span>
                <span style="color: #0000ff;">if</span> (!(objFile <span style="color: #0000ff;">is</span><span style="color: #000000;"> ReadOnlySqlFile))
                {
                    objFile.SaveText();
                }
            }
        }
    }  </span></pre>
</div>
<p>&nbsp;　　　<strong><span style="color: #339966;">　(2) 解决方案，使用里氏替换原则，子类可以完全代替父类</span></strong></p>
<div class="cnblogs_code" style="padding-left: 40px;">
<pre><code> 　　<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> IReadableSqlFile
    {
        </span><span style="color: #0000ff;">string</span><span style="color: #000000;"> LoadText();
    }
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> IWritableSqlFile
    {
        </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> SaveText();
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> ReadOnlySqlFile : IReadableSqlFile
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> FilePath { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> FileText { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> LoadText()
        {
            </span><span style="color: #008000;">/*</span><span style="color: #008000;"> Code to read text from sql file </span><span style="color: #008000;">*/</span>
            <span style="color: #0000ff;">return</span> <span style="color: #800000;">""</span><span style="color: #000000;">;
        }
    }


    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> SqlFile : IWritableSqlFile, IReadableSqlFile
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> FilePath { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> FileText { <span style="color: #0000ff;">get</span>; <span style="color: #0000ff;">set</span><span style="color: #000000;">; }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> LoadText()
        {
            </span><span style="color: #008000;">/*</span><span style="color: #008000;"> Code to read text from sql file </span><span style="color: #008000;">*/</span>
            <span style="color: #0000ff;">return</span> <span style="color: #800000;">""</span><span style="color: #000000;">;
        }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> SaveText()
        {
            </span><span style="color: #008000;">/*</span><span style="color: #008000;"> Code to save text into sql file </span><span style="color: #008000;">*/</span><span style="color: #000000;">
        }
    }


    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> SqlFileManager
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">string</span> GetTextFromFiles(List&lt;IReadableSqlFile&gt;<span style="color: #000000;"> aLstReadableFiles)
        {
            StringBuilder objStrBuilder </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> StringBuilder();
            </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> objFile <span style="color: #0000ff;">in</span><span style="color: #000000;"> aLstReadableFiles)
            {
                </span><span style="color: #008000;">//</span><span style="color: #008000;">ReadOnlySqlFile的LoadText实现</span>
<span style="color: #000000;">                objStrBuilder.Append(objFile.LoadText());
            }
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> objStrBuilder.ToString();
        }

        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> SaveTextIntoFiles(List&lt;IWritableSqlFile&gt;<span style="color: #000000;"> aLstWritableFiles)
        {
            </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> objFile <span style="color: #0000ff;">in</span><span style="color: #000000;"> aLstWritableFiles)
            {
                </span><span style="color: #008000;">//</span><span style="color: #008000;">SqlFile的SaveText实现</span>
<span style="color: #000000;">                objFile.SaveText();
            }
        }
    }</span></pre>
</div>
<p>&nbsp;</p>
<h5>　<a name="ISP"></a>　4.接口分离原则ISP</h5>
<p>　　　　接口分离原则是解决接口臃肿的问题，建议接口保持最低限度的函数。永远不应该强迫客户端依赖于它们不用的接口。</p>
<p>　　　<span style="color: #ff0000;">　<strong>&nbsp;(1)&nbsp; 演示：违反了接口分离原则。原因是Manager无法处理任务，同时没有人可以将任务分配给Manager，因此WorkOnTask方法不应该在Manager类中。</strong></span></p>
<div class="cnblogs_code" style="padding-left: 40px;">
<pre><code><span style="color: #808080;">　　 ///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 领导接口
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> ILead
    {
        </span><span style="color: #008000;">//</span><span style="color: #008000;">创建任务</span>
        <span style="color: #0000ff;">void</span><span style="color: #000000;"> CreateSubTask();
        </span><span style="color: #008000;">//</span><span style="color: #008000;">分配任务</span>
        <span style="color: #0000ff;">void</span><span style="color: #000000;"> AssginTask();
        </span><span style="color: #008000;">//</span><span style="color: #008000;">处理指定任务</span>
        <span style="color: #0000ff;">void</span><span style="color: #000000;"> WorkOnTask();
    }

    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 团队领导
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> TeamLead : ILead
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> AssginTask()
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">Code to assign a task.  </span>
<span style="color: #000000;">        }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> CreateSubTask()
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">Code to create a sub task  </span>
<span style="color: #000000;">        }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> WorkOnTask()
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">Code to implement perform assigned task.  </span>
<span style="color: #000000;">        }
    }

    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 管理者
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Manager : ILead
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> AssginTask()
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">Code to assign a task.  </span>
<span style="color: #000000;">        }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> CreateSubTask()
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">Code to create a sub task.  </span>
<span style="color: #000000;">        }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> WorkOnTask()
        {
            </span><strong><span style="color: #ff0000;">throw new Exception("Manager can't work on Task"</span></strong><span style="color: #000000;"><strong><span style="color: #ff0000;">);</span></strong>
        }
    }</span></pre>
</div>
<p>&nbsp;　　　<strong><span style="color: #339966;">　(2) 解决方案，使用接口分离原则</span></strong></p>
<div class="cnblogs_code" style="padding-left: 40px;">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 程序员角色
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> IProgrammer
    {
        </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> WorkOnTask();
    }

    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 领导角色
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> ILead
    {
        </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> AssignTask();
        </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> CreateSubTask();
    }

    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 程序员：执行任务
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Programmer : IProgrammer
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> WorkOnTask()
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">code to implement to work on the Task.  </span>
<span style="color: #000000;">        }
    }

    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 管理者：可以创建任务、分配任务
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Manager : ILead
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> AssignTask()
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">Code to assign a Task  </span>
<span style="color: #000000;">        }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> CreateSubTask()
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">Code to create a sub taks from a task.  </span>
<span style="color: #000000;">        }
    }

    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 团队领域：可以创建任务、分配任务、执行执行
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> TeamLead : IProgrammer, ILead
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> AssignTask()
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">Code to assign a Task  </span>
<span style="color: #000000;">        }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> CreateSubTask()
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">Code to create a sub task from a task.  </span>
<span style="color: #000000;">        }
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> WorkOnTask()
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">code to implement to work on the Task.  </span>
<span style="color: #000000;">        }
    }</span></pre>
</div>
<p>&nbsp;</p>
<h5>　<a name="DIP"></a>　5. 依赖反转原则DIP</h5>
<p>　　　　依赖反转原则是对程序的解耦。高级模块/类不应依赖于低级模块/类，两者都应该依赖于抽象。意思是：当某个类被外部依赖时，就需要把该类抽象成一个接口。接口如何变成可调用的实例呢？实践中多用依赖注入模式。这个依赖反转原则在DDD中得到了很好的运用实践(参考前三篇)。</p>
<p>　　<strong><span style="color: #ff0000;">　　(1) 演示：违反了依赖反转原则。原因是：每当客户想要引入新的Logger记录形式时，我们需要通过添加新方法来改变ExceptionLogger类。这里错误的体现了：高级类 ExceptionLogger直接引用低级类FileLogger和DbLogger来记录异常。</span></strong></p>
<div class="cnblogs_code" style="padding-left: 40px;">
<pre><code> 　　<span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 数据库日志类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> DbLogger
    {
        </span><span style="color: #008000;">//</span><span style="color: #008000;">写入日志</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> LogMessage(<span style="color: #0000ff;">string</span><span style="color: #000000;"> aMessage)
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">Code to write message in database.  </span>
<span style="color: #000000;">        }
    }


    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 文件日志类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> FileLogger
    {
        </span><span style="color: #008000;">//</span><span style="color: #008000;">写入日志</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> LogMessage(<span style="color: #0000ff;">string</span><span style="color: #000000;"> aStackTrace)
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">code to log stack trace into a file.  </span>
<span style="color: #000000;">        }
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> ExceptionLogger
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> LogIntoFile(Exception aException)
        {
            FileLogger objFileLogger </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> FileLogger();
            objFileLogger.LogMessage(GetUserReadableMessage(aException));
        }

        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> LogIntoDataBase(Exception aException)
        {
            DbLogger objDbLogger </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> DbLogger();
            objDbLogger.LogMessage(GetUserReadableMessage(aException));
        }

        </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> GetUserReadableMessage(Exception ex)
        {
            </span><span style="color: #0000ff;">string</span> strMessage = <span style="color: #0000ff;">string</span><span style="color: #000000;">.Empty;
            </span><span style="color: #008000;">//</span><span style="color: #008000;">code to convert Exception's stack trace and message to user readable format.  </span>
            <span style="color: #0000ff;">return</span><span style="color: #000000;"> strMessage;
        }
    }


    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> DataExporter
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> ExportDataFromFile()
        {
            </span><span style="color: #0000ff;">try</span><span style="color: #000000;">
            {
                </span><span style="color: #008000;">//</span><span style="color: #008000;">code to export data from files to database.  </span>
<span style="color: #000000;">            }
            </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (IOException ex)
            {
                </span><span style="color: #0000ff;">new</span><span style="color: #000000;"> ExceptionLogger().LogIntoDataBase(ex);
            }
            </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (Exception ex)
            {
                </span><span style="color: #0000ff;">new</span><span style="color: #000000;"> ExceptionLogger().LogIntoFile(ex);
            }
        }
    }</span></pre>
</div>
<p>&nbsp;　　　<strong><span style="color: #339966;">　(2) 解决方案，使用依赖反转原则，这里演示没有用依赖注入。</span></strong></p>
<div class="cnblogs_code" style="padding-left: 40px;">
<pre><code>   <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> ILogger
    {
        </span><span style="color: #0000ff;">void</span> LogMessage(<span style="color: #0000ff;">string</span><span style="color: #000000;"> aString);
    }


    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 数据库日志类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> DbLogger : ILogger
    {
        </span><span style="color: #008000;">//</span><span style="color: #008000;">写入日志</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> LogMessage(<span style="color: #0000ff;">string</span><span style="color: #000000;"> aMessage)
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">Code to write message in database.  </span>
<span style="color: #000000;">        }
    }


    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 文件日志类
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> FileLogger : ILogger
    {
        </span><span style="color: #008000;">//</span><span style="color: #008000;">写入日志</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> LogMessage(<span style="color: #0000ff;">string</span><span style="color: #000000;"> aStackTrace)
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">code to log stack trace into a file.  </span>
<span style="color: #000000;">        }
    }


    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> ExceptionLogger
    {
        </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> ILogger _logger;
        </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> ExceptionLogger(ILogger aLogger)
        {
            </span><span style="color: #0000ff;">this</span>._logger =<span style="color: #000000;"> aLogger;
        }<br />
        </span><strong><span style="color: #008000;">//</span><span style="color: #008000;">可以与这些日志类达到松散耦合</span></strong>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> LogException(Exception aException)
        {
            </span><span style="color: #0000ff;">string</span> strMessage =<span style="color: #000000;"> GetUserReadableMessage(aException);
            </span><span style="color: #ff0000;">this</span><span style="color: #000000;"><span style="color: #ff0000;">._logger.LogMessage(strMessage);</span>
        }

        </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> GetUserReadableMessage(Exception aException)
        {
            </span><span style="color: #0000ff;">string</span> strMessage = <span style="color: #0000ff;">string</span><span style="color: #000000;">.Empty;
            </span><span style="color: #008000;">//</span><span style="color: #008000;">code to convert Exception's stack trace and message to user readable format.  </span>
            <span style="color: #0000ff;">return</span><span style="color: #000000;"> strMessage;
        }
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> DataExporter
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> ExportDataFromFile()
        {
            ExceptionLogger _exceptionLogger;
            </span><span style="color: #0000ff;">try</span><span style="color: #000000;">
            {
                </span><span style="color: #008000;">//</span><span style="color: #008000;">code to export data from files to database.  </span>
<span style="color: #000000;">            }
            </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (IOException ex)
            {
                _exceptionLogger </span>= <span style="color: #0000ff;">new</span> ExceptionLogger(<span style="color: #0000ff;">new</span><span style="color: #000000;"> DbLogger());
                _exceptionLogger.LogException(ex);
            }
            </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (Exception ex)
            {
                _exceptionLogger </span>= <span style="color: #0000ff;">new</span> ExceptionLogger(<span style="color: #0000ff;">new</span><span style="color: #000000;"> FileLogger());
                _exceptionLogger.LogException(ex);
            }
        }
    }</span></pre>
</div>
<p>&nbsp;</p>
<p>　　参考文献</p>
<p>　　　　<a href="https://www.c-sharpcorner.com/UploadFile/damubetha/solid-principles-in-C-Sharp/" target="_blank">SOLID原则简介</a></p>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>