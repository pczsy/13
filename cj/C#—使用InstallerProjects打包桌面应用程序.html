<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修C#—使用InstallerProjects打包桌面应用程序' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>C#—使用InstallerProjects打包桌面应用程序</center></div><div class='banquan'>原文出处:本文由博客园博主kiba518提供。<br/>
原文连接:https://www.cnblogs.com/kiba/p/11052619.html</div><br>
    <p style="width: 100%; background: #4169E1; color: #ffffff; height: 50px; font-size: 30px; line-height: 50px;"><strong>前言</strong></p>
<p>打包桌面应用程序实在是一个不常使用的东西，偶尔使用起来经常会忘东忘西的耽误时间，因此，这篇文章多以图片记录过程，也是用于备忘。&nbsp;</p>
<p style="width: 100%; background: #4169E1; color: #ffffff; height: 50px; font-size: 30px; line-height: 50px;"><strong>下载打包工具</strong></p>
<p>C#打包桌面应用程序有很多种方法，这里介绍一种使用Microsoft Visual Studio Installer Projects工具打包的方法。</p>
<p>首先，我们先创建一个Windows桌面应用，如图：</p>
<p><img src="./images/C#—使用InstallerProjects打包桌面应用程序0.png" alt="" /></p>
<p>接下来我们选择工具，点击扩展和更新，如图：</p>
<p><img src="./images/C#—使用InstallerProjects打包桌面应用程序1.png" alt="" /></p>
<p>然后我们得到界面如下，如图：</p>
<p><img src="./images/C#—使用InstallerProjects打包桌面应用程序2.png" alt="" /></p>
<p>界面默认显示的是已安装的内容，我们仔细看下内容，会发现，这里都是我们已经安装过的工具，在仔细看，我们会发现，这里大部分工具的创建者都是microsoft，也就是说，这里的工具都是官方给我们提供的工具。</p>
<p>因为我们要下载本机不存在的工具，所以我们点击左侧菜单的【联机】按钮，然后在右上角的搜索框中输入Microsoft Visual Studio Installer Projects进行检索，如图：</p>
<p><img src="./images/C#—使用InstallerProjects打包桌面应用程序3.png" alt="" /></p>
<p>然后我们选中Microsoft Visual Studio Installer Projects选项，点击选项中右上角的下载，将该工具下载到本地。</p>
<p>下载完成后，我们会发现，在当前窗体的下方有这样一个提示。</p>
<p><img src="./images/C#—使用InstallerProjects打包桌面应用程序4.png" alt="" /></p>
<p>该提示，告诉我们，虽然工具已经下载完成了，但还没有进行安装，需要我们关闭Visual Studio后，才能安装。</p>
<p>关闭Visual Studio后，会自动弹出如下提示框，系统还会提示我们是否允许，我们选择【是】。</p>
<p><img src="./images/C#—使用InstallerProjects打包桌面应用程序5.png" alt="" /></p>
<p>接下来，该窗体会显示工具的相关内容，下方会增加一个修改按钮，如下图：</p>
<p>&nbsp;<img src="./images/C#—使用InstallerProjects打包桌面应用程序6.png" alt="" /></p>
<p>我们点击修改，然后工具就会自动安装了。</p>
<p style="width: 100%; background: #4169E1; color: #ffffff; height: 50px; font-size: 30px; line-height: 50px;"><strong>创建打包项目</strong></p>
<p>等待工具安装完成后，我们重新打开Visual Studio，打开刚刚我们建立的WPF项目。</p>
<p>在WPF项目所在的解决方案中，我们右键新建项目，然后选择左边菜单的【其他项目类型】&mdash;【Setup Project】，创建安装工程KibaInstallSetup，如下图：</p>
<p><img src="./images/C#—使用InstallerProjects打包桌面应用程序7.png" alt="" /></p>
<p>点击确定 ，我们可以看到如下窗口。</p>
<p><img src="./images/C#—使用InstallerProjects打包桌面应用程序8.png" alt="" /></p>
<p>该窗口左边窗口有三个文件夹图片，对应内容如下：</p>
<p>Application Folder：应用程序包含的文件设置。</p>
<p>User's Desktop：用户桌面快捷方式设置。</p>
<p>User's Programs Menu：用户启动菜单的快捷方式设置。</p>
<p>我们先看Application Folder的使用方式，首先选中Application Folder，然后右键&mdash;&gt;Add&mdash;&gt;项目输出。</p>
<p><img src="./images/C#—使用InstallerProjects打包桌面应用程序9.png" alt="" /></p>
<p>点击后，弹出[添加项目输出组页面]，如下图，因为解决方案下只有一个项目，所以我这里项目选择中只有一个选项。</p>
<p>&nbsp;<img src="./images/C#—使用InstallerProjects打包桌面应用程序10.png" alt="" /></p>
<p>点击确定，我们就成功的把项目主输出添加进来了，如下图：</p>
<p><img src="./images/C#—使用InstallerProjects打包桌面应用程序11.png" alt="" /></p>
<p>此时，我们右键我们的安装工程KibaInstallSetup&mdash;生成，就已经可以生成该项目的可执行文件了，如下图：</p>
<p><img src="./images/C#—使用InstallerProjects打包桌面应用程序12.png" alt="" /></p>
<p>不过，此时的安装文件是最基础的安装文件，什么自定义都没有。</p>
<p>下面我们为安装文件增加桌面快捷方式图标和开始菜单的快捷方式，并且修改可执行文件的作者、描述等等信息。</p>
<p>PS：Application Folder只能右键添加文件，无法添加文件夹，但可以使用Ctrl+C Ctrl+V来添加文件夹。</p>
<p style="width: 100%; background: #4169E1; color: #ffffff; height: 50px; font-size: 30px; line-height: 50px;"><strong>打包项目属性配置</strong></p>
<p><strong>项目属性</strong></p>
<p>我们先进行安装文件的基础信息更改。</p>
<p>首先，我们左键选中项目，然后选择属性，注意，不是右键选择属性，而是如下图一样选择属性。</p>
<p><img src="./images/C#—使用InstallerProjects打包桌面应用程序13.png" alt="" /></p>
<p>点击后，修改一下作者和描述，属性界面如下图所示：</p>
<p><img src="./images/C#—使用InstallerProjects打包桌面应用程序14.png" alt="" /></p>
<p><span style="color: #ff0000;"><strong>【注意：如果是打包x64的应用程序，需要将上图中的TargetPlatform设置为x64。】</strong></span></p>
<p><strong>桌面快捷方式</strong></p>
<p>现在我们修改安装程序的快捷方式图片。</p>
<p>左键选中User's Desktop，然后将鼠标移动到右侧窗体，右键选择[创建新的快捷方式]，如下图。</p>
<p><img src="./images/C#—使用InstallerProjects打包桌面应用程序15.png" alt="" /></p>
<p>然后，系统弹出一个让我们选择.ico文件的界面，但界面中只有三个文件夹，对应的是我们安装工程左上角的三个文件夹，如下图：</p>
<p><img src="./images/C#—使用InstallerProjects打包桌面应用程序16.png" alt="" /></p>
<p>现在我们双击第一个应用程序目录选项，然后点击Add File，向安装目录下添加一个logo.ico文件，最后点击OK。</p>
<p>这样我们就成功创建了桌面快捷方式了，如下图。</p>
<p><img src="./images/C#—使用InstallerProjects打包桌面应用程序17.png" alt="" /></p>
<p>现在，我们右键这个Shortcut to logo.ico，修改其名字为Kiba，然后左键点击选中，查看其属性，如下图。</p>
<p><img src="./images/C#—使用InstallerProjects打包桌面应用程序18.png" alt="" /></p>
<p>可以看到，我们的快捷方式已经成功指向了我们的主输出，并且Icon也已经修改了。如果不满意指向和Icon，可以在属性里二次修改。</p>
<p><strong>用户菜单快捷方式</strong></p>
<p>用户菜单的快捷方式就是在User's Programs Menu里设置，其设置的方法和桌面快捷方式的设置方法是一模一样的。</p>
<p style="width: 100%; background: #4169E1; color: #ffffff; height: 50px; font-size: 30px; line-height: 50px;"><strong>依赖文件和依赖框架</strong></p>
<p><strong>依赖文件</strong></p>
<p>我们在打包应用程序时，有时候会需要一些依赖文件，这些文件并不能被主程序引用，但还需要和主程序在同一个安装路径下，那么在打包时，也就需要额外的把这些文件也打包进来。</p>
<p>添加额外依赖文件的方法很简单，选择Application Folder，在其对应的右侧窗体中，右键&mdash;Add&mdash;文件，如下图：</p>
<p><img src="./images/C#—使用InstallerProjects打包桌面应用程序19.png" alt="" /></p>
<p>然后，在弹出的选择文件对话框中选择文件即可。</p>
<p><strong>依赖框架</strong></p>
<p>有时候我们的应用程序需要安装到一个没有Framework的电脑上，那么就需要打包的时候，把Framework也打包进来，或者在用户安装时提示对方下载。</p>
<p>我们右键项目，选择属性，然后在弹出的属性页中点击Prerequisites，如下图：</p>
<p><img src="./images/C#—使用InstallerProjects打包桌面应用程序20.png" alt="" /></p>
<p>然后，在系统必备的窗体中，勾选Framework 4.6.1，在选择【从组件供应商的网站上下载系统必备组件】。</p>
<p>这样，我们的可执行文件在运行时，就会提示客户去微软官网下载Framework 4.6.1了，如下图：</p>
<p><img src="./images/C#—使用InstallerProjects打包桌面应用程序21.png" alt="" /></p>
<p>当然，我们也可以把Framework 4.6.1打包进来，但这需要我们提前把Framework&nbsp;的安装包下载下来，然后选择【从下列位置下载系统必备组件】，这样那个置灰的【浏览】按钮就可以使用了。</p>
<p>----------------------------------------------------------------------------------------------------</p>
<p>到此，使用InstallerProjects打包桌面应用程序讲解就结束了。</p>
<p>代码已经传到Github上了，欢迎大家下载。</p>
<p style="border: 2px solid #73bf00; padding: 10px 40px; background: #ccff80; border-radius: 15px; -moz-border-radius: 15px;">Github地址：<a href="https://github.com/kiba518/KibaInstall" target="_blank">https://github.com/kiba518/KibaInstall</a></p>
<p>----------------------------------------------------------------------------------------------------</p>
<p>注：此文章为原创，任何形式的转载都请联系作者获得授权并注明出处！<br />若您觉得这篇文章还不错，请点击下方的<span style="color: #ff0000;">【<strong>推荐】</strong></span>，非常感谢！
</p>
<p>&nbsp;<img src="./images/C#—使用InstallerProjects打包桌面应用程序22.png" alt="" /></p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>