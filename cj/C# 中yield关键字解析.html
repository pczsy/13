<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='ç”µè„‘,ç”µè„‘è®²è§£,ç”µè„‘æŠ€æœ¯,ç¼–ç¨‹,ç”µè„‘æ•…éšœç»´ä¿®C# ä¸­yieldå…³é”®å­—è§£æ' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>é¦–é¡µ</a></li>
</div><div onclick='hidden1()' >åˆ†äº«</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>C# ä¸­yieldå…³é”®å­—è§£æ</center></div><div class='banquan'>åŸæ–‡å‡ºå¤„:æœ¬æ–‡ç”±åšå®¢å›­åšä¸»å°ä¸–ç•Œçš„é‡å­©å­æä¾›ã€‚<br/>
åŸæ–‡è¿æ¥:https://www.cnblogs.com/hulizhong/p/11763956.html</div><br>
    <h2><strong>å‰è¨€</strong></h2>
<p><span style="font-family: å¾®è½¯é›…é»‘;">ã€€ã€€å‰æ®µæ—¶é—´äº†è§£åˆ°</span>yieldå…³é”®å­—ï¼Œä¸€ç›´è§‰å¾—è¿˜ä¸é”™ã€‚ä»Šå¤©ç»™å¤§å®¶åˆ†äº«ä¸€ä¸‹yieldå…³é”®å­—çš„ç”¨æ³•ã€‚yield return è¿”å›é›†åˆä¸æ˜¯ä¸€æ¬¡æ€§è¿”å›æ‰€æœ‰é›†åˆå…ƒç´ ï¼Œè€Œæ˜¯ä¸€æ¬¡è°ƒç”¨è¿”å›ä¸€ä¸ªå…ƒç´ ã€‚å…·ä½“å¦‚ä½•ä½¿ç”¨yield return è¿”å›é›†åˆå‘¢ï¼Ÿæˆ‘ä»¬ä¸€èµ·å¾€ä¸‹é¢çœ‹å§ã€‚</p>
<h2><strong>yieldä½¿ç”¨ä»‹ç»</strong></h2>
<p style="margin-left: 30px;"><strong>yield return å’Œyield breakï¼š</strong></p>
<p style="margin-left: 30px;"><strong><span style="font-family: å¾®è½¯é›…é»‘;">æˆ‘ä»¬çœ‹ä¸‹å¹³å¸¸å¾ªç¯è¿”å›é›†åˆçš„ä½¿ç”¨æ“ä½œï¼ˆè¿”å›</span>1-100ä¸­çš„å¶æ•°ï¼‰ï¼š</strong></p>
<div class="cnblogs_code">
<pre><code>  <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">private</span> List&lt;<span style="color: #0000ff;">int</span>&gt; _numArray; <span style="color: #008000;">//</span><span style="color: #008000;">ç”¨æ¥ä¿å­˜1-100 è¿™100ä¸ªæ•´æ•°</span>
<span style="color: #000000;">
        Program() </span><span style="color: #008000;">//</span><span style="color: #008000;">æ„é€ å‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªæ„é€ å‡½æ•°å¾€å¾…æµ‹è¯•é›†åˆä¸­å­˜å…¥1-100è¿™100ä¸ªæµ‹è¯•æ•°æ®</span>
<span style="color: #000000;">        {
            _numArray </span>= <span style="color: #0000ff;">new</span> List&lt;<span style="color: #0000ff;">int</span>&gt;(); <span style="color: #008000;">//</span><span style="color: #008000;">ç»™é›†åˆå˜é‡å¼€å§‹åœ¨å †å†…å­˜ä¸Šå¼€å†…å­˜ï¼Œå¹¶ä¸”æŠŠå†…å­˜é¦–åœ°å€äº¤ç»™è¿™ä¸ª_numArrayå˜é‡</span>

            <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">1</span>; i &lt;= <span style="color: #800080;">100</span>; i++<span style="color: #000000;">)
            {
                _numArray.Add(i);  </span><span style="color: #008000;">//</span><span style="color: #008000;">æŠŠ1åˆ°100ä¿å­˜åœ¨é›†åˆå½“ä¸­æ–¹ä¾¿æ“ä½œ</span>
<span style="color: #000000;">            }
        }

        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">new</span><span style="color: #000000;"> Program();

            TestMethod();


        }

        </span><span style="color: #008000;">//</span><span style="color: #008000;">æµ‹è¯•æ±‚1åˆ°100ä¹‹é—´çš„å…¨éƒ¨å¶æ•°</span>
        <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> TestMethod()
        {
            </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> item <span style="color: #0000ff;">in</span><span style="color: #000000;"> GetAllEvenNumberOld())
            {
                Console.WriteLine(item); </span><span style="color: #008000;">//</span><span style="color: #008000;">è¾“å‡ºå¶æ•°æµ‹è¯•</span>
<span style="color: #000000;">            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> ä½¿ç”¨å¹³å¸¸è¿”å›é›†åˆæ–¹æ³•
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
        <span style="color: #0000ff;">static</span> IEnumerable&lt;<span style="color: #0000ff;">int</span>&gt;<span style="color: #000000;"> GetAllEvenNumberOld()
        {
            </span><span style="color: #0000ff;">var</span> listNum = <span style="color: #0000ff;">new</span> List&lt;<span style="color: #0000ff;">int</span>&gt;<span style="color: #000000;">();
            </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">int</span> num <span style="color: #0000ff;">in</span><span style="color: #000000;"> _numArray)
            {
                </span><span style="color: #0000ff;">if</span> (num % <span style="color: #800080;">2</span> == <span style="color: #800080;">0</span>) <span style="color: #008000;">//</span><span style="color: #008000;">åˆ¤æ–­æ˜¯ä¸æ˜¯å¶æ•°</span>
<span style="color: #000000;">                {
                    listNum.Add(num); </span><span style="color: #008000;">//</span><span style="color: #008000;">è¿”å›å½“å‰å¶æ•°</span>
<span style="color: #000000;">
                }
            }
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> listNum;
        } 
    }</span></pre>
</div>
<p>&nbsp;</p>
<p style="margin-left: 30px;"><strong><span style="font-family: å¾®è½¯é›…é»‘;">ç„¶åæˆ‘ä»¬å†çœ‹çœ‹ä½¿ç”¨</span>yield returnè¿”å›é›†åˆæ“ä½œï¼š</strong></p>
<div class="cnblogs_code">
<pre><code> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    {
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">private</span> List&lt;<span style="color: #0000ff;">int</span>&gt; _numArray; <span style="color: #008000;">//</span><span style="color: #008000;">ç”¨æ¥ä¿å­˜1-100 è¿™100ä¸ªæ•´æ•°</span>
<span style="color: #000000;">
        Program() </span><span style="color: #008000;">//</span><span style="color: #008000;">æ„é€ å‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªæ„é€ å‡½æ•°å¾€å¾…æµ‹è¯•é›†åˆä¸­å­˜å…¥1-100è¿™100ä¸ªæµ‹è¯•æ•°æ®</span>
<span style="color: #000000;">        {
            _numArray </span>= <span style="color: #0000ff;">new</span> List&lt;<span style="color: #0000ff;">int</span>&gt;(); <span style="color: #008000;">//</span><span style="color: #008000;">ç»™é›†åˆå˜é‡å¼€å§‹åœ¨å †å†…å­˜ä¸Šå¼€å†…å­˜ï¼Œå¹¶ä¸”æŠŠå†…å­˜é¦–åœ°å€äº¤ç»™è¿™ä¸ª_numArrayå˜é‡</span>

            <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">1</span>; i &lt;= <span style="color: #800080;">100</span>; i++<span style="color: #000000;">)
            {
                _numArray.Add(i);  </span><span style="color: #008000;">//</span><span style="color: #008000;">æŠŠ1åˆ°100ä¿å­˜åœ¨é›†åˆå½“ä¸­æ–¹ä¾¿æ“ä½œ</span>
<span style="color: #000000;">            }
        }

        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">new</span><span style="color: #000000;"> Program();

            TestMethod();


        }

        </span><span style="color: #008000;">//</span><span style="color: #008000;">æµ‹è¯•æ±‚1åˆ°100ä¹‹é—´çš„å…¨éƒ¨å¶æ•°</span>
        <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> TestMethod()
        {
            </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> item <span style="color: #0000ff;">in</span><span style="color: #000000;"> GetAllEvenNumber())
            {
                Console.WriteLine(item); </span><span style="color: #008000;">//</span><span style="color: #008000;">è¾“å‡ºå¶æ•°æµ‹è¯•</span>
<span style="color: #000000;">            }
        }  

        </span><span style="color: #008000;">//</span><span style="color: #008000;">ä½¿ç”¨Yield Returnæƒ…å†µä¸‹çš„æ–¹æ³•</span>
        <span style="color: #0000ff;">static</span> IEnumerable&lt;<span style="color: #0000ff;">int</span>&gt;<span style="color: #000000;"> GetAllEvenNumber()
        {

            </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">int</span> num <span style="color: #0000ff;">in</span><span style="color: #000000;"> _numArray)
            {
                </span><span style="color: #0000ff;">if</span> (num % <span style="color: #800080;">2</span> == <span style="color: #800080;">0</span>) <span style="color: #008000;">//</span><span style="color: #008000;">åˆ¤æ–­æ˜¯ä¸æ˜¯å¶æ•°</span>
<span style="color: #000000;">                {
                    </span><span style="color: #0000ff;">yield</span> <span style="color: #0000ff;">return</span> num; <span style="color: #008000;">//</span><span style="color: #008000;">è¿”å›å½“å‰å¶æ•°</span>
<span style="color: #000000;">
                }
            }
            </span><span style="color: #0000ff;">yield</span> <span style="color: #0000ff;">break</span>;  <span style="color: #008000;">//</span><span style="color: #008000;">å½“å‰é›†åˆå·²ç»éå†å®Œæ¯•ï¼Œæˆ‘ä»¬å°±è·³å‡ºå½“å‰å‡½æ•°ï¼Œå…¶å®ä½ ä¸åŠ ä¹Ÿå¯ä»¥
            </span><span style="color: #008000;">//</span><span style="color: #008000;">è¿™ä¸ªä½œç”¨å°±æ˜¯æå‰ç»“æŸå½“å‰å‡½æ•°ï¼Œå°±æ˜¯è¯´è¿™ä¸ªå‡½æ•°è¿è¡Œå®Œæ¯•äº†ã€‚</span>
<span style="color: #000000;">        }


    }</span></pre>
</div>
<p>&nbsp;</p>
<h2><strong><span style="font-family: å¾®è½¯é›…é»‘;">ä¸å¹³å¸¸</span>returnæ¯”è¾ƒ</strong></h2>
<p style="margin-left: 30px;"><span style="font-family: å¾®è½¯é›…é»‘;">ä¸Šé¢æˆ‘ä»¬çœ‹åˆ°äº†</span>yield return çš„ä½¿ç”¨æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªä¸returnè¿”å›é›†åˆæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿæˆ‘ä»¬çœ‹ä¸‹é¢ä¸€ä¸ªæ¡ˆä¾‹æ¥è¿›è¡Œåˆ†æï¼š</p>
<p style="margin-left: 30px;"><span style="font-family: å¾®è½¯é›…é»‘;">æˆ‘ä»¬é¦–å…ˆå…ˆçœ‹é€šè¿‡</span>returunè¿”å›é›†åˆçš„ä¸€ä¸ªæ¡ˆä¾‹ï¼š</p>
<div class="cnblogs_code">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    { 
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> item <span style="color: #0000ff;">in</span><span style="color: #000000;"> GetNums())
            {
                Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">  common return:{item}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }
        } 

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> å¹³å¸¸return è¿”å›é›†åˆ
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> IEnumerable&lt;<span style="color: #0000ff;">int</span>&gt;<span style="color: #000000;"> GetNums()
        {
            </span><span style="color: #0000ff;">var</span> listNum = <span style="color: #0000ff;">new</span> List&lt;<span style="color: #0000ff;">int</span>&gt;<span style="color: #000000;">();
            </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">0</span>; i &lt; <span style="color: #800080;">10</span>; i++<span style="color: #000000;">)
            {
                Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">yield return:{i}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                listNum.Add(i);
            }
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> listNum;
        }


    }</span></pre>
</div>
<p><img src="./images/C# ä¸­yieldå…³é”®å­—è§£æ0.png" alt="" /></p>
<p style="margin-left: 30px;"><span style="font-family: å¾®è½¯é›…é»‘;">é€šè¿‡ä»£ç çš„è¿è¡Œç»“æœï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œè¿”å›çš„ç»“æœ</span> yield return å’Œcomment returnæ˜¯åˆ†æˆä¸¤è¾¹çš„ã€‚å…ˆæ‰§è¡Œå®Œä¸€ä¸ªç„¶åå¼€å§‹æ‰§è¡Œå¦å¤–ä¸€ä¸ªã€‚ä¸å¹²æ¶‰ã€‚</p>
<p style="margin-left: 30px;"><span style="font-family: å¾®è½¯é›…é»‘;">æˆ‘ä»¬æ¥ç€çœ‹ä¸‹ä½¿ç”¨</span>yield returnè¿”å›é›†åˆï¼š</p>
<div class="cnblogs_code">
<pre><code>    <span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
    { 
        </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> item <span style="color: #0000ff;">in</span><span style="color: #000000;"> GetNumsYield())
            {
                Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">  common return:{item}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
            }
        }

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> é€šè¿‡yield return è¿”å›é›†åˆ
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> IEnumerable&lt;<span style="color: #0000ff;">int</span>&gt;<span style="color: #000000;"> GetNumsYield()
        {
            </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">0</span>; i &lt; <span style="color: #800080;">10</span>; i++<span style="color: #000000;">)
            {
                Console.WriteLine($</span><span style="color: #800000;">"</span><span style="color: #800000;">yield return:{i}</span><span style="color: #800000;">"</span><span style="color: #000000;">);
                </span><span style="color: #0000ff;">yield</span> <span style="color: #0000ff;">return</span><span style="color: #000000;"> i;
            }
        } 
    }</span></pre>
</div>
<p><img src="./images/C# ä¸­yieldå…³é”®å­—è§£æ1.png" alt="" /></p>
<p style="margin-left: 30px;"><span style="font-family: å¾®è½¯é›…é»‘;">æˆ‘ä»¬çœ‹è¿™ä¸ªè¿è¡Œç»“æœï¼Œè¿™é‡Œ</span>yield return å’Œcomment return çš„è¾“å‡ºå®Œå…¨äº¤æ›¿äº†ã€‚è¿™é‡Œè¯´æ˜æ˜¯ä¸€æ¬¡è°ƒç”¨å°±è¿”å›äº†ä¸€ä¸ªå…ƒç´ ã€‚</p>
<p style="margin-left: 30px;"><strong><span style="font-family: å¾®è½¯é›…é»‘;">é€šè¿‡ä¸Šé¢çš„æ¡ˆä¾‹æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œ</span>yield return å¹¶ä¸æ˜¯ç­‰æ‰€æœ‰æ‰§è¡Œå®Œäº†æ‰ä¸€æ¬¡æ€§è¿”å›çš„ã€‚è€Œæ˜¯è°ƒç”¨ä¸€æ¬¡å°±è¿”å›ä¸€æ¬¡ç»“æœçš„å…ƒç´ ã€‚è¿™ä¹Ÿå°±æ˜¯æŒ‰éœ€ä¾›ç»™ã€‚</strong></p>
<h2><strong>è§£æå®šä¹‰ç±»</strong></h2>
<p style="margin-left: 30px;"><span style="font-family: å®‹ä½“;">æˆ‘ä»¬å·²ç»å¤§è‡´äº†è§£äº†</span>yield <span style="font-family: å®‹ä½“;">çš„ç”¨æ³•å’Œå®ƒä¸å¹³å¸¸çš„è¿”å›çš„åŒºåˆ«ã€‚æˆ‘ä»¬å¯ä»¥ç»§ç»­æŸ¥çœ‹å…¶è¿è¡ŒåŸç†ã€‚æˆ‘ä»¬é¦–å…ˆçœ‹è¿™ä¹ˆä¸€ä¸ªæ¡ˆä¾‹ï¼ˆåœ¨</span><span style="font-family: Calibri;">0-10</span><span style="font-family: å®‹ä½“;">ä¸­éšæœºè¿”å›äº”ä¸ªæ•°å­—ï¼‰ï¼š</span></p>
<p style="margin-left: 30px;">æˆ‘ä»¬é€šè¿‡<a href="https://sharplab.io/">SharpLab</a><span style="font-family: å®‹ä½“;">åç¼–è¯‘å…¶ä»£ç </span>,<span style="font-family: å®‹ä½“;">æˆ‘ä»¬è¿›è¡ŒæŸ¥çœ‹å‘ç°</span><span style="font-family: Calibri;">yield</span><span style="font-family: å®‹ä½“;">å…·ä½“è¯¦ç»†å®ç°ï¼š</span></p>
<p><img src="./images/C# ä¸­yieldå…³é”®å­—è§£æ2.png" alt="" width="626" height="601" />&nbsp;<img src="./images/C# ä¸­yieldå…³é”®å­—è§£æ3.png" alt="" width="617" height="533" /></p>
<p style="margin-left: 30px;"><strong><span style="font-family: å®‹ä½“;">æˆ‘ä»¬çœ‹åˆ°</span>yield<span style="font-family: å®‹ä½“;">å†…éƒ¨å«æœ‰ä¸€ä¸ªè¿­ä»£å™¨ã€‚è¿™æ ·å»å®ç°çš„è¿­ä»£éå†ã€‚åŒæ—¶åŒ…å«</span><span style="font-family: Calibri;">_state</span><span style="font-family: å®‹ä½“;">å­—æ®µã€ç”¨æ¥å­˜å‚¨ä¸Šä¸€æ¬¡çš„è®°å½•ã€‚</span><span style="font-family: Calibri;">_current</span><span style="font-family: å®‹ä½“;">åŒ…å«å½“å‰çš„å€¼ã€ä¹Ÿé€šè¿‡</span><span style="font-family: Calibri;">_initialThreadId</span><span style="font-family: å®‹ä½“;">è·å–å½“å‰çº¿ç¨‹</span><span style="font-family: Calibri;">id</span><span style="font-family: å®‹ä½“;">ã€‚å…¶ä¸­ä¸»è¦çš„æ–¹æ³•æ˜¯è¿­ä»£å™¨æ–¹æ³•</span><span style="font-family: Calibri;">MoveNext()</span><span style="font-family: å®‹ä½“;">ã€‚æˆ‘ä»¬æ ¹æ®åç¼–è¯‘ç»“æœæ¥å®ç°ä¸€ä¸ªä¸</span><span style="font-family: Calibri;">yiled</span><span style="font-family: å®‹ä½“;">ç›¸ä¼¼çš„ç±»ï¼š</span></strong></p>
<p style="margin-left: 30px;">&nbsp;</p>
<div class="cnblogs_code">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> è§£æyieldå¹¶å®šä¹‰ç›¸ä¼¼ç±»
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">sealed</span> <span style="color: #0000ff;">class</span> GetRandomNumbersClass : IEnumerable&lt;<span style="color: #0000ff;">int</span>&gt;, IEnumerable, IEnumerator&lt;<span style="color: #0000ff;">int</span>&gt;<span style="color: #000000;">, IDisposable, IEnumerator
    {
        </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> Random r = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Random();

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> çŠ¶æ€
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> _state;

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;">å‚¨å­˜å½“å‰å€¼
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> _current;

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> çº¿ç¨‹id
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> _initialThreadId;

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> é›†åˆå…ƒç´ æ•°é‡
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> count;

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> é›†åˆå…ƒç´ æ•°é‡
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> _count;

        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
        <span style="color: #808080;">///</span><span style="color: #008000;"> å½“å‰æŒ‡é’ˆ
        </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
        <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> i;

        </span><span style="color: #0000ff;">int</span> IEnumerator&lt;<span style="color: #0000ff;">int</span>&gt;<span style="color: #000000;">.Current
        {
            [DebuggerHidden]
            </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> _current;
            }
        }

        </span><span style="color: #0000ff;">object</span><span style="color: #000000;"> IEnumerator.Current
        {
            [DebuggerHidden]
            </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> _current;
            }
        }

        [DebuggerHidden]
        </span><span style="color: #0000ff;">public</span> GetRandomNumbersClass(<span style="color: #0000ff;">int</span><span style="color: #000000;"> state)
        {
            </span><span style="color: #0000ff;">this</span>._state =<span style="color: #000000;"> state;
            _initialThreadId </span>=<span style="color: #000000;"> Environment.CurrentManagedThreadId;
        }

        [DebuggerHidden]
        </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> IDisposable.Dispose()
        {
        }

        </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">bool</span><span style="color: #000000;"> MoveNext()
        {
            </span><span style="color: #0000ff;">switch</span><span style="color: #000000;"> (_state)
            {
                </span><span style="color: #0000ff;">default</span><span style="color: #000000;">:
                    </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
                </span><span style="color: #0000ff;">case</span> <span style="color: #800080;">0</span><span style="color: #000000;">:
                    _state </span>= -<span style="color: #800080;">1</span><span style="color: #000000;">;
                    i </span>= <span style="color: #800080;">0</span><span style="color: #000000;">;
                    </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
                </span><span style="color: #0000ff;">case</span> <span style="color: #800080;">1</span><span style="color: #000000;">:
                    _state </span>= -<span style="color: #800080;">1</span><span style="color: #000000;">;
                    i</span>++<span style="color: #000000;">;
                    </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
            }
            </span><span style="color: #0000ff;">if</span> (i &lt;<span style="color: #000000;"> count)
            {
                _current </span>= r.Next(<span style="color: #800080;">10</span><span style="color: #000000;">);
                _state </span>= <span style="color: #800080;">1</span><span style="color: #000000;">;
                </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;
            }
            </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
        }

        </span><span style="color: #0000ff;">bool</span><span style="color: #000000;"> IEnumerator.MoveNext()
        {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">ILSpy generated this explicit interface implementation from .override directive in MoveNext</span>
            <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">this</span><span style="color: #000000;">.MoveNext();
        }

        [DebuggerHidden]
        </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> IEnumerator.Reset()
        {
            </span><span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span><span style="color: #000000;"> NotSupportedException();
        }

        [DebuggerHidden]
        </span><span style="color: #0000ff;">public</span> IEnumerator&lt;<span style="color: #0000ff;">int</span>&gt;<span style="color: #000000;"> GetEnumerator()
        {
            GetRandomNumbersClass _getRandom;
            </span><span style="color: #0000ff;">if</span> (_state == -<span style="color: #800080;">2</span> &amp;&amp; _initialThreadId ==<span style="color: #000000;"> Environment.CurrentManagedThreadId)
            {
                _state </span>= <span style="color: #800080;">0</span><span style="color: #000000;">;
                _getRandom </span>= <span style="color: #0000ff;">this</span><span style="color: #000000;">;
            }
            </span><span style="color: #0000ff;">else</span><span style="color: #000000;">
            {
                _getRandom </span>= <span style="color: #0000ff;">new</span> GetRandomNumbersClass(<span style="color: #800080;">0</span><span style="color: #000000;">);
            }
            _getRandom.count </span>=<span style="color: #000000;"> _count;
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> _getRandom;
        }

        [DebuggerHidden]
        IEnumerator IEnumerable.GetEnumerator()
        {
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> GetEnumerator();
        }


        [IteratorStateMachine(</span><span style="color: #0000ff;">typeof</span><span style="color: #000000;">(GetRandomNumbersClass))]
        </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> IEnumerable&lt;<span style="color: #0000ff;">int</span>&gt; GetList(<span style="color: #0000ff;">int</span><span style="color: #000000;"> count)
        {
            GetRandomNumbersClass getRandomNumbersClass </span>= <span style="color: #0000ff;">new</span> GetRandomNumbersClass(-<span style="color: #800080;">2</span><span style="color: #000000;">);
            getRandomNumbersClass._count </span>=<span style="color: #000000;"> count;
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> getRandomNumbersClass;
        }
        </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> Main(<span style="color: #0000ff;">string</span><span style="color: #000000;">[] args)
        {
            IEnumerator</span>&lt;<span style="color: #0000ff;">int</span>&gt; enumerator = GetList(<span style="color: #800080;">5</span><span style="color: #000000;">).GetEnumerator();
            </span><span style="color: #0000ff;">try</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">int</span> item <span style="color: #0000ff;">in</span> GetList(<span style="color: #800080;">5</span><span style="color: #000000;">))
                    Console.WriteLine(item);
                </span><span style="color: #008000;">//</span><span style="color: #008000;">while (enumerator.MoveNext())
                </span><span style="color: #008000;">//</span><span style="color: #008000;">{
                </span><span style="color: #008000;">//</span><span style="color: #008000;">    int current = enumerator.Current;
                </span><span style="color: #008000;">//</span><span style="color: #008000;">    Console.WriteLine(current);
                </span><span style="color: #008000;">//</span><span style="color: #008000;">}</span>
<span style="color: #000000;">            }
            </span><span style="color: #0000ff;">finally</span><span style="color: #000000;">
            {
                </span><span style="color: #0000ff;">if</span> (enumerator != <span style="color: #0000ff;">null</span><span style="color: #000000;">)
                {
                    enumerator.Dispose();
                }
            }
            Console.ReadKey();
        }
    }</span></pre>
</div>
<p style="margin-left: 30px;">&nbsp;</p>
<p><strong>ã€€</strong></p>
<hr />
<p>&nbsp;</p>
<p><strong>ã€€ç”¨çˆ±ç”Ÿæ´»ï¼Œä½ ä¼šä½¿è‡ªå·±å¹¸ç¦ï¼ç”¨çˆ±å·¥ä½œï¼Œä½ ä¼šä½¿å¾ˆå¤šäººå¹¸ç¦ï¼&nbsp;</strong></p>
<p><a href="https://www.cnblogs.com/hulizhong/p/11205119.html" target="_blank"><strong>&nbsp; &nbsp;C<strong>#åŸºç¡€çŸ¥è¯†è¯¦è§£ç³»åˆ—</strong></strong></a></p>
<p><strong><strong>&nbsp; &nbsp;æ¬¢è¿å¤§å®¶æ‰«æä¸‹æ–¹äºŒç»´ç ï¼Œå’Œæˆ‘ä¸€èµ·å­¦ä¹ æ›´å¤šçš„çŸ¥è¯†ğŸ˜Š</strong></strong></p>
<p>&nbsp;<strong><img src="./images/C# ä¸­yieldå…³é”®å­—è§£æ4.png" alt="" width="278" height="278" /></strong></p>
<p style="margin-left: 30px;">&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>