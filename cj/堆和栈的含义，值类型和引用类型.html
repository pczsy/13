<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修堆和栈的含义，值类型和引用类型' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>堆和栈的含义，值类型和引用类型</center></div><div class='banquan'>原文出处:本文由博客园博主遥远的Ta提供。<br/>
原文连接:https://www.cnblogs.com/lycb/p/11056327.html</div><br>
    <h2>&nbsp;<span style="font-size: 16px;"><strong> &nbsp;本文主要是讨论栈和堆的含义，也就是</strong><span style="color: #ff0000;"><strong>C#的两种类据类型：值类型和引用类型；</strong></span></span></h2>
<h2><strong><span style="color: #ff0000;">　</span>一、堆与栈</strong></h2>
<ul>
<li><span style="font-size: 16px;"><span style="color: #ff0000;"><strong>&nbsp;<span style="color: #000000;">&nbsp;</span></strong></span></span><span style="color: #ff0000;"><span style="color: #000000;">什么是堆（Heap）？</span></span></li>
</ul>
<p style="margin-left: 90px;"><span style="color: #ff0000;"><span style="color: #000000;">☞&nbsp; &nbsp;堆是无序的，是一片不连续的内存域，由用户自己来控制和释放，如果用户自己不释放的话，当内存达到一定的特定值时或程序运行结束时，通过<strong>垃圾回收器（GC）</strong>来回收。</span></span></p>
<p style="margin-left: 90px;"><span style="color: #ff0000;"><span style="color: #000000;">☞&nbsp; &nbsp;是程序运行期间动态分配的内存空间，你可以根据程序的运行情况确定要分配的堆内存的大小。</span></span></p>
<ul>
<li><span style="color: #ff0000;"><span style="color: #000000;">&nbsp; 什么是栈（Stack）？</span></span></li>
</ul>
<p style="margin-left: 90px;">☞&nbsp; &nbsp;栈是有顺序的，是一片连续的内存域，保持着<strong>先进后出</strong>的原则，由系统自动分配和维护。</p>
<p style="margin-left: 90px;">☞&nbsp; &nbsp;是编译期间就分配好的内存空间，因此代码中必须就栈的大小有明确的定义。</p>
<p style="margin-left: 90px;">&nbsp; &nbsp; &nbsp; 即， 所分配的内存是在一块连续的内存区域内．当我们声明变量时，那么编译器会自动接着当前栈区的结尾来分配内存。</p>
<h2><strong>　二<span>、值类型与引用类型</span></strong></h2>
<ul>
<li>&nbsp; 概念：值类型直接存储其值在线程栈中，引用类型存储对其值的引用。部署：托管堆上部署了所有引用类型。这里需要指出一点：如果一个引用类型中的某个属性是值类型，这个值类型的属性是分配在托管堆上的。</li>
<li>&nbsp; 引用类型：基类为Objcet</li>
<li>&nbsp; 值类型：均隐式派生自System.ValueType；</li>
<li>&nbsp; 值类型与引用类型表：</li>
</ul>
<p><span style="color: #000000;"><img style="display: block; margin-left: auto; margin-right: auto;" src="./images/堆和栈的含义，值类型和引用类型0.png" alt="" /></span></p>
<ul>
<li>内存分配　　　&nbsp;&nbsp;　　　　　　　　</li>
</ul>
<p style="margin-left: 90px;">☞&nbsp; 值类型变量声明后，无论是否已经赋值，编译器都会为其分配内存。</p>
<p style="margin-left: 90px;">☞&nbsp;&nbsp;引用类型当声明一个类时，只会在栈中分配一小块内存用于存放引用地址，此时并没有为其分配堆上的空间。当类实例化时，分配内存空间，并把堆上空间的地址保存到栈上分配的小块空间中。</p>
<p style="margin-left: 90px;">☞&nbsp;&nbsp;值类型的实例通常是在线程栈上分配的（静态分配），但是在某些情形下可以存储在堆中。</p>
<p style="margin-left: 90px;">☞&nbsp;&nbsp;引用类型的对象总是在进程堆中分配（动态分配）。</p>
<ul>
<li>示例代码</li>
</ul>
<p style="margin-left: 90px;"><img src="./images/堆和栈的含义，值类型和引用类型1.png" alt="" /></p>
<p style="margin-left: 30px;">&nbsp;</p>
<p style="margin-left: 30px;">运行结果</p>
<p style="margin-left: 90px;"><img src="./images/堆和栈的含义，值类型和引用类型2.png" alt="" /></p>
<p style="margin-left: 30px;">&nbsp;</p>
<p>&nbsp;　　<img src="./images/堆和栈的含义，值类型和引用类型3.png" alt="" /></p>
<p style="margin-left: 90px;"><span style="color: #000000;">从图中我们可以看出，两个引用类型sc1,sc2都指向同一个托管堆上的空间，所以最后一个指向的会覆盖掉前面的。</span></p>
<p style="margin-left: 90px;"><span style="color: #000000;">而结构是值类型，虽然使用sv2=sv1，把sv1对象赋值给sv2，但是它会在线程栈中分配一个独立的空间，当修改某一个对象的值的时候，不会影响到另一个对象&nbsp;</span></p>
<p style="margin-left: 90px;"><strong><span style="color: #ff0000;">所以，值类型和引用类型的区别就是：</span></strong></p>
<p style="margin-left: 90px;"><strong><span style="color: #ff0000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1、它们存储的位置不一样</span></strong></p>
<p style="margin-left: 90px;"><strong><span style="color: #ff0000;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2、如果是引用类型，当两个对象指向同一个地方，修改某一个的时候，其它对象的值会发生改变</span></strong></p>
<p style="text-align: center;">&nbsp;</p>
<p style="margin-left: 30px;">内容参考来自文章：</p>
<p style="margin-left: 30px;"><a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/tonney/archive/2011/04/28/2032205.html">值类型和引用类型，栈和堆的含义</a></p>
<p style="margin-left: 30px;"><a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/tonney/archive/2011/04/28/2032205.html" target="_blank"></a><a href="http://blog.csdn.net/qiaoquan3/article/details/51202926" target="_blank">C#详解值类型和引用类型区别</a></p>
<p>&nbsp;　　</p>
<p>　　作者:<a href="https://www.cnblogs.com/lycb/" target="_blank">遥远的Ta</a></p>
<p>&nbsp;</p>
<p>　　　　　　</p>
<p>&nbsp;</p>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>