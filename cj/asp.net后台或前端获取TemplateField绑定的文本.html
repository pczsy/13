<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修asp.net后台或前端获取TemplateField绑定的文本' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>asp.net后台或前端获取TemplateField绑定的文本</center></div><div class='banquan'>原文出处:本文由博客园博主Evenssi提供。<br/>
原文连接:https://www.cnblogs.com/zq77ssi/p/11352758.html</div><br>
    <div>GridView中使用最多的一个是BoundField，还有一个是<strong>TemplateField</strong> <br />这两个各有其特点，BoundField的话比较简单，设置好DataField、HeaderText等就可以了。<br />但是有时候用TemplateField 的话，交互性就更多了。</div>
<div>这次的项目中，对方要我们做二级表头的表格，就用到了TemplateField ，代码格式如下：</div>
<div>
<div>```<br />
<div class="cnblogs_code">
<pre><code>&lt;asp:TemplateField HeaderStyle-Width=<span style="color: #800000;">"</span><span style="color: #800000;">250px</span><span style="color: #800000;">"</span>&gt;
                    &lt;HeaderTemplate&gt;
                        &lt;table width=<span style="color: #800000;">"</span><span style="color: #800000;">100%</span><span style="color: #800000;">"</span> align=<span style="color: #800000;">"</span><span style="color: #800000;">center</span><span style="color: #800000;">"</span>&gt;
                            &lt;tr&gt;
                                &lt;td colspan=<span style="color: #800000;">"</span><span style="color: #800000;">3</span><span style="color: #800000;">"</span> width=<span style="color: #800000;">"</span><span style="color: #800000;">100%</span><span style="color: #800000;">"</span> align=<span style="color: #800000;">"</span><span style="color: #800000;">center</span><span style="color: #800000;">"</span>&gt;<span style="color: #000000;">
                                     详细信息
                                </span>&lt;/td&gt;
                            &lt;/tr&gt;
                            &lt;tr&gt;
                                &lt;td  width=<span style="color: #800000;">"</span><span style="color: #800000;">70%</span><span style="color: #800000;">"</span> align=<span style="color: #800000;">"</span><span style="color: #800000;">center</span><span style="color: #800000;">"</span>&gt;<span style="color: #000000;">
                                   描述
                                </span>&lt;/td&gt;
                                &lt;td  width=<span style="color: #800000;">"</span><span style="color: #800000;">15%</span><span style="color: #800000;">"</span> align=<span style="color: #800000;">"</span><span style="color: #800000;">center</span><span style="color: #800000;">"</span>&gt;<span style="color: #000000;">
                                    图片(张)
                                </span>&lt;/td&gt;
                                &lt;td  width=<span style="color: #800000;">"</span><span style="color: #800000;">15%</span><span style="color: #800000;">"</span> align=<span style="color: #800000;">"</span><span style="color: #800000;">center</span><span style="color: #800000;">"</span>&gt;<span style="color: #000000;">
                                    视频(段)
                                </span>&lt;/td&gt;
                            &lt;/tr&gt;
                        &lt;/table&gt;
                    &lt;/HeaderTemplate&gt;
                    &lt;ItemTemplate&gt;
                        &lt;table width=<span style="color: #800000;">"</span><span style="color: #800000;">100%</span><span style="color: #800000;">"</span>&gt;
                            &lt;tr&gt;
                                &lt;td width=<span style="color: #800000;">"</span><span style="color: #800000;">70%</span><span style="color: #800000;">"</span> align=<span style="color: #800000;">"</span><span style="color: #800000;">center</span><span style="color: #800000;">"</span>&gt;
                                  &lt;asp:Label id=<span style="color: #800000;">"</span><span style="color: #800000;">Label1</span><span style="color: #800000;">"</span> runat=<span style="color: #800000;">"</span><span style="color: #800000;">server</span><span style="color: #800000;">"</span> Text=&lt;%# Eval(<span style="color: #800000;">"</span><span style="color: #800000;">data1</span><span style="color: #800000;">"</span>/asp:Label&gt;
                                &lt;/td&gt;
                                &lt;td width=<span style="color: #800000;">"</span><span style="color: #800000;">15%</span><span style="color: #800000;">"</span> align=<span style="color: #800000;">"</span><span style="color: #800000;">center</span><span style="color: #800000;">"</span>&gt;
                                &lt;asp:HyperLink id=<span style="color: #800000;">"</span><span style="color: #800000;">HyperLink1 Text=&lt;%# Eval(</span><span style="color: #800000;">"</span>data2<span style="color: #800000;">"</span><span style="color: #800000;">%&gt; ForeColor=</span><span style="color: #800000;">"</span>#00d3d4<span style="color: #800000;">"</span><span style="color: #800000;"> NavigateUrl='' runat=</span><span style="color: #800000;">"</span>server<span style="color: #800000;">"</span><span style="color: #800000;"> title='查看' CssClass=</span><span style="color: #800000;">"</span>hylink<span style="color: #800000;">"</span><span style="color: #800000;">&gt;&lt;/asp:HyperLink&gt;      </span>
                               &lt;/td&gt;
                                &lt;td width=<span style="color: #800000;">"</span><span style="color: #800000;">15%</span><span style="color: #800000;">"</span> align=<span style="color: #800000;">"</span><span style="color: #800000;">center</span><span style="color: #800000;">"</span>&gt;
                                &lt;asp:HyperLink id=<span style="color: #800000;">"</span><span style="color: #800000;">scanVideo</span><span style="color: #800000;">"</span> Text=&lt;%# Eval(<span style="color: #800000;">"</span><span style="color: #800000;">data3</span><span style="color: #800000;">"</span>%&gt; ForeColor=<span style="color: #800000;">"</span><span style="color: #800000;">#00d3d4</span><span style="color: #800000;">"</span> NavigateUrl=<span style="color: #800000;">''</span> runat=<span style="color: #800000;">"</span><span style="color: #800000;">server</span><span style="color: #800000;">"</span> title=<span style="color: #800000;">'</span><span style="color: #800000;">查看</span><span style="color: #800000;">'</span> CssClass=<span style="color: #800000;">"</span><span style="color: #800000;">hylink</span><span style="color: #800000;">"</span>&gt;&lt;/asp:HyperLink&gt;   
                                &lt;/td&gt;
                            &lt;/tr&gt;
                        &lt;/table&gt;
                    &lt;/ItemTemplate&gt;
                    &lt;HeaderStyle Width=<span style="color: #800000;">"</span><span style="color: #800000;">250px</span><span style="color: #800000;">"</span>&gt;&lt;/HeaderStyle&gt;
&lt;/asp:TemplateField&gt;</pre>
</div>
```<br />通过在后台控制从数据库中查出数据之后，对应的字段绑定上数据之后，在浏览器上的显示：<br />其中图片和视频是HyperLink 链接，可以点击后查看图片和视频~</div>
<div><img src="./images/asp.net后台或前端获取TemplateField绑定的文本0.png" alt="" /></div>
<div>&nbsp;</div>
<ul>
<li><strong>&nbsp;- 前端获取TemplateField绑定的文本</strong></li>




</ul>
<div>但是我希望，只有图片和视频的数目是大于0的时候才是蓝绿色，且可以点击，为0的时候就像普通的绑定一样。这里用前端js来获取templateField绑定的值</div>
<div>
<div class="cnblogs_code">
<pre><code><span style="color: #000000;">$(document).ready(function() {
     var gdview = document.getElementById("GridView1");
     var GridView1RowsLength =  getTableRowsLength("GridView1");
     for (var j = 1; j </span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;"> GridView1RowsLength</span><span style="color: #ff0000;">; j++) {
        var HTML </span><span style="color: #0000ff;">= gdview.rows[j].cells[6].children[0];//获取到TemplateField这一列，我这里是cells[6]
        </span><span style="color: #ff0000;">var photoNum </span><span style="color: #0000ff;">= HTML.rows[0].cells[1].textContent;
        </span><span style="color: #ff0000;">var vedioNum </span><span style="color: #0000ff;">= HTML.rows[0].cells[2].textContent;
        </span><span style="color: #ff0000;">if (photoNum </span><span style="color: #0000ff;">== </span><span style="color: #ff0000;">0) {
             HTML.rows[0].cells[1].children[0].href </span><span style="color: #0000ff;">= "#"</span><span style="color: #ff0000;">;
             HTML.rows[0].cells[1].children[0].title </span><span style="color: #0000ff;">= ""</span><span style="color: #ff0000;">;
             HTML.rows[0].cells[1].children[0].style.color </span><span style="color: #0000ff;">= "rgb(51, 51, 51)"</span><span style="color: #ff0000;">;
         }
         if (vedioNum </span><span style="color: #0000ff;">== </span><span style="color: #ff0000;">0) {
             HTML.rows[0].cells[2].children[0].href </span><span style="color: #0000ff;">= "#"</span><span style="color: #ff0000;">;
             HTML.rows[0].cells[2].children[0].title </span><span style="color: #0000ff;">= ""</span><span style="color: #ff0000;">;
             HTML.rows[0].cells[2].children[0].style.color </span><span style="color: #0000ff;">= "rgb(51, 51, 51)"</span><span style="color: #ff0000;">;
         }
}
 });
 
function getTableRowsLength(id) {
     var mytable </span><span style="color: #0000ff;">= document.getElementById(id);
     </span><span style="color: #ff0000;">return mytable.rows.length;
 }            </span></pre>
</div>
<p>&nbsp;</p>
<br />效果：</div>
<div><img src="./images/asp.net后台或前端获取TemplateField绑定的文本1.png" alt="" /><br />为0的鼠标放置上去不会有title显示，点击也不会有反应了</div>
<div>&nbsp;</div>
<div>&nbsp;</div>
<div>
<ul>
<li><strong>&nbsp;- 后端获取TemplateField绑定的文本</strong></li>



</ul>
前面的描述文字，一开始对方给的模板都是10字以内的，所以没有做特殊处理，后来对方提及描述文字一般是50字左右，那当然不可能直接这么多文字都显示出来的，</div>
<div>占位置还很丑，所以就想到字数超过固定数目之后，之后的用...表示，但是可以通过鼠标放置在当前单元格上的时候，悬浮显示全部描述文字。这里用后台控制：<br />首先要说的是，其实一开始，我的描述是直接放在`&lt;td&gt;&lt;/td&gt;`中的，但是这样后台虽然可以取到文本，但是无法使用ToolTip，也不能对其属性Text赋值，后来用&nbsp;
<pre><code><span style="color: #ff0000;">&lt;asp:Label</span> id="Label1" runat="server" Text=&lt;%# Eval("data1"/asp:Label&gt;</pre>
,这样可以在前端（就是上面的js代码中）控制，显示我想要的效果，但是是前端强制生成的，因为绑定在gridview上的数据还是很长段的文字，所以页面刚刷新的时候会</div>
<div>看到很长段的描述文字，闪了一下，才会变成想要的&ldquo;部分描述文字&rdquo;+...，这样，所以我还是希望在数据绑定的时候就已经处理好这些<em id="__mceDel">在网上找了很久，并没有找到方法，</em></div>
<div><em id="__mceDel">只能自己琢磨了</em></div>
<div><em><em><em>代码如下：<br />&nbsp; &nbsp;</em></em></em>
<div class="cnblogs_code">
<pre><code>    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
    <span style="color: #808080;">///</span><span style="color: #008000;"> 当Gridview的每行数据绑定的时候触发的事件
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="sender"&gt;&lt;/param&gt;</span>
    <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="e"&gt;&lt;/param&gt;</span>
    <span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span> GridView1_RowDataBound(<span style="color: #0000ff;">object</span><span style="color: #000000;"> sender, GridViewRowEventArgs e)
    {
 </span><span style="color: #0000ff;">if</span> (e.Row.RowType ==<span style="color: #000000;"> DataControlRowType.DataRow)
        {
            </span><span style="color: #0000ff;">if</span> (((System.Data.DataRowView)(e.Row.DataItem)).Row.ItemArray[<span style="color: #800080;">6</span>].ToString().Trim().Length &gt; <span style="color: #800080;">12</span>)  <span style="color: #008000;">//</span><span style="color: #008000;">描述的文字长度大于12的时候</span>
<span style="color: #000000;">            {
                </span><span style="color: #0000ff;">string</span> dis = ((System.Data.DataRowView)(e.Row.DataItem)).Row.ItemArray[<span style="color: #800080;">6</span><span style="color: #000000;">].ToString().Trim();
                Label aaa </span>= e.Row.FindControl(<span style="color: #800000;">"</span><span style="color: #800000;">Label1</span><span style="color: #800000;">"</span>) <span style="color: #0000ff;">as</span><span style="color: #000000;"> Label;  
                aaa.ToolTip </span>=<span style="color: #000000;"> dis;
                aaa.Text </span>= dis.Substring(<span style="color: #800080;">0</span>, <span style="color: #800080;">11</span>) + <span style="color: #800000;">"</span><span style="color: #800000;">...</span><span style="color: #800000;">"</span><span style="color: #000000;">;
            }
　　　　}
　　}</span></pre>
</div>
<p>&nbsp;</p>
<em id="__mceDel"><em id="__mceDel"><strong>((System.Data.DataRowView)(e.Row.DataItem)).Row.ItemArray[6]</strong>这个是怎么得到的呢，就是自己一开始用的是e.Row.Cells[]但是获取不到，后来使用((DataBoundLiteralControl)row.Cells[index].Controls[0]).Text.Trim()也有点小问题，后台调试的时候，获取e.row，找到了整行的数据，在一层一层找到描述的单元格信息，然后直接通过复制表达式得到的。</em></em></div>
<div>然后就完成了，其实之前的俩个数字也是完全可以用后端的办法的，一样获取到文本，做判断，HyperLink PhotoNum = e.Row.FindControl("HyperLink1") as HyperLink; 再设置属性就行了。（=.<img src="./images/asp.net后台或前端获取TemplateField绑定的文本2.png" alt="" /></div>
<div>字数限制之后，鼠标放置--悬浮显示完整文字</div>
<div>&nbsp;</div>





</div>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>