<html><head><meta charset='utf-8'><meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='applicable-device' content='pc'><meta name='keywords' content='电脑,电脑讲解,电脑技术,编程,电脑故障维修Web前端基础(19)jQuery基础(六)' />
<script src='../../highlight/highlight.pack.js'></script>
<link rel='stylesheet' type='text/css' href='../../highlight/styles/monokai.css'/>

<link rel='stylesheet' href='../../fenxiang/dist/css/share.min.css'>
<script src='../../fenxiang/src/js/social-share.js'></script>
<script src='../../fenxiang/src/js/qrcode.js'></script>

</head><body><script>hljs.initHighlightingOnLoad();</script><script>
var system ={};  
var p = navigator.platform;       
system.win = p.indexOf('Win') == 0;  
system.mac = p.indexOf('Mac') == 0;  
system.x11 = (p == 'X11') || (p.indexOf('Linux') == 0);     
if(system.win||system.mac||system.xll){
document.write("<link href='../css/3.css' rel='stylesheet' type='text/css'>");}else{ document.write("<link href='../css/3wap.css' rel='stylesheet' type='text/css'>");}</script><script src='../../js/3.js'></script><div class='div2'><div class='heading_nav'><ul><div><li><a href='../../index.html'>首页</a></li>
</div><div onclick='hidden1()' >分享</div>
</ul></div></div>
<div id='heading_nav2'> 
<li class='row' >
<div class='social-share' data-mode='prepend'><a href='javascript:' class='social-share-icon icon-heart'></a></div></li></div><script charset='utf-8' src='../../3/js/hengfu.js'></script><script charset='utf-8' src='../../3/js/hengfu2.js'></script><hr><div class='div1'><div class='biaoti'><center>Web前端基础(19)jQuery基础(六)</center></div><div class='banquan'>原文出处:本文由博客园博主爱编程的小灰灰提供。<br/>
原文连接:https://www.cnblogs.com/liuhui0308/p/11890175.html</div><br>
    <h1>1. ajax</h1>
<h2>1.1 什么是ajax</h2>
<p>AJAX = 异步的javascript和XML（Asynchronous Javascript and XML）</p>
<p>简言之，在不重载整个网页的情况下，AJAX通过后台加载数据，并在网页上进行显示。</p>
<p>通过 jQuery AJAX 方法，您能够使用 HTTP Get 和 HTTP Post 从远程服务器上请求文本、HTML、XML 或 JSON - 同时您能够把这些外部数据直接载入网页的被选元素中。</p>
<h2>1.2 jQuery常用方法</h2>
<h3>1.2.1 load()</h3>
<p>jQuery load()方法是简单但强大的AJAX方法。</p>
<p>load()方法从服务器加载数据，并把返回的数据放入被选元素中。</p>
<p>该方法使用不多，了解即可。</p>
<p>语法：</p>
<div class="cnblogs_code">
<pre><code>$("selector").load(url,data,callback);</pre>
</div>
<p>第一种情况：</p>
<div class="cnblogs_code">
<pre><code>$('#btn').click(<span style="color: #0000ff;">function</span><span style="color: #000000;">(){

    </span><span style="color: #008000;">//</span><span style="color: #008000;">只传一个url，表示在id为#new-projects的元素里加载index.html</span>
    $('#new-projects').load('./index.html'<span style="color: #000000;">);
})</span></pre>
</div>
<p>第二种情况：</p>
<div class="cnblogs_code">
<pre><code>$('#btn').click(<span style="color: #0000ff;">function</span><span style="color: #000000;">(){
    </span><span style="color: #008000;">//</span><span style="color: #008000;">只传一个url，导入的index.html文件含有多个传递参数，类似于：index/html?name='张三'</span>
    $('#new-projects').load('./index.html',{"name":'张三',"age":12<span style="color: #000000;">});
})</span></pre>
</div>
<p>第三种情况：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">加载文件之后，会有个回调函数，表示加载成功的函数</span>
    $('#new-projects').load('./index.html',{"name":'张三',"age":12},<span style="color: #0000ff;">function</span><span style="color: #000000;">(){

});</span></pre>
</div>
<h3>1.2.2 getJSON()</h3>
<p>jQuery的AJAX中使用getJSON()方法异步加载JSON格式数据。获取服务器中的数据，并对数据进行解析，显示到页面中。</p>
<p>语法：</p>
<div class="cnblogs_code">
<pre><code>$.getJSON(url,[data],[callback])</pre>
</div>
<p>参数解释：</p>
<blockquote>
<p class="language-"><code><span class="hljs-title">url参数：为请求加载json格式文件的服务器地址<br />可选项<span class="hljs-class"><span class="hljs-keyword">data参数：为请求时发送的数据<br /><span class="hljs-class">callback参数：为数据请求成功后执行的函数</span></span></span></span></code></p>
</blockquote>
<div class="cnblogs_code">
<pre><code>$.getJSON("./data/getJSON.json", <span style="color: #0000ff;">function</span><span style="color: #000000;"> (data) {
       </span><span style="color: #0000ff;">var</span> str = "";<span style="color: #008000;">//</span><span style="color: #008000;">初始化保存内容变量</span>
       $.each(data, <span style="color: #0000ff;">function</span><span style="color: #000000;">(index,ele) {
          $(</span>'ul').append("&lt;li&gt;"+ele.name+"&lt;/li&gt;"<span style="color: #000000;">)

    });
})</span></pre>
</div>
<h3>1.2.3 $.get()</h3>
<p>$.get() 方法通过 HTTP GET 请求从服务器上请求数据。</p>
<p>语法：</p>
<div class="cnblogs_code">
<pre><code>$.get(URL,callback);</pre>
</div>
<p class="language-"><code class="hljs">url参数：规定你请求的路径，是必需参数<br />callback参数：为数据请求成功后执行的函数。</code></p>
<div class="cnblogs_code">
<pre><code>$.get('./data/getJSON.json',<span style="color: #0000ff;">function</span><span style="color: #000000;">(data,status){
    console.log(status);   </span><span style="color: #008000;">//</span><span style="color: #008000;">success    200状态码 ok的意思              </span>
})</pre>
</div>
<h3>1.2.4 post()</h3>
<p>与get()方法相比，post()方法多用于以POST方式向服务器发送数据，服务器接收到数据之后，进行处理，并将处理结果返回页面。</p>
<p>语法：</p>
<div class="cnblogs_code">
<pre><code>$.post(URL,data,callback);</pre>
</div>
<p class="language-"><code><span class="hljs-title">url参数：规定你请求的路径，是必需参数，可选的<span class="hljs-class"><span class="hljs-keyword">data参数是连同请求发送的数据<br /><span class="hljs-class">可选的callback参数：为数据请求成功后执行的函数</span></span></span></span></code></p>
<div class="cnblogs_code">
<pre><code>$.post('/index',{name:'张三'},<span style="color: #0000ff;">function</span><span style="color: #000000;">(data,status){
    console.log(status);

})</span></pre>
</div>
<h3>1.2.5 $.ajax()</h3>
<p class="language-"><code class="hljs javascript">query的$.ajax()方法 是做ajax技术经常使用的一个方法。</code></p>
<p class="language-"><code class="hljs javascript">它的参数很多，总会有一些初学者记不住，在这里，演示几个经常使用的参数。后面讲django课程部分会详细讲ajax技术的原理。大家先把每个参数做个笔记。</code></p>
<p>参数如下：&nbsp;</p>
<p>1.url:&nbsp;要求为String类型的参数，（默认为当前页地址）发送请求的地址。</p>
<p>2.type:&nbsp;要求为String类型的参数，请求方式（post或get）默认为get。注意其他http请求方法，例如put和delete也可以使用，但仅部分浏览器支持。</p>
<p>3.timeout: 要求为Number类型的参数，设置请求超时时间（毫秒）。此设置将覆盖$.ajaxSetup()方法的全局设置。</p>
<p>4.async: 要求为Boolean类型的参数，默认设置为true，所有请求均为异步请求。如果需要发送同步请求，请将此选项设置为false。注意，同步请求将锁住浏览器，用户其他操作必须等待请求完成才可以执行。</p>
<p>5.cache: 要求为Boolean类型的参数，默认为true（当dataType为script时，默认为false），设置为false将不会从浏览器缓存中加载请求信息。</p>
<p>6.data:&nbsp;要求为Object或String类型的参数，发送到服务器的数据。如果已经不是字符串，将自动转换为字符串格式。get请求中将附加在url后。防止这种自动转换，可以查看　　processData选项。对象必须为key/value格式，例如{foo1:"bar1",foo2:"bar2"}转换为&amp;foo1=bar1&amp;foo2=bar2。如果是数组，JQuery将自动为不同值对应同一个名称。例如{foo:["bar1","bar2"]}转换为&amp;foo=bar1&amp;foo=bar2。</p>
<p>7.dataType: 要求为String类型的参数，预期服务器返回的数据类型。如果不指定，JQuery将自动根据http包mime信息返回responseXML或responseText，并作为回调函数参数传递。可用的类型如下：</p>
<p>　　xml：返回XML文档，可用JQuery处理。</p>
<p>　　html：返回纯文本HTML信息；包含的script标签会在插入DOM时执行。</p>
<p>　　script：返回纯文本JavaScript代码。不会自动缓存结果。除非设置了cache参数。注意在远程请求时（不在同一个域下），所有post请求都将转为get请求。</p>
<p>　　json：返回JSON数据。</p>
<p>　&nbsp; &nbsp;jsonp：JSONP格式。使用SONP形式调用函数时，例如myurl?callback=?，JQuery将自动替换后一个&ldquo;?&rdquo;为正确的函数名，以执行回调函数。</p>
<p>　　text：返回纯文本字符串。</p>
<p>8.beforeSend： 要求为Function类型的参数，发送请求前可以修改XMLHttpRequest对象的函数，例如添加自定义HTTP头。在beforeSend中如果返回false可以取消本次ajax请求。XMLHttpRequest对象是惟一的参数。 function(XMLHttpRequest){ this; //调用本次ajax请求时传递的options参数 }。</p>
<p>9.complete：</p>
<p>要求为Function类型的参数，请求完成后调用的回调函数（请求成功或失败时均调用）。参数：XMLHttpRequest对象和一个描述成功请求类型的字符串。 function(XMLHttpRequest, textStatus){ this; //调用本次ajax请求时传递的options参数 }。</p>
<p>10.success：</p>
<p>要求为Function类型的参数，请求成功后调用的回调函数，有两个参数。</p>
<p>(1)由服务器返回，并根据dataType参数进行处理后的数据。</p>
<p>(2)描述状态的字符串。 function(data, textStatus){ //data可能是xmlDoc、jsonObj、html、text等等 。</p>
<p>11.error:&nbsp;要求为Function类型的参数，请求失败时被调用的函数。该函数有3个参数，即XMLHttpRequest对象、错误信息、捕获的错误对象(可选)。ajax事件函数如下： function(XMLHttpRequest, textStatus, errorThrown){ //通常情况下textStatus和errorThrown只有其中一个包含信息 this; //调用本次ajax请求时传递的options参数 }。</p>
<p>12.contentType： 要求为String类型的参数，当发送信息至服务器时，内容编码类型默认为"application/x-www-form-urlencoded"。该默认值适合大多数应用场合。</p>
<p>13.dataFilter： 要求为Function类型的参数，给Ajax返回的原始数据进行预处理的函数。提供data和type两个参数。data是Ajax返回的原始数据，type是调用jQuery.ajax时提供的dataType参数。函数返回的值将由jQuery进一步处理。 function(data, type){ //返回处理后的数据 return data; }。</p>
<p>14.dataFilter： 要求为Function类型的参数，给Ajax返回的原始数据进行预处理的函数。提供data和type两个参数。data是Ajax返回的原始数据，type是调用jQuery.ajax时提供的dataType参数。函数返回的值将由jQuery进一步处理。 function(data, type){ //返回处理后的数据 return data; }。</p>
<p>15.global： 要求为Boolean类型的参数，默认为true。表示是否触发全局ajax事件。设置为false将不会触发全局ajax事件，ajaxStart或ajaxStop可用于控制各种ajax事件。</p>
<p>16.ifModified： 要求为Boolean类型的参数，默认为false。仅在服务器数据改变时获取新数据。服务器数据改变判断的依据是Last-Modified头信息。默认值是false，即忽略头信息。</p>
<p>17.jsonp： 要求为String类型的参数，在一个jsonp请求中重写回调函数的名字。该值用来替代在"callback=?"这种GET或POST请求中URL参数里的"callback"部分，例如{jsonp:'onJsonPLoad'}会导致将"onJsonPLoad=?"传给服务器。</p>
<p>18.username： 要求为String类型的参数，用于响应HTTP访问认证请求的用户名。</p>
<p>19.password： 要求为String类型的参数，用于响应HTTP访问认证请求的密码。</p>
<p>20.processData： 要求为Boolean类型的参数，默认为true。默认情况下，发送的数据将被转换为对象（从技术角度来讲并非字符串）以配合默认内容类型"application/x-www-form-urlencoded"。如果要发送DOM树信息或者其他不希望转换的信息，请设置为false。</p>
<p>21.scriptCharset： 要求为String类型的参数，只有当请求时dataType为"jsonp"或者"script"，并且type是GET时才会用于强制修改字符集(charset)。通常在本地和远程的内容编码不同时使用。</p>
<h4>(1) get方式</h4>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">get()方式</span>
<span style="color: #000000;">$.ajax({
    url:</span>'./data/index.txt'<span style="color: #000000;">,
    type:</span>'get'<span style="color: #000000;">,
    dataType:</span>'text'<span style="color: #000000;">,
    success:</span><span style="color: #0000ff;">function</span><span style="color: #000000;">(data){
        $(</span>'p'<span style="color: #000000;">).html(data);

    },
    error:</span><span style="color: #0000ff;">function</span><span style="color: #000000;">(error){
        console.log(error)
    }
})</span></pre>
</div>
<h4>(2) post方式</h4>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">post()方式</span>
<span style="color: #000000;">$.ajax({
    url:</span>'/index'<span style="color: #000000;">,
    type:</span>'post'<span style="color: #000000;">,
    data:{name:</span>'张三',age:12<span style="color: #000000;">},
    success:</span><span style="color: #0000ff;">function</span><span style="color: #000000;">(data){
        $(</span>'p'<span style="color: #000000;">).html(data);
    },
    error:</span><span style="color: #0000ff;">function</span><span style="color: #000000;">(error){
        console.log(error)
    }
}）</span></pre>
</div>
<p class="language-"><code class="hljs dart">注意：以上所有操作,请在服务器上运行此代码，如果没有服务器，可以在本地搭建本地服务器。 好吧！！咱们还没学，我们可以使用PCCharm,WebStrom,HBuilder上运行此代码。但是post请求的方法 我们暂时没法演示， 后面在django部分讲到服务器的知识点后，会给大家详细演示<span class="hljs-keyword">get请求和post请求的处理。</span></code></p>
<h2>1.3&nbsp;<code>XMLHttpRequest()对象补充</code></h2>
<p>有如下概念：</p>
<p align="justify">1.Ajax能够是实现异步传输，所依赖的就是JavaScript中的XMLHttpRequest</p>
<p align="justify">2.XMLHttpRequest对象是XMLHttp组件的对象，它是一个抽象对象，允许脚本从服务器获取返回的eXML数据或将数据发送到服务器端</p>
<p align="justify">3.XMLHttpRequest可以实现客户端与服务器只进行数据层面的交互，不必每次刷新页面</p>
<p align="justify">4.XMLHttpRequest最早在Microsoft Internet Explorer5.0中作为一个ActiveX控件提供，后受到广泛应用</p>
<p align="justify">5.在使用XMLHttpRequest发送请求和处理相应之前需要先创建一个XMLHttpRequest对象</p>
<p align="justify">6.XMLHttpRequest不是W3C标准，可采用多种方法用JavaScript来创建XMLHttpRequest实例</p>
<p align="justify">7.在IE中XMLHttpRequest实现为一个ActiveX控件，而其他浏览器则实现为一个JavaScript内置对象</p>
<h2>1.4&nbsp;<code>XMLHttpRequest对象属性（接收并显示当前状态）</code></h2>
<p align="justify">1.readySate-记录返回请求的状态</p>
<p align="justify">0-为初始化：对象已经建立，单位初始化，open方法还未调用；</p>
<p align="justify">1-初始化：对象已经建立，但还未调用send方法发送请求；</p>
<p align="justify">2-发送数据：send方法已调用，但HTTP头未知；</p>
<p align="justify">3-数据传输中：已经接受部分数据，但响应不完全；</p>
<p align="justify">4-完成：数据接受完成，此时才可以获取完整的返回数据</p>
<p align="justify">2.responseText-接收客户端的HTTP响应的文本内容</p>
<p align="justify">只读</p>
<p align="justify">当readySate为1/2，responseText值是一个空字符串；</p>
<p align="justify">当readyState为3，响应信息正在接受还未完成；</p>
<p align="justify">当readyState为4，表示可以响应信息已经接收完成</p>
<p align="justify">xmlHttp默认响应数据编码为UTF-8</p>
<p align="justify">3.responseXML-在send（）执行后，将返回的信息格式化为XML Document对象</p>
<p align="justify">Content-Type指定的MIME类型应该为text/HTML</p>
<p align="justify">如果Content-Type不包含这种类型，responseXML在接收时将会得到一个null值</p>
<p align="justify">4.status-在send（）执行后，可使用status读取事物状态</p>
<p align="justify">长整型数据</p>
<p align="justify">返回当前请求的HTTP的状态码</p>
<p align="justify">只有当readyState为3或4时才使用该属性，否则读取status会发生错误</p>
<p align="justify">100-客户必须继续发送请求</p>
<p align="justify">200-交易成功</p>
<p align="justify">400-错误请求</p>
<p align="justify">403-请求不允许</p>
<p align="justify">404-没有发现文件、查询、URL</p>
<p align="justify">500-服务器内部错误</p>
<p align="justify">502服务器暂时不可使用</p>
<p align="justify">505-服务器不支持或拒绝不支持请求头中的HTTP版本</p>
<p align="justify">5.statusText-send（）执行后，可通过statusText读取事物状态</p>
<p align="justify">返回当前HTTP请求的状态行</p>
<p align="justify">只有当readyState为3或4时才可使用该属性，否则读取state会发生错误</p>
<p align="justify">6.Onreadystatechange-readyState发生变化时所要执行的操作</p>
<p align="justify">通常将处理函数名称赋予onreadystatechange来为XMLHttpRequest对象指定事件处理</p>
<p align="justify">在事件处理函数中根据readyState的状态值进行相应的处理</p>
<p align="justify">&nbsp;</p>
<p align="justify">代码如下：</p>
<div class="cnblogs_code">
<pre><code><span style="color: #008000;">//</span><span style="color: #008000;">1、先创建 XMLHttpRequest对象</span>
  <span style="color: #0000ff;">var</span> xhr = <span style="color: #0000ff;">new</span><span style="color: #000000;"> XMLHttpRequest();

  console.log(xhr.readyState);

  </span><span style="color: #008000;">//</span><span style="color: #008000;"> 2.做出响应之后会调用此方法  状态机</span>
  xhr.onreadystatechange = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){

      </span><span style="color: #008000;">//</span><span style="color: #008000;"> if (true) {}</span>

      <span style="color: #0000ff;">if</span> (xhr.readyState===4<span style="color: #000000;">) {
          console.log(xhr.responseText)

          document.getElementById(</span>'content').innerHTML =<span style="color: #000000;"> xhr.responseText
    
      }

  }

  document.querySelector(</span>'#btn').onclick = <span style="color: #0000ff;">function</span><span style="color: #000000;">(){

      </span><span style="color: #0000ff;">var</span> username = document.getElementById('username'<span style="color: #000000;">).value;
      </span><span style="color: #0000ff;">var</span> pwd = document.getElementById('pwd'<span style="color: #000000;">).value;


     </span><span style="color: #008000;">//</span><span style="color: #008000;">3.初始化HTTP请求参数，但是并不发送请求。</span>
  <span style="color: #008000;">//</span><span style="color: #008000;">第一个参数连接方式，第二是url地址,第三个true是异步连接，默认是异步</span>
    xhr.open('GET',`http:<span style="color: #008000;">//</span><span style="color: #008000;">localhost:3000/signin1?username=${username}&amp;pwd=${pwd}`,true);</span>
  <span style="color: #008000;">//</span><span style="color: #008000;">使用post方式发送数据</span>
  <span style="color: #008000;">//</span><span style="color: #008000;">xmlhttp.open("POST","http://localhost:3000/signin1",true);</span>
  <span style="color: #008000;">//</span><span style="color: #008000;">post需要自己设置http的请求头</span>
  <span style="color: #008000;">//</span><span style="color: #008000;">xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");</span>
    <span style="color: #008000;">//</span><span style="color: #008000;"> http://localhost:3000/signin?username=chyingp&amp;pw=123456</span>
      <span style="color: #008000;">//</span><span style="color: #008000;">发起请求 第一个参数 是请求的方式 大写  打开连接</span>
  
    
    <span style="color: #008000;">//</span><span style="color: #008000;">4，发送数据，开始和服务器进行交互</span>
      <span style="color: #008000;">//</span><span style="color: #008000;">发送 HTTP 请求，使用传递给 open() 方法的参数，以及传递给该方法的可选请求体。</span>
      <span style="color: #008000;">//</span><span style="color: #008000;">中如果true, send这句话会立即执行</span>
      <span style="color: #008000;">//</span><span style="color: #008000;">如果是false（同步），send会在服务器数据回来才执行</span>
      xhr.send(<span style="color: #0000ff;">null</span><span style="color: #000000;">);
      </span><span style="color: #008000;">//</span><span style="color: #008000;">因为是get所以send中不需要内容</span>
      <span style="color: #008000;">//</span><span style="color: #008000;">xhr.send('name=' +username);</span>
<span style="color: #000000;">
  }</span></pre>
</div>
</div>
</div><hr><script charset='utf-8' src='../../js/sming.js'></script></body></html>